<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="nodejs express图片上传前后端配置讲解"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>nodejs express图片上传前后端配置讲解 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/yh17w6ayiub/",
				"appid": "1613049289050283", 
				"title": "nodejs express图片上传前后端配置讲解 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-09T02:30:58"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/sm7gmmzymd/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/tkpucgy6epj/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f&text=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f&text=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f&title=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f&is_video=false&description=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f&title=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f&title=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f&title=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fyh17w6ayiub%2f&title=nodejs%20express%e5%9b%be%e7%89%87%e4%b8%8a%e4%bc%a0%e5%89%8d%e5%90%8e%e7%ab%af%e9%85%8d%e7%bd%ae%e8%ae%b2%e8%a7%a3"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">nodejs express图片上传前后端配置讲解</h1><div class="meta"><div class="postdate"><time datetime="2019-02-09" itemprop="datePublished">2019-02-09</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3enodejs图片上传\x3c\/h2\x3e\n\x3cp\x3enodejs一般开发网站基本都用express框架，本文也主要以express为例，讲解如何上传图片；\x3cbr\x3eexpress本身没有上传图片功能；一般都是集成相应的模块；常用的有multer中间件和formidable中间件，前一个我配置的时候总是出错，所以pass；此处主要演示formidable的用法；\x3c\/p\x3e\n\x3ch4\x3e首先前端页面配置，无非两种，\x3c\/h4\x3e\n\x3cp\x3e-表单提交；\x3cbr\x3e-ajax提交；\x3cbr\x3e\x3cstrong\x3e表单提交代码如下\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!doctype html\x3e\n\x3chtml lang=\x26quot;en\x26quot;\x3e\n\x3chead\x3e\n    \x3cmeta charset=\x26quot;UTF-8\x26quot;\x3e\n    \x3ctitle\x3eDocument\x3c\/title\x3e\n\x3c\/head\x3e\n\x3cbody\x3e\n\x3cform action=\x26quot;\/uploader\x26quot; method=\x26quot;post\x26quot; enctype=\x26quot;multipart\/form-data\x26quot;\x3e\n    \x3c!--注意此处的name和后端files的属性对应--\x3e\n    \x3cinput type=\x26quot;file\x26quot; name=\x26quot;fulAvatar\x26quot;\x3e\n    \x3cinput type=\x26quot;submit\x26quot;\x3e\n\x3c\/form\x3e\n\x3c\/body\x3e\n\x3c\/html\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!doctype html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3elang\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22en\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22UTF-8\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eDocument\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eaction\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\/uploader\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3emethod\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22post\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eenctype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22multipart\/form-data\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!--注意此处的name和后端files的属性对应--\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22fulAvatar\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22submit\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里注意表单的enctype属性一定要是：\x3ccode\x3emultipart\/form-data\x3c\/code\x3e；\x3cbr\x3e\x3ccode\x3e\x26lt;input type=\x22file\x22 name=\x22fulAvatar\x22\x26gt;\x3c\/code\x3e别忘了name属性;\x3cbr\x3e这是html文档的讲解：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e定义和用法\x3cbr\x3eenctype 属性规定在发送到服务器之前应该如何对表单数据进行编码。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e默认地，表单数据会编码为 \x22application\/x-www-form-urlencoded\x22。就是说，在发送到服务器之前，所有字符都会进行编码（空格转换为 \x22\x2b\x22 加号，特殊符号转换为 ASCII HEX 值）。\x3c\/p\x3e\n\x3cp\x3e\x3cimg alt=\x22Alt text\x22 title=\x22Alt text\x22 src=\x22https:\/\/static.alili.techundefined\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eajax提交\x3c\/strong\x3e:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE\x3e\n\x3chtml\x3e\n\x3chead\x3e\n    \x3ctitle\x3e formdata file jquery ajax upload\x3c\/title\x3e\n\x3c\/head\x3e\n\n\x3cbody\x3e\n\x3cimg id=\x26quot;showImg\x26quot; src=\x26quot;\x26quot; alt=\x26quot;\x26quot;\x3e\n\n\x3cform role=\x26quot;form\x26quot; id=\x26quot;myForm\x26quot; action=\x26quot;http:\/\/v0.api.upyun.com\/xxx\x26quot; method=\x26quot;post\x26quot; enctype=\x26quot;multipart\/form-data\x26quot;\x3e\n\n    \x3cinput type=\x26quot;hidden\x26quot; name=\x26quot;policy\x26quot; value=\x26quot;\x26quot;\x3e\n    \x3cinput type=\x26quot;hidden\x26quot; name=\x26quot;signature\x26quot; value=\x26quot;\x26quot;\x3e\n\n    \x3cdiv class=\x26quot;form-group\x26quot;\x3e\n        \x3clabel class=\x26quot;col-sm-2 control-label\x26quot;\x3e说明:\x3c\/label\x3e\n\n        \x3cdiv class=\x26quot;col-sm-10\x26quot;\x3e\n            \x3cp class=\x26quot;form-control-static \x26quot;\x3eajax 文件上传 。\x3c\/p\x3e\n        \x3c\/div\x3e\n    \x3c\/div\x3e\n    \x3cdiv class=\x26quot;form-group\x26quot;\x3e\n        \x3clabel for=\x26quot;url\x26quot; class=\x26quot;col-sm-2 control-label\x26quot;\x3e\x3cs\x3e*\x3c\/s\x3e图片选择:\x3c\/label\x3e\n\n        \x3cdiv class=\x26quot;col-sm-7\x26quot;\x3e\n            \x3cinput type=\x26quot;file\x26quot; name=\x26quot;fulAvatar\x26quot; id=\x26quot;file_upload\x26quot; value=\x26quot;\x26quot;\n                   class=\x26quot;form-control\x26quot; placeholder=\x26quot;图片地址\x26quot; onchange=\x26quot;uploadByForm();\x26quot;\x3e\n        \x3c\/div\x3e\n    \x3c\/div\x3e\n\n    \x3cdiv class=\x26quot;form-group\x26quot;\x3e\n        \x3cdiv class=\x26quot;col-sm-offset-2 col-sm-7\x26quot;\x3e\n\n            \x3ca id=\x26quot;btnAjax\x26quot; onclick=\x3eAjax上传\x3c\/a\x3e\n        \x3c\/div\x3e\n    \x3c\/div\x3e\n\x3c\/form\x3e\n\n\x3cscript src=\x26quot;http:\/\/cdn.bootcss.com\/jquery\/1.11.1\/jquery.min.js\x26quot;\x3e\x3c\/script\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n\n    \/**\n     * ajax 上传。\n     *\/\n    function uploadByForm() {\n        \/\/用form 表单直接 构造formData 对象; 就不需要下面的append 方法来为表单进行赋值了。\n        var formData = new FormData($(\x26quot;#myForm\x26quot;)[0]);\n        var url = \x26quot;http:\/\/localhost:3000\/uploader\x26quot;;\n        $.ajax({\n            url: url,\n            type: \x27POST\x27,\n            data: formData,\n\n            \/**\n             * 必须false才会避开jQuery对 formdata 的默认处理\n             * XMLHttpRequest会对 formdata 进行正确的处理\n             *\/\n            processData: false,\n            \/**\n             *必须false才会自动加上正确的Content-Type\n             *\/\n            contentType: false,\n            success: function (responseStr) {\n                alert(responseStr.newPath);\n                $(\x26quot;img\x26quot;).attr({\x26quot;src\x26quot;: responseStr.newPath}).prependTo($(\x26quot;body\x26quot;));\n            },\n            error: function (responseStr) {\n                alert(responseStr.newPath);\n            }\n        });\n    }\n\n\x3c\/script\x3e\n\x3c\/body\x3e\n\x3c\/html\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e formdata file jquery ajax upload\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22showImg\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ealt\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3erole\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22form\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22myForm\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eaction\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/v0.api.upyun.com\/xxx\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3emethod\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22post\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eenctype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22multipart\/form-data\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22hidden\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22policy\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22hidden\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22signature\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22form-group\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22col-sm-2 control-label\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e说明:\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22col-sm-10\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22form-control-static \x22\x3c\/span\x3e\x26gt;\x3c\/span\x3eajax 文件上传 。\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22form-group\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efor\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22url\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22col-sm-2 control-label\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3es\x3c\/span\x3e\x26gt;\x3c\/span\x3e*\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3es\x3c\/span\x3e\x26gt;\x3c\/span\x3e图片选择:\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3elabel\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22col-sm-7\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22fulAvatar\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22file_upload\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e\n                   \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22form-control\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eplaceholder\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22图片地址\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonchange\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22uploadByForm();\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22form-group\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22col-sm-offset-2 col-sm-7\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n            \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ea\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22btnAjax\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonclick\x3c\/span\x3e=\x26gt;\x3c\/span\x3eAjax上传\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ea\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eform\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cdn.bootcss.com\/jquery\/1.11.1\/jquery.min.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/**\n     * ajax 上传。\n     *\/\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3euploadByForm\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/用form 表单直接 构造formData 对象; 就不需要下面的append 方法来为表单进行赋值了。\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formData = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData($(\x3cspan class=\x22hljs-string\x22\x3e\x22#myForm\x22\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]);\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/localhost:3000\/uploader\x22\x3c\/span\x3e;\n        $.ajax({\n            \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: url,\n            \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: formData,\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/**\n             * 必须false才会避开jQuery对 formdata 的默认处理\n             * XMLHttpRequest会对 formdata 进行正确的处理\n             *\/\x3c\/span\x3e\n            processData: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-comment\x22\x3e\/**\n             *必须false才会自动加上正确的Content-Type\n             *\/\x3c\/span\x3e\n            contentType: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e,\n            \x3cspan class=\x22hljs-attr\x22\x3esuccess\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresponseStr\x3c\/span\x3e) \x3c\/span\x3e{\n                alert(responseStr.newPath);\n                $(\x3cspan class=\x22hljs-string\x22\x3e\x22img\x22\x3c\/span\x3e).attr({\x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e: responseStr.newPath}).prependTo($(\x3cspan class=\x22hljs-string\x22\x3e\x22body\x22\x3c\/span\x3e));\n            },\n            \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eresponseStr\x3c\/span\x3e) \x3c\/span\x3e{\n                alert(responseStr.newPath);\n            }\n        });\n    }\n\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eajax上传主要用的是Jquery;这一块只是知道这么用；配置ajax的时候\x3cstrong\x3eprocessData\x3c\/strong\x3e与\x3cstrong\x3econtentType\x3c\/strong\x3e都设置为false；\x3cbr\x3e还有此处用了HTML5的一个新特性;FormData;\x3cbr\x3e用法如下：\x3ccode\x3enew FormData($(\x22#myForm\x22)[0])\x3c\/code\x3e;\x3c\/p\x3e\n\x3ch4\x3e关于ajax这一块我做了个尝试,就是不用html5的FormData，而是直接用$(\x22file_upload\x22).val()去取文件表单的值，然后通过ajax传递，结果不是很理想;\x3c\/h4\x3e\n\x3cp\x3e将这坨数据传到后端就可以了；\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e前端页面演示完了；下面是后端代码演示：\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var express = require(\x27express\x27);\nvar router = express.Router();\nvar formidable = require(\x27formidable\x27),\n    fs = require(\x27fs\x27),\n    TITLE = \x27formidable上传示例\x27,\n    AVATAR_UPLOAD_FOLDER = \x27\/avatar\/\x27,\n    domain = \x26quot;http:\/\/localhost:3000\x26quot;;\n\n\/* 图片上传路由 *\/\nrouter.post(\x27\/uploader\x27, function(req, res) {\n\n  var form = new formidable.IncomingForm();   \/\/创建上传表单\n  form.encoding = \x27utf-8\x27;        \/\/设置编辑\n  form.uploadDir = \x27public\x27 \x2b AVATAR_UPLOAD_FOLDER;     \/\/设置上传目录\n  form.keepExtensions = true;     \/\/保留后缀\n  form.maxFieldsSize = 2 * 1024 * 1024;   \/\/文件大小\n\n  form.parse(req, function(err, fields, files) {\n\n    if (err) {\n      res.locals.error = err;\n      res.render(\x27index\x27, { title: TITLE });\n      return;\n    }\n    console.log(files);\n\n    var extName = \x27\x27;  \/\/后缀名\n    switch (files.fulAvatar.type) {\n      case \x27image\/pjpeg\x27:\n        extName = \x27jpg\x27;\n        break;\n      case \x27image\/jpeg\x27:\n        extName = \x27jpg\x27;\n        break;\n      case \x27image\/png\x27:\n        extName = \x27png\x27;\n        break;\n      case \x27image\/x-png\x27:\n        extName = \x27png\x27;\n        break;\n    }\n\n    if(extName.length == 0){\n      res.locals.error = \x27只支持png和jpg格式图片\x27;\n      res.render(\x27index\x27, { title: TITLE });\n      return;\n    }\n\n    var avatarName = Math.random() \x2b \x27.\x27 \x2b extName;\n    \/\/图片写入地址；\n    var newPath = form.uploadDir \x2b avatarName;\n    \/\/显示地址；\n    var showUrl = domain \x2b AVATAR_UPLOAD_FOLDER \x2b avatarName;\n    console.log(\x26quot;newPath\x26quot;,newPath);\n    fs.renameSync(files.fulAvatar.path, newPath);  \/\/重命名\n    res.json({\n      \x26quot;newPath\x26quot;:showUrl\n    });\n  });\n});\nmodule.exports = router;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e express = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27express\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e router = express.Router();\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formidable = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27formidable\x27\x3c\/span\x3e),\n    fs = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27fs\x27\x3c\/span\x3e),\n    TITLE = \x3cspan class=\x22hljs-string\x22\x3e\x27formidable上传示例\x27\x3c\/span\x3e,\n    AVATAR_UPLOAD_FOLDER = \x3cspan class=\x22hljs-string\x22\x3e\x27\/avatar\/\x27\x3c\/span\x3e,\n    domain = \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/localhost:3000\x22\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/* 图片上传路由 *\/\x3c\/span\x3e\nrouter.post(\x3cspan class=\x22hljs-string\x22\x3e\x27\/uploader\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e form = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e formidable.IncomingForm();   \x3cspan class=\x22hljs-comment\x22\x3e\/\/创建上传表单\x3c\/span\x3e\n  form.encoding = \x3cspan class=\x22hljs-string\x22\x3e\x27utf-8\x27\x3c\/span\x3e;        \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置编辑\x3c\/span\x3e\n  form.uploadDir = \x3cspan class=\x22hljs-string\x22\x3e\x27public\x27\x3c\/span\x3e \x2b AVATAR_UPLOAD_FOLDER;     \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置上传目录\x3c\/span\x3e\n  form.keepExtensions = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;     \x3cspan class=\x22hljs-comment\x22\x3e\/\/保留后缀\x3c\/span\x3e\n  form.maxFieldsSize = \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e1024\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e1024\x3c\/span\x3e;   \x3cspan class=\x22hljs-comment\x22\x3e\/\/文件大小\x3c\/span\x3e\n\n  form.parse(req, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eerr, fields, files\x3c\/span\x3e) \x3c\/span\x3e{\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (err) {\n      res.locals.error = err;\n      res.render(\x3cspan class=\x22hljs-string\x22\x3e\x27index\x27\x3c\/span\x3e, { \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: TITLE });\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(files);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e extName = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;  \x3cspan class=\x22hljs-comment\x22\x3e\/\/后缀名\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eswitch\x3c\/span\x3e (files.fulAvatar.type) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27image\/pjpeg\x27\x3c\/span\x3e:\n        extName = \x3cspan class=\x22hljs-string\x22\x3e\x27jpg\x27\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27image\/jpeg\x27\x3c\/span\x3e:\n        extName = \x3cspan class=\x22hljs-string\x22\x3e\x27jpg\x27\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27image\/png\x27\x3c\/span\x3e:\n        extName = \x3cspan class=\x22hljs-string\x22\x3e\x27png\x27\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27image\/x-png\x27\x3c\/span\x3e:\n        extName = \x3cspan class=\x22hljs-string\x22\x3e\x27png\x27\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(extName.length == \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n      res.locals.error = \x3cspan class=\x22hljs-string\x22\x3e\x27只支持png和jpg格式图片\x27\x3c\/span\x3e;\n      res.render(\x3cspan class=\x22hljs-string\x22\x3e\x27index\x27\x3c\/span\x3e, { \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: TITLE });\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e avatarName = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random() \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27.\x27\x3c\/span\x3e \x2b extName;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/图片写入地址；\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e newPath = form.uploadDir \x2b avatarName;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/显示地址；\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e showUrl = domain \x2b AVATAR_UPLOAD_FOLDER \x2b avatarName;\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22newPath\x22\x3c\/span\x3e,newPath);\n    fs.renameSync(files.fulAvatar.path, newPath);  \x3cspan class=\x22hljs-comment\x22\x3e\/\/重命名\x3c\/span\x3e\n    res.json({\n      \x3cspan class=\x22hljs-string\x22\x3e\x22newPath\x22\x3c\/span\x3e:showUrl\n    });\n  });\n});\n\x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = router;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e图片传到后端其实就是一段2进制字符串，保存在内存中，需要用到fs模块读取后再写入到新的目录；打印\x3ccode\x3efiles\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{ fulAvatar: \n   File {\n     domain: null,\n     _events: {},\n     _eventsCount: 0,\n     _maxListeners: undefined,\n     size: 106836,\n     path: \x27public\/avatar\/upload_d75420a381af12d19db01599fd2d0b73.jpeg\x27,\n     name: \x27line.jpeg\x27,\n     type: \x27image\/jpeg\x27,\n     hash: null,\n     lastModifiedDate: 2016-12-19T15:22:47.896Z,\n     _writeStream: \n      WriteStream {\n        _writableState: [Object],\n        writable: false,\n        domain: null,\n        _events: {},\n        _eventsCount: 0,\n        _maxListeners: undefined,\n        path: \x27public\/avatar\/upload_d75420a381af12d19db01599fd2d0b73.jpeg\x27,\n        fd: null,\n        flags: \x27w\x27,\n        mode: 438,\n        start: undefined,\n        autoClose: true,\n        pos: undefined,\n        bytesWritten: 106836,\n        closed: true } } }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs yaml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3efulAvatar:\x3c\/span\x3e \n   \x3cspan class=\x22hljs-string\x22\x3eFile\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     domain:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     _events:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{},\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     _eventsCount:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     _maxListeners:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eundefined,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     size:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e106836\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     path:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27public\/avatar\/upload_d75420a381af12d19db01599fd2d0b73.jpeg\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27line.jpeg\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     type:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27image\/jpeg\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     hash:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     lastModifiedDate:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e2016\x3c\/span\x3e\x3cspan class=\x22hljs-bullet\x22\x3e-12\x3c\/span\x3e\x3cspan class=\x22hljs-bullet\x22\x3e-19\x3c\/span\x3e\x3cspan class=\x22hljs-attr\x22\x3eT15:22:47.896Z,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e     _writeStream:\x3c\/span\x3e \n      \x3cspan class=\x22hljs-string\x22\x3eWriteStream\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        _writableState:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e[Object],\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        writable:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        domain:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        _events:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e{},\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        _eventsCount:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        _maxListeners:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eundefined,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        path:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27public\/avatar\/upload_d75420a381af12d19db01599fd2d0b73.jpeg\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        fd:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        flags:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27w\x27\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        mode:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e438\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        start:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eundefined,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        autoClose:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        pos:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3eundefined,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        bytesWritten:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e106836\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e,\x3c\/span\x3e\n\x3cspan class=\x22hljs-attr\x22\x3e        closed:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e}\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上数据用fs模块读取path属性得到是就是一段2进制的字符串；\x3c\/p\x3e\n\x3ch5\x3e注：如果不配置express中间件，express是不能取到上传的文件的，这一块在路由回调函数的req上没有做处理。\x3c\/h5\x3e\n\x3cp\x3e以上的示例基本就完成一些基本功能了；\x3cbr\x3e疑惑就是网上一些jquery插件上传图片利用ajax，他们的原来是声明呢 ？希望有人给解释下\x3c\/p\x3e\n\x3cp\x3e找到一篇相似的文章：\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000006914679\x22\x3ehttps:\/\/segmentfault.com\/a\/11...\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e补充：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 var formData = new FormData();\n var fileObj = document.getElementById(\x26quot;file_upload\x26quot;).files[0];\n formData.append(\x26quot;fulAvatar\x26quot;, fileObj);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e formData = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FormData();\n \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e fileObj = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22file_upload\x22\x3c\/span\x3e).files[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n formData.append(\x3cspan class=\x22hljs-string\x22\x3e\x22fulAvatar\x22\x3c\/span\x3e, fileObj);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3eformData的两种用法一种是直接将表单dom直接塞进去，还有一种就是通过append填进去，但是这里要注意，填进去的是name和dom的files[0]属性；\x3c\/p\x3e\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>nodejs express图片上传前后端配置讲解</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005706031">https://segmentfault.com/a/1190000005706031</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/yh17w6ayiub/" target="_blank">https://alili.tech/archive/yh17w6ayiub/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>