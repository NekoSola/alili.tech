<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="vue单页面：当前页面刷新或跳转时提示保存"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>vue单页面：当前页面刷新或跳转时提示保存 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/6om0tjj0yfa/",
				"appid": "1613049289050283", 
				"title": "vue单页面：当前页面刷新或跳转时提示保存 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-14T02:30:37"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/vjzydjcscsb/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/1j4zgfa8m9x/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f&text=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f&text=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f&title=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f&is_video=false&description=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f&title=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f&title=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f&title=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f6om0tjj0yfa%2f&title=vue%e5%8d%95%e9%a1%b5%e9%9d%a2%ef%bc%9a%e5%bd%93%e5%89%8d%e9%a1%b5%e9%9d%a2%e5%88%b7%e6%96%b0%e6%88%96%e8%b7%b3%e8%bd%ac%e6%97%b6%e6%8f%90%e7%a4%ba%e4%bf%9d%e5%ad%98"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">vue单页面：当前页面刷新或跳转时提示保存</h1><div class="meta"><div class="postdate"><time datetime="2019-02-14" itemprop="datePublished">2019-02-14</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch3 id=\x22articleHeader0\x22\x3e前言\x3c\/h3\x3e\n\x3cblockquote\x3e最近公司vue项目中有一个需求，需要在当前页面刷新或跳转时提示保存并可取消刷新，以防止填写的表单内容丢失。刚开始思考觉得很简单，直接在Router的钩子中判断就好了，但是会发现还有新的问题存在，浏览器刷新和当前页面关闭的时候无法监听，最终用window.onbeforeunload成功解决，所以用这篇文章简单记录下整个解决过程。\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3evue-Router的钩子：\x3c\/h3\x3e\n\x3cp\x3e路由钩子可以分为\x3cstrong\x3e全局的，单个路由独享的以及组件级别的\x3c\/strong\x3e，解决上述需求只用到了组件级别的路由钩子，所以本文只介绍组件级别的路由钩子，全局的和单个路由独享的路由钩子有需要的同学可以去\x3ca href=\x22https:\/\/router.vuejs.org\/zh\/guide\/advanced\/navigation-guards.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3evue-router官网\x3c\/a\x3e查看介绍：\x3c\/p\x3e\n\x3cp\x3e组件级别路由钩子分为三种：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3ebeforeRouteEnter：当成功获取并能进入路由(在渲染该组件的对应路由被 confirm 前)\x3c\/li\x3e\n\x3cli\x3ebeforeRouteUpdate：在当前路由改变，但是该组件被复用时调用\x3c\/li\x3e\n\x3cli\x3ebeforeRouteLeave：导航离开该组件的对应路由时调用\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e具体的介绍和写法如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const Foo = {\n  template: `...`,\n  beforeRouteEnter (to, from, next) {\n    \/\/ 在渲染该组件的对应路由被 confirm 前调用\n    \/\/ 不！能！获取组件实例 `this`\n    \/\/ 因为当守卫执行前，组件实例还没被创建\n    \/\/ 可以通过传一个回调给 next来访问组件实例\n    next(vm =\x3e { \n            \/\/ 通过 `vm` 访问组件实例\n        })\n  },\n  beforeRouteUpdate (to, from, next) {\n    \/\/ 在当前路由改变，但是该组件被复用时调用\n    \/\/ 举例来说，对于一个带有动态参数的路径 \/foo\/:id，在 \/foo\/1 和 \/foo\/2 之间跳转的时候，\n    \/\/ 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。\n    \/\/ 可以访问组件实例 `this`\n    \/\/ 不支持传递回调(因为this实例已经创建可以获取到，所以没必要)\n    next()\n  },\n  beforeRouteLeave (to, from, next) {\n    \/\/ 导航离开该组件的对应路由时调用\n    \/\/ 可以访问组件实例 `this`\n    \/\/ 该导航可以通过 next(false) 来取消。\n    const answer = window.confirm(\x27Do you really want to leave? you have unsaved changes!\x27)\n    if (answer) {\n        next()\n    } else {\n    \/\/ 不支持传递回调(因为this实例已经创建可以获取到，所以没必要)\n        next(false)\n    }\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs awk\x22\x3e\x3ccode\x3econst Foo = {\n  template: `...`,\n  beforeRouteEnter (to, from, \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 在渲染该组件的对应路由被 confirm 前调用\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 不！能！获取组件实例 `this`\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 因为当守卫执行前，组件实例还没被创建\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 可以通过传一个回调给 \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e来访问组件实例\n    \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e(vm =\x26gt; { \n            \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 通过 `vm` 访问组件实例\n        })\n  },\n  beforeRouteUpdate (to, from, \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 在当前路由改变，但是该组件被复用时调用\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 举例来说，对于一个带有动态参数的路径 \x3cspan class=\x22hljs-regexp\x22\x3e\/foo\/\x3c\/span\x3e:id，在 \x3cspan class=\x22hljs-regexp\x22\x3e\/foo\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e 和 \x3cspan class=\x22hljs-regexp\x22\x3e\/foo\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e 之间跳转的时候，\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 可以访问组件实例 `this`\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 不支持传递回调(因为this实例已经创建可以获取到，所以没必要)\n    \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e()\n  },\n  beforeRouteLeave (to, from, \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 导航离开该组件的对应路由时调用\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 可以访问组件实例 `this`\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 该导航可以通过 \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e(false) 来取消。\n    const answer = window.confirm(\x3cspan class=\x22hljs-string\x22\x3e\x27Do you really want to leave? you have unsaved changes!\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (answer) {\n        \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e()\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e 不支持传递回调(因为this实例已经创建可以获取到，所以没必要)\n        \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e(false)\n    }\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e注意\x3c\/strong\x3e：在刷新当前页面时候，beforeRouteLeave不会触发，它只在进入到其他页面时候才会触发，但是beforeRouteEnter会在刷新的时候触发。\x3c\/p\x3e\n\x3cp\x3e通过beforeRouteLeave这个路由钩子，我们就可以在用户要离开此页面时候进行提示了！\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22beforeRouteLeave (to, from, next) {\n    const answer = window.confirm(\x27当前页面数据未保存，确定要离开？\x27)\n    if (answer) {\n        next()\n    } else {\n        next(false)\n    }\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs autoit\x22\x3e\x3ccode\x3ebeforeRouteLeave (\x3cspan class=\x22hljs-keyword\x22\x3eto\x3c\/span\x3e, from, \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e answer = window.confirm(\x3cspan class=\x22hljs-string\x22\x3e\x27当前页面数据未保存，确定要离开？\x27\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (answer) {\n        \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e()\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e(\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e)\n    }\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e显示的提示框如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/p5tstjsfi.bkt.clouddn.com\/vue-router1luyou.png\x22 src=\x22https:\/\/static.alili.techhttp:\/\/p5tstjsfi.bkt.clouddn.com\/vue-router1luyou.png\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e监听浏览器的刷新、页面关闭事件\x3c\/h3\x3e\n\x3cp\x3e但是，这个时候就实现了我们最终的需求了么？并没有，还有一步：用\x3cstrong\x3ewindow.onbeforeunload\x3c\/strong\x3e监听浏览器的刷新事件，当然为了防止从当前单页面跳到其他页面之后，在刷新所在新的页面还会触发window上的onbeforeunload的问题，我们不仅要及时的添加onbeforeunload事件，更要及时删除此事件，下面有两种解决方法可供选择：\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e通过判断它的路由是否是当前需要添加禁止刷新的页面\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22mounted() {\n    window.onbeforeunload = function (e) {\n      if(_this.$route.fullPath ==\x26quot;\/layout\/add\x26quot;){\n          e = e || window.event;\n          \/\/ 兼容IE8和Firefox 4之前的版本\n          if (e) {\n            e.returnValue = \x27关闭提示\x27;\n          }\n          \/\/ Chrome, Safari, Firefox 4\x2b, Opera 12\x2b , IE 9\x2b\n          return \x27关闭提示\x27;\n      }else{\n        window.onbeforeunload =null\n      }\n}\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3emounted() {\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onbeforeunload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(_this.$route.fullPath ==\x3cspan class=\x22hljs-string\x22\x3e\x22\/layout\/add\x22\x3c\/span\x3e){\n          e = e || \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.event;\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 兼容IE8和Firefox 4之前的版本\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e) {\n            e.returnValue = \x3cspan class=\x22hljs-string\x22\x3e\x27关闭提示\x27\x3c\/span\x3e;\n          }\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Chrome, Safari, Firefox 4\x2b, Opera 12\x2b , IE 9\x2b\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27关闭提示\x27\x3c\/span\x3e;\n      }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onbeforeunload =\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n      }\n}\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\x3cli\x3e在destory或者beforeDestory的生命周期中直接将onbeforeunload事件置空\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22mounted() {\n    window.onbeforeunload = function (e) {\n        e = e || window.event;\n        \/\/ 兼容IE8和Firefox 4之前的版本\n        if (e) {\n            e.returnValue = \x27关闭提示\x27;\n        }\n        \/\/ Chrome, Safari, Firefox 4\x2b, Opera 12\x2b , IE 9\x2b\n        return \x27关闭提示\x27;\n    }\n};\ndestroyed() {\n      window.onbeforeunload = null\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3emounted() {\n    \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onbeforeunload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n        e = e || \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.event;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 兼容IE8和Firefox 4之前的版本\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e) {\n            e.returnValue = \x3cspan class=\x22hljs-string\x22\x3e\x27关闭提示\x27\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Chrome, Safari, Firefox 4\x2b, Opera 12\x2b , IE 9\x2b\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27关闭提示\x27\x3c\/span\x3e;\n    }\n};\ndestroyed() {\n      \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.onbeforeunload = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e显示的提示框如下：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22http:\/\/p5tstjsfi.bkt.clouddn.com\/vue-router1%E8%B7%AF%E7%94%B1%E9%92%A9%E5%AD%90.png\x22 src=\x22https:\/\/static.alili.techhttp:\/\/p5tstjsfi.bkt.clouddn.com\/vue-router1%E8%B7%AF%E7%94%B1%E9%92%A9%E5%AD%90.png\x22 alt=\x22image\x22 title=\x22image\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e总结\x3c\/h3\x3e\n\x3cp\x3e最终，在beforeRouteLeave和onbeforeunload的共同作用下，这个刷新、跳转或者关闭等情况下需要提示保存的需求完美解决！但是，还有一点点小遗憾，就是onbeforeunload中弹框的自定义提示语设置始终无法生效，大家要是有更加合适的处理办法，欢迎多多交流指正！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>vue单页面：当前页面刷新或跳转时提示保存</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016874879">https://segmentfault.com/a/1190000016874879</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/6om0tjj0yfa/" target="_blank">https://alili.tech/archive/6om0tjj0yfa/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>