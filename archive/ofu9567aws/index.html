<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Vue.js源码分析-- eventsAPI--1.0.26"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Vue.js源码分析-- eventsAPI--1.0.26 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ofu9567aws/",
				"appid": "1613049289050283", 
				"title": "Vue.js源码分析-- eventsAPI--1.0.26 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-04T02:30:58"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/h8bmxix5eef/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/lvac13l8yi9/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f&text=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f&text=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f&title=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f&is_video=false&description=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f&title=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f&title=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f&title=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fofu9567aws%2f&title=Vue.js%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90--%20eventsAPI--1.0.26"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Vue.js源码分析-- eventsAPI--1.0.26</h1><div class="meta"><div class="postdate"><time datetime="2019-02-04" itemprop="datePublished">2019-02-04</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e近期开发的项目中前端使用的是Vue框架，很轻量，也很好用。不过，因为用的是别人家开发的框架，代码执行的情况是否跟我们意料的一致值得思考。调试代码或者利用测试框架测试input\/ouput挺好，不过我更倾向于看源码。能够被大众所广泛使用的框架的源码非常值得一看，好处就不多说了，因人而异。\x3c\/p\x3e\n\x3cp\x3e这次我看的是vue源码里的eventsAPI部分，包括$emit\/$broadcast\/$dispatch等。\x3c\/p\x3e\n\x3cp\x3e注：由于目前看到的只是冰山一角，所以牵连到其他部分的语句会暂时忽略，所以也有可能理解起来会有断章取义的可能，如果有理解错的还望指出，互相学习。在后续的源码阅读中，一有新的认识会立即更新。\x3c\/p\x3e\n\x3cp\x3eeventsAPI源码位置：src\/instance\/api\/events.js\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e私有函数 modifyListenerCount\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var hookRE = \/^hook:\/\nfunction modifyListenerCount (vm, event, count) {\n  var parent = vm.$parent\n  \/\/ hooks do not get broadcasted so no need\n  \/\/ to do bookkeeping for them\n  if (!parent || !count || hookRE.test(event)) return\n  while (parent) {\n    parent._eventsCount[event] =\n      (parent._eventsCount[event] || 0) \x2b count\n    parent = parent.$parent\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e hookRE = \x3cspan class=\x22hljs-regexp\x22\x3e\/^hook:\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3emodifyListenerCount\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3evm, event, count\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e = vm.$\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ hooks do not get broadcasted so no need\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ to do bookkeeping for them\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e || !count || hookRE.test(event)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e._eventsCount[event] =\n      (\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e._eventsCount[event] || \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) \x2b count\n    \x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e.$\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在events.js里边多次调用到该函数，用于向上遍历父组件，更新事件计数器。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e组件的_events属性，记录着每个event绑定的回调函数(数组)，比如_events[event] = [func1, func2, ...].\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e组件的_eventsCount属性，记录着自己以及子组件对每个event绑定的回调函数的总数目。每当子组件对event事件绑定了n个回调，那父组件（一直向上遍历到根）的_eventsCount[event]会\x2bn。目前发现，_eventsCount在$broadcast会使用到。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3eVue.prototype.$on\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Vue.prototype.$on = function (event, fn) {\n  (this._events[event] || (this._events[event] = []))\n    .push(fn)\n  modifyListenerCount(this, event, 1)\n  return this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3eVue.prototype.$\x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e = function (\x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e, fn) {\n  (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._events[\x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e] || (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._events[\x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e] = []))\n    .push(fn)\n  modifyListenerCount(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e基础函数，\x3cstrong\x3e事件监听绑定\x3c\/strong\x3e。组件将回调函数fn保存在_events[event]中，对同一event可以绑定多个回调函数，同时，通过modifyListenerCount更新所有父组件的_eventsCount[event]。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3eVue.prototype.$once\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Vue.prototype.$once = function (event, fn) {\n  var self = this\n  function on () {\n    self.$off(event, on)\n    fn.apply(this, arguments)\n  }\n  on.fn = fn\n  this.$on(event, on)\n  return this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3eVue.prototype.$once = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent, fn\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e self = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eon\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    self.$off(event, \x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e)\n    fn.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e.fn = fn\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$\x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e(event, \x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e$once：当event事件发生时，fn只会被调用一次，调用完成后通过$off解除绑定。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3eVue.prototype.$off\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Vue.prototype.$off = function (event, fn) {\n  var cbs\n  \/\/ all\n  if (!arguments.length) {\n    if (this.$parent) {\n      for (event in this._events) {\n        cbs = this._events[event]\n        if (cbs) {\n          modifyListenerCount(this, event, -cbs.length)\n        }\n      }\n    }\n    this._events = {}\n    return this\n  }\n  \/\/ specific event\n  cbs = this._events[event]\n  if (!cbs) {\n    return this\n  }\n  if (arguments.length === 1) {\n    modifyListenerCount(this, event, -cbs.length)\n    this._events[event] = null\n    return this\n  }\n  \/\/ specific handler\n  var cb\n  var i = cbs.length\n  while (i--) {\n    cb = cbs[i]\n    if (cb === fn || cb.fn === fn) {\n      modifyListenerCount(this, event, -1)\n      cbs.splice(i, 1)\n      break\n    }\n  }\n  return this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3eVue.prototype.$off = function (event, fn) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cbs\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ all\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!arguments.length) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$parent) {\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (event \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._events) {\n        cbs = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._events[event]\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (cbs) {\n          modifyListenerCount(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, event, -cbs.length)\n        }\n      }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._events = {}\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ specific event\x3c\/span\x3e\n  cbs = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._events[event]\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!cbs) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arguments.length === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) {\n    modifyListenerCount(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, event, -cbs.length)\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._events[event] = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ specific handler\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cb\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = cbs.length\n  \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (i--) {\n    cb = cbs[i]\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (cb === fn || cb.fn === fn) {\n      modifyListenerCount(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, event, \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e)\n      cbs.splice(i, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n      \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e$off：\x3cstrong\x3e解除事件绑定\x3c\/strong\x3e，源码可以看出它的三个调用方式：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3evm.$off()\x3cbr\x3e 不带参数：将删除组件所有绑定的事件(this._events = {})，在此之前，会遍历更新父组件的计数器。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evm.$off(event)\x3cbr\x3e 只带参数event：将删除组件对event绑定的所有事件，同样会遍历更新父组件的计数器。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evm.$off(event, fn)\x3cbr\x3e 带齐参数event和fn：将删除组件对event事件绑定的fn回调，同样会遍历更新父组件的计数器。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3eVue.prototype.$emit\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Vue.prototype.$emit = function (event) {\n  var isSource = typeof event === \x27string\x27\n  event = isSource\n    ? event\n    : event.name\n  var cbs = this._events[event]\n  var shouldPropagate = isSource || !cbs\n  if (cbs) {\n    cbs = cbs.length \x3e 1\n      ? toArray(cbs)\n      : cbs\n    \/\/ 这里的特殊处理暂且忽略，还得从其他源码推敲\n    \/\/ this is a somewhat hacky solution to the question raised\n    \/\/ in #2102: for an inline component listener like \x3ccomp @test=\x26quot;doThis\x26quot;\x3e,\n    \/\/ the propagation handling is somewhat broken. Therefore we\n    \/\/ need to treat these inline callbacks differently.\n    var hasParentCbs = isSource \x26amp;\x26amp; cbs.some(function (cb) {\n      return cb._fromParent\n    })\n    if (hasParentCbs) {\n      shouldPropagate = false\n    }\n    var args = toArray(arguments, 1)\n    for (var i = 0, l = cbs.length; i \x3c l; i\x2b\x2b) {\n      var cb = cbs[i]\n      var res = cb.apply(this, args)\n      if (res === true \x26amp;\x26amp; (!hasParentCbs || cb._fromParent)) {\n        shouldPropagate = true\n      }\n    }\n  }\n  return shouldPropagate\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3eVue.prototype.$emit = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e isSource = \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e event === \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e\n  event = isSource\n    ? event\n    : event.name\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cbs = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._events[event]\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e shouldPropagate = isSource || !cbs\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (cbs) {\n    cbs = cbs.length \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n      ? toArray(cbs)\n      : cbs\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这里的特殊处理暂且忽略，还得从其他源码推敲\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ this is a somewhat hacky solution to the question raised\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ in #2102: for an inline component listener like \x26lt;comp @test=\x22doThis\x22\x26gt;,\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ the propagation handling is somewhat broken. Therefore we\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ need to treat these inline callbacks differently.\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e hasParentCbs = isSource \x26amp;\x26amp; cbs.some(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ecb\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e cb._fromParent\n    })\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (hasParentCbs) {\n      shouldPropagate = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e args = toArray(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, l = cbs.length; i \x26lt; l; i\x2b\x2b) {\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cb = cbs[i]\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e res = cb.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, args)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (res === \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e \x26amp;\x26amp; (!hasParentCbs || cb._fromParent)) {\n        shouldPropagate = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n      }\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e shouldPropagate\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e$emit：用于调用自身对event绑定的回调函数。该函数会被$broadcast和$dispatch调用，所以对参数的event进行了适配。部分变量备注：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eisSource：是否是源组件发出的$emit事件。也就是说，只有直接调用vm.$emit事件或者$dispatch率先触发自己绑定的回调（$dispatch源码第一行）的时候，参数是event字符串，此时isScource才为true。其他情况，如$broadcast内部调用$emit，其参数会是一个非字符串，在下面的$broadcast和$dispatch可以看到，此时的参数会是{ name: event, source: this }。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eevent：由isSource可以得到：event即事件(字符串)。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eshouldPropagate：是否需要继续传播事件触发。源码中，遍历了event绑定的事件，除开(!hasParentCbs || cb._fromParent)这个不说，只要执行的绑定事件明确return true，shouldPropagate才会置为true。对于$progress，如果shouldPropagate为true，会触发继续向下传播事件。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3eVue.prototype.$broadcast\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Vue.prototype.$broadcast = function (event) {\n  var isSource = typeof event === \x27string\x27\n  event = isSource\n    ? event\n    : event.name\n  \/\/ if no child has registered for this event,\n  \/\/ then there\x27s no need to broadcast.\n  if (!this._eventsCount[event]) return\n  var children = this.$children\n  var args = toArray(arguments)\n  if (isSource) {\n    \/\/ use object event to indicate non-source emit\n    \/\/ on children\n    args[0] = { name: event, source: this }\n  }\n  for (var i = 0, l = children.length; i \x3c l; i\x2b\x2b) {\n    var child = children[i]\n    var shouldPropagate = child.$emit.apply(child, args)\n    if (shouldPropagate) {\n      child.$broadcast.apply(child, args)\n    }\n  }\n  return this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3eVue.prototype.$broadcast = function (\x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e isSource = \x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x27string\x27\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e = isSource\n    ? \x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e\n    : \x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e.name\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ if no child has registered for this event,\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ then there\x27s no need to broadcast.\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._eventsCount[\x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e]) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e children = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$children\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e args = toArray(arguments)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (isSource) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ use object event to indicate non-source emit\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ on children\x3c\/span\x3e\n    args[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] = { name: \x3cspan class=\x22hljs-keyword\x22\x3eevent\x3c\/span\x3e, source: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, l = children.length; i \x26lt; l; i\x2b\x2b) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e child = children[i]\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e shouldPropagate = child.$emit.apply(child, args)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (shouldPropagate) {\n      child.$broadcast.apply(child, args)\n    }\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此处isSource的理解跟$emit的理解差不多，指代是否最开始调用$broadcast。\x3c\/p\x3e\n\x3cp\x3e这里vm._eventsCount[event]起到作用了，如果该计数为0，说明其所有子组件包括递归下去的子组件都没有对event绑定回调。\x3c\/p\x3e\n\x3cp\x3e从for循环的写法可以看出，这里何时停止事件传播使用的方法类似于深度优先搜索（DFS）如下图\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVC1En?w=382\x26amp;h=292\x22 src=\x22https:\/\/static.alili.tech\/img\/bVC1En?w=382\x26amp;h=292\x22 alt=\x22深搜\x22 title=\x22深搜\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3eA组件发出$broadcast，自身不会调用监听event的事件，而是传递给子组件，子组件B1率先执行监听event的事件，其中有一个绑定事件return true，那么该B1继续传播事件，C1率先执行，C1所有监听event的回调事件都没有return true，所以C1不会往它的子组件传播事件。\x3c\/p\x3e\n\x3cp\x3e到此，只是遍历完最左侧的线，接下来轮到C2执行，C2执行后再决定是否需要传递给其子组件，接下来C3....执行完B1的子组件，接下来就B2，然后...\x3c\/p\x3e\n\x3cp\x3e从这里可以看出，如果某一层一个组件return true，那么会继续遍历新一层子组件，有点雪崩式的爆发，return true或许会导致性能下降，这种事件通知的机制或许需要改善改善，因为假设我只要通知B1和C1，结果还是会遍历B层其他组件还有C层其他组件，这样会消耗多余的资源，且注意，这里是同步。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3eVue.prototype.$dispatch\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Vue.prototype.$dispatch = function (event) {\n  var shouldPropagate = this.$emit.apply(this, arguments)\n  if (!shouldPropagate) return\n  var parent = this.$parent\n  var args = toArray(arguments)\n  \/\/ use object event to indicate non-source emit\n  \/\/ on parents\n  args[0] = { name: event, source: this }\n  while (parent) {\n    shouldPropagate = parent.$emit.apply(parent, args)\n    parent = shouldPropagate\n      ? parent.$parent\n      : null\n  }\n  return this\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3eVue.prototype.$dispatch = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e shouldPropagate = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$emit.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!shouldPropagate) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e args = toArray(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ use object event to indicate non-source emit\x3c\/span\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ on parents\x3c\/span\x3e\n  args[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] = { \x3cspan class=\x22hljs-attribute\x22\x3ename\x3c\/span\x3e: event, \x3cspan class=\x22hljs-attribute\x22\x3esource\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e }\n  \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e) {\n    shouldPropagate = \x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e.$emit.apply(\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e, args)\n    \x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e = shouldPropagate\n      ? \x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e.$\x3cspan class=\x22hljs-attribute\x22\x3eparent\x3c\/span\x3e\n      : \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e$dispatch相对简单，先触发自身对event绑定的回调，如果自己没有监听event的回调，则会继续调用父组件触发相应绑定的事件。如果有回调，还需要判断_fromParent这个属性，\x3cem\x3e这个不知何物，待发掘。\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e假设A-\x26gt;B-\x26gt;C三层，B发出$dispatch(\x27e\x27)，想要B和A执行，那么B需要return true; C发出$dispatch(\x27e\x27)，想要C和B执行，那么C需要return true。但此时B也return true了，所以A也会触发。所以如果遇到这种情况，可以修改dispatch的事件名字，比如C换成$dispatch(\x27f\x27)；或者通过传递其他参数来判断是否需要return true。（推荐前者，比较干净）\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3eVue的eventsAPI是比较好理解的模块，在看源码以前，原以为$broadcast和$dispatch是在$nextTick实现，现在才意识到是一调用便执行。所以如果有多个地方会return true,还是需要考虑下用其他方法，不然会阻塞挺久的。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Vue.js源码分析&ndash; eventsAPI&ndash;1.0.26</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000006879124">https://segmentfault.com/a/1190000006879124</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/ofu9567aws/" target="_blank">https://alili.tech/archive/ofu9567aws/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>