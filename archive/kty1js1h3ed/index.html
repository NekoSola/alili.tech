<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="zepto touch 库源码分析"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>zepto touch 库源码分析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/kty1js1h3ed/",
				"appid": "1613049289050283", 
				"title": "zepto touch 库源码分析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-07T02:30:16"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/o5bzjjdd9ah/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/rv4tkuvb9ds/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f&text=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f&text=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f&title=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f&is_video=false&description=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f&title=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f&title=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f&title=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkty1js1h3ed%2f&title=zepto%20touch%20%e5%ba%93%e6%ba%90%e7%a0%81%e5%88%86%e6%9e%90"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">zepto touch 库源码分析</h1><div class="meta"><div class="postdate"><time datetime="2019-02-07" itemprop="datePublished">2019-02-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e所谓 zepto 的 touch 其实就是指\x3ca href=\x22https:\/\/github.com\/madrobby\/zepto\/blob\/master\/src\/touch.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这个文件\x3c\/a\x3e啦,可以看到区区 165 行（包括注释）就完成了 swipe 和 tap 相关的事件实现。在正式开始分析源码之前，我们先说说 touch 相关的几个事件，因为无论是 tap 还是 swipe 都是基于他们的。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3etouch 相关事件\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3etouchstart 触摸屏幕的瞬间\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etouchmove 手指在屏幕上的移动过程一直触发\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etouchend 离开屏幕的瞬间\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etouchcancel 触摸取消（取决于浏览器实现，并不常用）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e触摸屏下事件触发顺序是\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22touchstart -\x3e touchmove -\x3e touchend -\x3e click\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xl\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3etouchstart\x3c\/span\x3e -\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3etouchmove\x3c\/span\x3e -\x26gt;\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3etouchend\x3c\/span\x3e -\x26gt;\x3c\/span\x3e click\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e引入 touch 的背景\x3c\/h2\x3e\n\x3cp\x3eclick事件在移动端上会有 300ms 的延迟，同时因为需要 \x3ccode\x3e长按\x3c\/code\x3e，\x3ccode\x3e双触击\x3c\/code\x3e 等富交互，所以我们通常都会引入类似 zepto 这样的库。zepto 实现了\x3ccode\x3e\x27swipe\x27, \x27swipeLeft\x27, \x27swipeRight\x27, \x27swipeUp\x27, \x27swipeDown\x27, \x27doubleTap\x27, \x27tap\x27, \x27singleTap\x27, \x27longTap\x27\x3c\/code\x3e 这样一些功能。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3ezepto touch 源码\x3c\/h2\x3e\n\x3cp\x3e我们直接看到 touch 源码的 49 行，从这里开始就是上述事件的实现了。不难想到 MSGesture 是对 mobile ie 的实现，本文不做讨论。往下面看到 66 行，\x3ccode\x3e$(document).on(\x27touchstart MSPointerDown pointerdown\x27)\x3c\/code\x3e 开始。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/判断事件类型是否为 touch\nif((_isPointerType = isPointerEventType(e, \x27down\x27)) \x26amp;\x26amp;\n  !isPrimaryTouch(e)) return\n\/\/ touches 是触摸点的数量\nfirstTouch = _isPointerType ? e : e.touches[0]\nif (e.touches \x26amp;\x26amp; e.touches.length === 1 \x26amp;\x26amp; touch.x2) {\n  touch.x2 = undefined\n  touch.y2 = undefined\n}\n\/\/ 记录第一次触摸的时间\nnow = Date.now()\n\/\/ 计算本次触摸与最后一次的时间差\ndelta = now - (touch.last || now)\n\/\/ 查找 touch 事件的 dom \ntouch.el = $(\x27tagName\x27 in firstTouch.target ?\n  firstTouch.target : firstTouch.target.parentNode)\n\/\/ 如果 touchTimeout 存在就清理掉\ntouchTimeout \x26amp;\x26amp; clearTimeout(touchTimeout)\n\/\/ 记录当前坐标\ntouch.x1 = firstTouch.pageX\ntouch.y1 = firstTouch.pageY\n\/\/ 触摸时间差小于 250ms 则为 DoubleTap\nif (delta \x3e 0 \x26amp;\x26amp; delta \x3c= 250) touch.isDoubleTap = true\n\/\/ 记录执行后的时间\ntouch.last = now\n\/\/ 留一个长触摸，如果 touchmove 会把这个清理掉\nlongTapTimeout = setTimeout(longTap, longTapDelay)  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/判断事件类型是否为 touch\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e((_isPointerType = isPointerEventType(e, \x3cspan class=\x22hljs-string\x22\x3e\x27down\x27\x3c\/span\x3e)) \x26amp;\x26amp;\n  !isPrimaryTouch(e)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ touches 是触摸点的数量\x3c\/span\x3e\nfirstTouch = _isPointerType ? e : e.touches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (e.touches \x26amp;\x26amp; e.touches.length === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e \x26amp;\x26amp; touch.x2) {\n  touch.x2 = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n  touch.y2 = \x3cspan class=\x22hljs-literal\x22\x3eundefined\x3c\/span\x3e\n}\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 记录第一次触摸的时间\x3c\/span\x3e\nnow = \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e.now()\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 计算本次触摸与最后一次的时间差\x3c\/span\x3e\ndelta = now - (touch.last || now)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 查找 touch 事件的 dom \x3c\/span\x3e\ntouch.el = $(\x3cspan class=\x22hljs-string\x22\x3e\x27tagName\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e firstTouch.target ?\n  firstTouch.target : firstTouch.target.parentNode)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果 touchTimeout 存在就清理掉\x3c\/span\x3e\ntouchTimeout \x26amp;\x26amp; clearTimeout(touchTimeout)\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 记录当前坐标\x3c\/span\x3e\ntouch.x1 = firstTouch.pageX\ntouch.y1 = firstTouch.pageY\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 触摸时间差小于 250ms 则为 DoubleTap\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (delta \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x26amp;\x26amp; delta \x26lt;= \x3cspan class=\x22hljs-number\x22\x3e250\x3c\/span\x3e) touch.isDoubleTap = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 记录执行后的时间\x3c\/span\x3e\ntouch.last = now\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 留一个长触摸，如果 touchmove 会把这个清理掉\x3c\/span\x3e\nlongTapTimeout = setTimeout(longTap, longTapDelay)  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来是 \x3ccode\x3e$(document).on(\x27touchmove MSPointerMove pointermove\x27)\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/判断事件类型是否为 move\nif((_isPointerType = isPointerEventType(e, \x27move\x27)) \x26amp;\x26amp;\n          !isPrimaryTouch(e)) return\nfirstTouch = _isPointerType ? e : e.touches[0]\n\/\/ 一旦进入 move 就会清理掉 LongTap\ncancelLongTap()\n\/\/ 当前手指坐标\ntouch.x2 = firstTouch.pageX\ntouch.y2 = firstTouch.pageY\n\/\/ x 轴和 y 轴的变化量 Math.abs 是取绝对值的意思\ndeltaX \x2b= Math.abs(touch.x1 - touch.x2)\ndeltaY \x2b= Math.abs(touch.y1 - touch.y2)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/判断事件类型是否为 move\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e((_isPointerType = isPointerEventType(e, \x3cspan class=\x22hljs-string\x22\x3e\x27move\x27\x3c\/span\x3e)) \x26amp;\x26amp;\n          !isPrimaryTouch(e)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\nfirstTouch = _isPointerType ? e : e.touches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 一旦进入 move 就会清理掉 LongTap\x3c\/span\x3e\ncancelLongTap()\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当前手指坐标\x3c\/span\x3e\ntouch.x2 = firstTouch.pageX\ntouch.y2 = firstTouch.pageY\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ x 轴和 y 轴的变化量 Math.abs 是取绝对值的意思\x3c\/span\x3e\ndeltaX \x2b= \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.x1 - touch.x2)\ndeltaY \x2b= \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.y1 - touch.y2)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后当然就是 \x3ccode\x3e$(document).on(\x27touchend MSPointerUp pointerup\x27)\x3c\/code\x3e 了，这个也是整个 touch 最为复杂的一部分。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if((_isPointerType = isPointerEventType(e, \x27up\x27)) \x26amp;\x26amp;\n          !isPrimaryTouch(e)) return\n        cancelLongTap()\n\n    \/\/ 如果是 swipe，x 轴或者 y 轴移动超过 30px\n    if ((touch.x2 \x26amp;\x26amp; Math.abs(touch.x1 - touch.x2) \x3e 30) ||\n        (touch.y2 \x26amp;\x26amp; Math.abs(touch.y1 - touch.y2) \x3e 30))\n\n      swipeTimeout = setTimeout(function() {\n        touch.el.trigger(\x27swipe\x27)\n        \/\/ swipeDirection 是判断 swipe 方向的\n        touch.el.trigger(\x27swipe\x27 \x2b (swipeDirection(touch.x1, touch.x2, touch.y1, touch.y2)))\n        touch = {}\n      }, 0)\n\n    \/\/ tap 事件\n    else if (\x27last\x27 in touch)\n      if (deltaX \x3c 30 \x26amp;\x26amp; deltaY \x3c 30) {\n         \/\/ tapTimeout 是为了 scroll 的时候方便清除\n        tapTimeout = setTimeout(function() {\n          \/\/ 创建 tap 事件，并增加 cancelTouch 方法\n          var event = $.Event(\x27tap\x27)\n          event.cancelTouch = cancelAll\n          touch.el.trigger(event)\n\n          \/\/ 触发 DoubleTap\n          if (touch.isDoubleTap) {\n            if (touch.el) touch.el.trigger(\x27doubleTap\x27)\n            touch = {}\n          }\n\n          \/\/ singleTap （这个概念是相对于 DoubleTap 的，可以看看我们在最初的那段源码解析中有这样一段 if (delta \x3e 0 \x26amp;\x26amp; delta \x3c= 250) touch.isDoubleTap = true ，所以 250 ms 之后没有二次触摸的就算是 singleTap 了 \n          else {\n            touchTimeout = setTimeout(function(){\n              touchTimeout = null\n              if (touch.el) touch.el.trigger(\x27singleTap\x27)\n              touch = {}\n            }, 250)\n          }\n        }, 0)\n      } else {\n        touch = {}\n      }\n      deltaX = deltaY = 0\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e((_isPointerType = isPointerEventType(e, \x3cspan class=\x22hljs-string\x22\x3e\x27up\x27\x3c\/span\x3e)) \x26amp;\x26amp;\n          !isPrimaryTouch(e)) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n        cancelLongTap()\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果是 swipe，x 轴或者 y 轴移动超过 30px\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((touch.x2 \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.x1 - touch.x2) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e) ||\n        (touch.y2 \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.abs(touch.y1 - touch.y2) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e))\n\n      swipeTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ swipeDirection 是判断 swipe 方向的\x3c\/span\x3e\n        touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27swipe\x27\x3c\/span\x3e \x2b (swipeDirection(touch.x1, touch.x2, touch.y1, touch.y2)))\n        touch = {}\n      }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ tap 事件\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-string\x22\x3e\x27last\x27\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e touch)\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (deltaX \x26lt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e \x26amp;\x26amp; deltaY \x26lt; \x3cspan class=\x22hljs-number\x22\x3e30\x3c\/span\x3e) {\n         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ tapTimeout 是为了 scroll 的时候方便清除\x3c\/span\x3e\n        tapTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建 tap 事件，并增加 cancelTouch 方法\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e event = $.Event(\x3cspan class=\x22hljs-string\x22\x3e\x27tap\x27\x3c\/span\x3e)\n          event.cancelTouch = cancelAll\n          touch.el.trigger(event)\n\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 触发 DoubleTap\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.isDoubleTap) {\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el) touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27doubleTap\x27\x3c\/span\x3e)\n            touch = {}\n          }\n\n          \x3cspan class=\x22hljs-comment\x22\x3e\/\/ singleTap （这个概念是相对于 DoubleTap 的，可以看看我们在最初的那段源码解析中有这样一段 if (delta \x26gt; 0 \x26amp;\x26amp; delta \x26lt;= 250) touch.isDoubleTap = true ，所以 250 ms 之后没有二次触摸的就算是 singleTap 了 \x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            touchTimeout = setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n              touchTimeout = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e\n              \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (touch.el) touch.el.trigger(\x3cspan class=\x22hljs-string\x22\x3e\x27singleTap\x27\x3c\/span\x3e)\n              touch = {}\n            }, \x3cspan class=\x22hljs-number\x22\x3e250\x3c\/span\x3e)\n          }\n        }, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e)\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        touch = {}\n      }\n      deltaX = deltaY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e整个读下来其实就是对 touchstart, touchmove, touchend 做了一些封装和判断，然后通过 zepto 自己的事件体系来注册和触发。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3efastclick 对比 zepto\x3c\/h2\x3e\n\x3cp\x3e我们在聊到移动端 js 方案的时候很容易听到这两者，但我个人认为这两者是无法对比的。原因如下：zepto 是一个移动端的 js 库，而 fastclick 专注于 click 在移动端的触发问题。fastclick 的 github 主页上有一句话是“Polyfill to remove click delays on browsers with touch UIs”，翻译过来就是干掉移动端 click 延时的补丁。这个延时就是我们在引入 touch 的背景里提到过。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3efastclick 源码分析\x3c\/h2\x3e\n\x3cp\x3e不愿意下代码的可以直接点这里\x3ca href=\x22https:\/\/github.com\/ftlabs\/fastclick\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3egithub地址\x3c\/a\x3e首先赞一下 fastclick 的代码注释，非常全。\x3c\/p\x3e\n\x3cp\x3efastclick 的使用非常简单，直接 \x3ccode\x3eFastClick.attach(document.body);\x3c\/code\x3e 一句话搞定。所以源码分析就从 attach 方法来看吧，824 行\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    FastClick.attach = function(layer, options) {\n        \/\/ 返回 FastClick 实例 layer 是一个 element 通常是 document.body ，options 自然就是配置了\n        return new FastClick(layer, options);\n    };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    FastClick.attach = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3elayer, options\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回 FastClick 实例 layer 是一个 element 通常是 document.body ，options 自然就是配置了\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FastClick(layer, options);\n    };\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来回到 23 行看到 FastClick 构造函数，\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 \/\/ 方法绑定，兼容老版本的安卓\nfunction bind(method, context) {\n    return function() { return method.apply(context, arguments); };\n}\n\nvar methods = [\x27onMouse\x27, \x27onClick\x27, \x27onTouchStart\x27, \x27onTouchMove\x27, \x27onTouchEnd\x27, \x27onTouchCancel\x27];\nvar context = this;\nfor (var i = 0, l = methods.length; i \x3c l; i\x2b\x2b) {\n    context[methods[i]] = bind(context[methods[i]], context);\n}\n \/\/ 事件处理绑定部分\nif (deviceIsAndroid) {\n    layer.addEventListener(\x27mouseover\x27, this.onMouse, true);\n    layer.addEventListener(\x27mousedown\x27, this.onMouse, true);\n    layer.addEventListener(\x27mouseup\x27, this.onMouse, true);\n}\n\nlayer.addEventListener(\x27click\x27, this.onClick, true);\nlayer.addEventListener(\x27touchstart\x27, this.onTouchStart, false);\nlayer.addEventListener(\x27touchmove\x27, this.onTouchMove, false);\nlayer.addEventListener(\x27touchend\x27, this.onTouchEnd, false);\nlayer.addEventListener(\x27touchcancel\x27, this.onTouchCancel, false);\n\n \/\/ stopImmediatePropagation 的兼容\n \n if (!Event.prototype.stopImmediatePropagation) {\n    layer.removeEventListener = function(type, callback, capture) {\n        var rmv = Node.prototype.removeEventListener;\n        if (type === \x27click\x27) {\n            rmv.call(layer, type, callback.hijacked || callback, capture);\n        } else {\n            rmv.call(layer, type, callback, capture);\n        }\n    };\n\n    layer.addEventListener = function(type, callback, capture) {\n        var adv = Node.prototype.addEventListener;\n        if (type === \x27click\x27) {\n            adv.call(layer, type, callback.hijacked || (callback.hijacked = function(event) {\n                if (!event.propagationStopped) {\n                    callback(event);\n                }\n            }), capture);\n        } else {\n            adv.call(layer, type, callback, capture);\n        }\n    };\n}\n\n\/\/ 如果 layer 有 onclick ，就把 onclick 转换为 addEventListener 的方式\nif (typeof layer.onclick === \x27function\x27) {\n    oldOnClick = layer.onclick;\n    layer.addEventListener(\x27click\x27, function(event) {\n        oldOnClick(event);\n    }, false);\n    layer.onclick = null;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 方法绑定，兼容老版本的安卓\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebind\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emethod, context\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e method.apply(context, \x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e); };\n}\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e methods = [\x3cspan class=\x22hljs-string\x22\x3e\x27onMouse\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onClick\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onTouchStart\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onTouchMove\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onTouchEnd\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27onTouchCancel\x27\x3c\/span\x3e];\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e context = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, l = methods.length; i \x26lt; l; i\x2b\x2b) {\n    context[methods[i]] = bind(context[methods[i]], context);\n}\n \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 事件处理绑定部分\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (deviceIsAndroid) {\n    layer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mouseover\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onMouse, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n    layer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mousedown\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onMouse, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n    layer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27mouseup\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onMouse, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n}\n\nlayer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onClick, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\nlayer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27touchstart\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onTouchStart, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\nlayer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27touchmove\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onTouchMove, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\nlayer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27touchend\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onTouchEnd, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\nlayer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27touchcancel\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.onTouchCancel, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n\n \x3cspan class=\x22hljs-comment\x22\x3e\/\/ stopImmediatePropagation 的兼容\x3c\/span\x3e\n \n \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!Event.prototype.stopImmediatePropagation) {\n    layer.removeEventListener = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, callback, capture\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e rmv = Node.prototype.removeEventListener;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (type === \x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e) {\n            rmv.call(layer, type, callback.hijacked || callback, capture);\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            rmv.call(layer, type, callback, capture);\n        }\n    };\n\n    layer.addEventListener = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etype, callback, capture\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e adv = Node.prototype.addEventListener;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (type === \x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e) {\n            adv.call(layer, type, callback.hijacked || (callback.hijacked = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!event.propagationStopped) {\n                    callback(event);\n                }\n            }), capture);\n        } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            adv.call(layer, type, callback, capture);\n        }\n    };\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果 layer 有 onclick ，就把 onclick 转换为 addEventListener 的方式\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e layer.onclick === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) {\n    oldOnClick = layer.onclick;\n    layer.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n        oldOnClick(event);\n    }, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n    layer.onclick = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eFastClick.prototype.onTouchStart 和 zepto 一样做了一些参数的纪录，所以我这里就直接跳到 FastClick.prototype.onTouchEnd 看 fastclick 的核心。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22FastClick.prototype.onTouchEnd = function(event) {\n    var forElement, trackingClickStart, targetTagName, scrollParent, touch, targetElement = this.targetElement;\n\n    if (!this.trackingClick) {\n        return true;\n    }\n    \/\/ 防止 double tap 的时间间隔内 click 触发\n    if ((event.timeStamp - this.lastClickTime) \x3c this.tapDelay) {\n        this.cancelNextClick = true;\n        return true;\n    }\n    \/\/ 超出 longtap 的时间\n    if ((event.timeStamp - this.trackingClickStart) \x3e this.tapTimeout) {\n        return true;\n    }\n\n    this.cancelNextClick = false;\n    \/\/ 纪录当前时间\n    this.lastClickTime = event.timeStamp;\n\n    trackingClickStart = this.trackingClickStart;\n    this.trackingClick = false;\n    this.trackingClickStart = 0;\n\n    if (deviceIsIOSWithBadTarget) {\n        touch = event.changedTouches[0];\n        targetElement = document.elementFromPoint(touch.pageX - window.pageXOffset, touch.pageY - window.pageYOffset) || targetElement;\n        targetElement.fastClickScrollParent = this.targetElement.fastClickScrollParent;\n    }\n    \/\/ 获取 targetTagName 上面的一段是 targetTagName 兼容性\n    targetTagName = targetElement.tagName.toLowerCase();\n    \/\/ 解决 label for\n    if (targetTagName === \x27label\x27) {\n        forElement = this.findControl(targetElement);\n        if (forElement) {\n            this.focus(targetElement);\n            if (deviceIsAndroid) {\n                return false;\n            }\n\n            targetElement = forElement;\n        }\n    } else if (this.needsFocus(targetElement)) {\n        if ((event.timeStamp - trackingClickStart) \x3e 100 || (deviceIsIOS \x26amp;\x26amp; window.top !== window \x26amp;\x26amp; targetTagName === \x27input\x27)) {\n            this.targetElement = null;\n            return false;\n        }\n        \/\/ 解决 input focus \n        this.focus(targetElement);\n        \/\/ 触发 sendClick\n        this.sendClick(targetElement, event);\n\n        if (!deviceIsIOS || targetTagName !== \x27select\x27) {\n            this.targetElement = null;\n            event.preventDefault();\n        }\n\n        return false;\n    }\n\n    if (deviceIsIOS \x26amp;\x26amp; !deviceIsIOS4) {\n        scrollParent = targetElement.fastClickScrollParent;\n        if (scrollParent \x26amp;\x26amp; scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {\n            return true;\n        }\n    }\n    \/\/ 最后就来触发 sendClick 了\n    if (!this.needsClick(targetElement)) {\n        event.preventDefault();\n        this.sendClick(targetElement, event);\n    }\n\n    return false;\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eFastClick.prototype.onTouchEnd = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eevent\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e forElement, trackingClickStart, targetTagName, scrollParent, touch, targetElement = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetElement;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.trackingClick) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 防止 double tap 的时间间隔内 click 触发\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((event.timeStamp - \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lastClickTime) \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.tapDelay) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cancelNextClick = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 超出 longtap 的时间\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((event.timeStamp - \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.trackingClickStart) \x26gt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.tapTimeout) {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cancelNextClick = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 纪录当前时间\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.lastClickTime = event.timeStamp;\n\n    trackingClickStart = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.trackingClickStart;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.trackingClick = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.trackingClickStart = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (deviceIsIOSWithBadTarget) {\n        touch = event.changedTouches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n        targetElement = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.elementFromPoint(touch.pageX - \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.pageXOffset, touch.pageY - \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.pageYOffset) || targetElement;\n        targetElement.fastClickScrollParent = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetElement.fastClickScrollParent;\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取 targetTagName 上面的一段是 targetTagName 兼容性\x3c\/span\x3e\n    targetTagName = targetElement.tagName.toLowerCase();\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 解决 label for\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (targetTagName === \x3cspan class=\x22hljs-string\x22\x3e\x27label\x27\x3c\/span\x3e) {\n        forElement = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.findControl(targetElement);\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (forElement) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.focus(targetElement);\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (deviceIsAndroid) {\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n            }\n\n            targetElement = forElement;\n        }\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.needsFocus(targetElement)) {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((event.timeStamp - trackingClickStart) \x26gt; \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e || (deviceIsIOS \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.top !== \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e \x26amp;\x26amp; targetTagName === \x3cspan class=\x22hljs-string\x22\x3e\x27input\x27\x3c\/span\x3e)) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetElement = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 解决 input focus \x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.focus(targetElement);\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 触发 sendClick\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.sendClick(targetElement, event);\n\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!deviceIsIOS || targetTagName !== \x3cspan class=\x22hljs-string\x22\x3e\x27select\x27\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetElement = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n            event.preventDefault();\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (deviceIsIOS \x26amp;\x26amp; !deviceIsIOS4) {\n        scrollParent = targetElement.fastClickScrollParent;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (scrollParent \x26amp;\x26amp; scrollParent.fastClickLastScrollTop !== scrollParent.scrollTop) {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n        }\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 最后就来触发 sendClick 了\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.needsClick(targetElement)) {\n        event.preventDefault();\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.sendClick(targetElement, event);\n    }\n\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e看完上面的代码，我们马上来解读 FastClick.prototype.sendClick\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22FastClick.prototype.sendClick = function(targetElement, event) {\n    var clickEvent, touch;\n    \/\/ 拿触摸的第一个手指\n    touch = event.changedTouches[0];\n    \/\/ 自定义 clickEvent 事件\n    clickEvent = document.createEvent(\x27MouseEvents\x27);\n    clickEvent.initMouseEvent(this.determineEventType(targetElement), true, true, window, 1, touch.screenX, touch.screenY, touch.clientX, touch.clientY, false, false, false, false, 0, null);\n    clickEvent.forwardedTouchEvent = true;\n    \/\/ 触发 clickEvent 事件\n    targetElement.dispatchEvent(clickEvent);\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3eFastClick.prototype.sendClick = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etargetElement, event\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e clickEvent, touch;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 拿触摸的第一个手指\x3c\/span\x3e\n    touch = event.changedTouches[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 自定义 clickEvent 事件\x3c\/span\x3e\n    clickEvent = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createEvent(\x3cspan class=\x22hljs-string\x22\x3e\x27MouseEvents\x27\x3c\/span\x3e);\n    clickEvent.initMouseEvent(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.determineEventType(targetElement), \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, touch.screenX, touch.screenY, touch.clientX, touch.clientY, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e);\n    clickEvent.forwardedTouchEvent = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 触发 clickEvent 事件\x3c\/span\x3e\n    targetElement.dispatchEvent(clickEvent);\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e到此 fastclick 主要的东西我们就看得差不多了，代码当中不难看到 fastclick 的兼容性做的很好。它的主要目的是解决 click 在触摸屏下的使用，引入之后再初始化一次就好了，很适合复用代码的情景。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e扩展讲一下 touchEvent\x3c\/h2\x3e\n\x3cp\x3e本文中 zepto 和 fastclick 都有用到 touchEvent，但是 zepto 当中用的是 \x3ccode\x3ee.touches\x3c\/code\x3e 而 fastclick 却用的是 \x3ccode\x3ee.targetTouches\x3c\/code\x3e。这两者的差异我们来一点一点地扒。\x3c\/p\x3e\n\x3cp\x3eTouchEvent 是一类描述手指在触摸平面（触摸屏、触摸板等）的状态变化的事件。这类事件用于描述一个或多个触点，使开发者可以检测触点的移动，触点的增加和减少，等等。\x3c\/p\x3e\n\x3cp\x3e属性：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouchEvent.changedTouches\x3c\/code\x3e 一个 TouchList 对象，包含了代表所有从上一次触摸事件到此次事件过程中，状态发生了改变的触点的 Touch 对象。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouchEvent.targetTouches\x3c\/code\x3e 一个 TouchList 对象，是包含了如下触点的 Touch 对象：触摸起始于当前事件的目标 element 上，并且仍然没有离开触摸平面的触点.\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouchEvent.touches\x3c\/code\x3e 一个 TouchList 对象，包含了所有当前接触触摸平面的触点的 Touch 对象，无论它们的起始于哪个 element 上，也无论它们状态是否发生了变化。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouchEvent.type\x3c\/code\x3e 此次触摸事件的类型，可能值为 touchstart, touchmove, touchend 等等\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouchEvent.target\x3c\/code\x3e 触摸事件的目标 element，这个目标元素对应 \x3ccode\x3eTouchEvent.changedTouches\x3c\/code\x3e 中的触点的起始元素。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouchEvent.altKey, TouchEvent.ctrlKey, TouchEvent.metaKey, TouchEvent.shiftKey\x3c\/code\x3e 触摸事件触发时，键盘对应的键（例如 alt ）是否被按下。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3eTouchList 与 Touch\x3c\/h3\x3e\n\x3cp\x3eTouchList 就是一系列的 Touch，通过 \x3ccode\x3eTouchList.length\x3c\/code\x3e 可以知道当前有几个触点，\x3ccode\x3eTouchList[0]\x3c\/code\x3e 或者 \x3ccode\x3eTouchList.item(0)\x3c\/code\x3e 用来访问第一个触点。\x3c\/p\x3e\n\x3cp\x3e属性\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouch.identifier\x3c\/code\x3e：touch 的唯一标志，整个 touch 过程中（也就是 end 之前）不会改变\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouch.screenX\x3c\/code\x3e 和 \x3ccode\x3eTouch.screenY\x3c\/code\x3e：坐标原点为屏幕左上角\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouch.clientX\x3c\/code\x3e 和 \x3ccode\x3eTouch.clientY\x3c\/code\x3e：坐标原点在当前可视区域左上角，这两个值不包含滚动偏移\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouch.pageX\x3c\/code\x3e 和 \x3ccode\x3eTouch.pageY\x3c\/code\x3e：坐标原点在HTML文档左上角，这两个值包含了水平滚动的偏移\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouch.radiusX\x3c\/code\x3e 和 \x3ccode\x3eTouch.radiusY\x3c\/code\x3e：触摸平面的最小椭圆的水平轴(X轴)半径和垂直轴(Y轴)半径\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouch.rotationAngle\x3c\/code\x3e：触摸平面的最小椭圆与水平轴顺时针夹角\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouch.force\x3c\/code\x3e：压力值 0.0-1.0\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3eTouch.target\x3c\/code\x3e：Touch相关事件触发时的 element 不会随 move 变化。如果 move 当中该元素被删掉，这个 target 依然会不变，但不会冒泡。最佳实践是将触摸事件的监听器绑定到这个元素本身, 防止元素被移除后, 无法再从它的上一级元素上侦测到从该元素冒泡的事件。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e希望本文能解答一些大家在移动端开发当中的一些问题，本文行文匆忙如有不正确的地方希望能回复告知。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>zepto touch 库源码分析</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005882908">https://segmentfault.com/a/1190000005882908</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/kty1js1h3ed/" target="_blank">https://alili.tech/archive/kty1js1h3ed/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>