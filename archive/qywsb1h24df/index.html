<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="手把手教你写电商爬虫-第五课 京东商品评论爬虫 一起来对付反爬虫"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>手把手教你写电商爬虫-第五课 京东商品评论爬虫 一起来对付反爬虫 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qywsb1h24df/",
				"appid": "1613049289050283", 
				"title": "手把手教你写电商爬虫-第五课 京东商品评论爬虫 一起来对付反爬虫 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-10T02:30:42"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/4k7ukr4f1qa/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/9czxbwbg88f/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f&text=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f&text=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f&is_video=false&description=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqywsb1h24df%2f&title=%e6%89%8b%e6%8a%8a%e6%89%8b%e6%95%99%e4%bd%a0%e5%86%99%e7%94%b5%e5%95%86%e7%88%ac%e8%99%ab-%e7%ac%ac%e4%ba%94%e8%af%be%20%e4%ba%ac%e4%b8%9c%e5%95%86%e5%93%81%e8%af%84%e8%ae%ba%e7%88%ac%e8%99%ab%20%e4%b8%80%e8%b5%b7%e6%9d%a5%e5%af%b9%e4%bb%98%e5%8f%8d%e7%88%ac%e8%99%ab"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">手把手教你写电商爬虫-第五课 京东商品评论爬虫 一起来对付反爬虫</h1><div class="meta"><div class="postdate"><time datetime="2019-02-10" itemprop="datePublished">2019-02-10</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e系列教程：\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005116394\x22\x3e手把手教你写电商爬虫-第一课 找个软柿子捏捏\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005133842\x22 target=\x22_blank\x22\x3e手把手教你写电商爬虫-第二课 实战尚妆网分页商品采集爬虫\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005134077\x22\x3e手把手教你写电商爬虫-第三课 实战尚妆网AJAX请求处理和内容提取\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005134609\x22 target=\x22_blank\x22\x3e手把手教你写电商爬虫-第四课 淘宝网商品爬虫自动JS渲染\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e四节课过去了，咱们在爬虫界也都算见过世面的人，现在再来一些什么ajax加载之类的小鱼小虾应该不在话下了，即使是淘宝这种大量的ajax，我们祭上我们的核武器，也轻松应对了，这一课主要是来看看除了技术上的页面处理外，我们还会遇上更棘手的问题，就是反爬虫，当然现在有各种各样的反爬虫，今天就先介绍最简单的一种：限制IP。\x3c\/p\x3e\n\x3cp\x3e今天咱们的对手依然是业界大佬，马云最忌惮的男人，宅男心中爱恨交错的对象 - JD.COM\x3c\/p\x3e\n\x3cp\x3e也不用我安利，特别是程序员，有几个没给京东送过钱的。废话不多说，先上工具：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e1、神箭手云爬虫，2、Chrome浏览器 3、Chrome的插件XpathHelper 不知道是干嘛的同学请移步第一课\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e打开网站瞅一眼：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVvHWS\x22 src=\x22https:\/\/static.alili.tech\/img\/bVvHWS\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e好了，相信我，截这张图绝对不是在虐你们这些单身狗。我们就是科学的研究一下这个页面，没啥特别的：大厂风，硬仗准备。\x3c\/p\x3e\n\x3cp\x3e先来挑一个分类吧，这次挑一个大家都熟悉的互联网书类：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22http:\/\/search.jd.com\/Search?keyword=Python\x26amp;enc=utf-8\x26amp;book=y\x26amp;wq=Python\x26amp;pvid=33xo9lni.p4a1qb\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vim\x22\x3e\x3ccode\x3ehttp:\/\/\x3cspan class=\x22hljs-built_in\x22\x3esearch\x3c\/span\x3e.jd.\x3cspan class=\x22hljs-keyword\x22\x3ecom\x3c\/span\x3e\/Search?keyword=Python\x26amp;enc=utf-\x3cspan class=\x22hljs-number\x22\x3e8\x3c\/span\x3e\x26amp;book=\x3cspan class=\x22hljs-keyword\x22\x3ey\x3c\/span\x3e\x26amp;\x3cspan class=\x22hljs-keyword\x22\x3ewq\x3c\/span\x3e=Python\x26amp;pvid=\x3cspan class=\x22hljs-number\x22\x3e33\x3c\/span\x3exo9lni.p4a1qb\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你们的最爱，python从入门到放弃的全部资料。\x3c\/p\x3e\n\x3cp\x3e和前面几节课类似的分析这节课就不做了，对于分页，ajax请求什么的，大家可以直接参考前面的四节课，这一刻主要特别的是，我们在采集商品的同时，会将京东的商品评价采集下来。同时呢，我们也探讨下该如何应对京东对IP的限制，OK，先直接上代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var configs = {  \n    domains: [\x26quot;search.jd.com\x26quot;,\x26quot;item.jd.com\x26quot;,\x26quot;club.jd.com\x26quot;],  \n    scanUrls: [\x26quot;http:\/\/search.jd.com\/Search?keyword=Python\x26amp;enc=utf-8\x26amp;qrst=1\x26amp;rt=1\x26amp;stop=1\x26amp;book=y\x26amp;vt=2\x26amp;page=1\x26amp;s=1\x26amp;click=0\x26quot;],  \n    contentUrlRegexes: [\x26quot;http:\/\/item\\\\.jd\\\\.com\/\\\\d\x2b.html\x26quot;],  \n    helperUrlRegexes: [\x26quot;http:\/\/search\\\\.jd\\\\.com\/Search\\\\?keyword=Python\x26amp;enc=utf-8\x26amp;qrst=1\x26amp;rt=1\x26amp;stop=1\x26amp;book=y\x26amp;vt=2\x26amp;page=\\\\d\x2b\x26amp;s=1\x26amp;click=0\x26quot;],\/\/可留空  \n    fields: [  \n        {  \n            \/\/ 第一个抽取项  \n            name: \x26quot;title\x26quot;,  \n            selector: \x26quot;\/\/div[@id=\x27name\x27]\/h1\x26quot;,\/\/默认使用XPath  \n            required: true \/\/是否不能为空  \n        },  \n        {  \n            \/\/ 第一个抽取项  \n            name: \x26quot;productid\x26quot;,  \n            selector: \x26quot;\/\/div[contains(@class,\x27fl\x27)]\/span[2]\x26quot;,\/\/默认使用XPath  \n            required: true \/\/是否不能为空  \n        },  \n        {  \n            name: \x26quot;comments\x26quot;,  \n            sourceType: SourceType.AttachedUrl,  \n            attachedUrl: \x26quot;http:\/\/club.jd.com\/productpage\/p-{productid}-s-0-t-3-p-0.html\x26quot;,  \n            selectorType: SelectorType.JsonPath,  \n            selector: \x26quot;$.comments\x26quot;,  \n            repeated: true,  \n            children:[  \n                {  \n                    name: \x26quot;com_content\x26quot;,  \n                    selectorType: SelectorType.JsonPath,  \n                    selector: \x26quot;$.content\x26quot;  \n                },  \n                {  \n                    name: \x26quot;com_nickname\x26quot;,  \n                    selectorType: SelectorType.JsonPath,  \n                    selector: \x26quot;$.nickname\x26quot;  \n                },  \n            ]  \n        }  \n    ]  \n};  \nconfigs.onProcessHelperUrl = function(url, content, site){  \n    if(!content.indexOf(\x26quot;抱歉，没有找到\x26quot;)){  \n        var currentPage = parseInt(url.substring(url.indexOf(\x26quot;\x26amp;page=\x26quot;) \x2b 6));  \n        if(currentPage == 0){  \n            currentPage = 1;  \n        }  \n        var page = currentPage \x2b 2;  \n        var nextUrl = url.replace(\x26quot;\x26amp;page=\x26quot; \x2b currentPage, \x26quot;\x26amp;page=\x26quot; \x2b page);  \n        site.addUrl(nextUrl);  \n    }  \n    return true;  \n};  \nvar crawler = new Crawler(configs);  \ncrawler.start();  \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3evar configs = {  \n\x3cspan class=\x22hljs-symbol\x22\x3e    domains:\x3c\/span\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x22search.jd.com\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22item.jd.com\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22club.jd.com\x22\x3c\/span\x3e],  \n\x3cspan class=\x22hljs-symbol\x22\x3e    scanUrls:\x3c\/span\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/search.jd.com\/Search?keyword=Python\x26amp;enc=utf-8\x26amp;qrst=1\x26amp;rt=1\x26amp;stop=1\x26amp;book=y\x26amp;vt=2\x26amp;page=1\x26amp;s=1\x26amp;click=0\x22\x3c\/span\x3e],  \n\x3cspan class=\x22hljs-symbol\x22\x3e    contentUrlRegexes:\x3c\/span\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/item\\\\.jd\\\\.com\/\\\\d\x2b.html\x22\x3c\/span\x3e],  \n\x3cspan class=\x22hljs-symbol\x22\x3e    helperUrlRegexes:\x3c\/span\x3e [\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/search\\\\.jd\\\\.com\/Search\\\\?keyword=Python\x26amp;enc=utf-8\x26amp;qrst=1\x26amp;rt=1\x26amp;stop=1\x26amp;book=y\x26amp;vt=2\x26amp;page=\\\\d\x2b\x26amp;s=1\x26amp;click=0\x22\x3c\/span\x3e],\x3cspan class=\x22hljs-comment\x22\x3e\/\/可留空  \x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e    fields:\x3c\/span\x3e [  \n        {  \n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 第一个抽取项  \x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e            name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22title\x22\x3c\/span\x3e,  \n\x3cspan class=\x22hljs-symbol\x22\x3e            selector:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22\/\/div[@id=\x27name\x27]\/h1\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/默认使用XPath  \x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e            required:\x3c\/span\x3e true \x3cspan class=\x22hljs-comment\x22\x3e\/\/是否不能为空  \x3c\/span\x3e\n        },  \n        {  \n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 第一个抽取项  \x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e            name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22productid\x22\x3c\/span\x3e,  \n\x3cspan class=\x22hljs-symbol\x22\x3e            selector:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22\/\/div[contains(@class,\x27fl\x27)]\/span[2]\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/默认使用XPath  \x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3e            required:\x3c\/span\x3e true \x3cspan class=\x22hljs-comment\x22\x3e\/\/是否不能为空  \x3c\/span\x3e\n        },  \n        {  \n\x3cspan class=\x22hljs-symbol\x22\x3e            name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22comments\x22\x3c\/span\x3e,  \n\x3cspan class=\x22hljs-symbol\x22\x3e            sourceType:\x3c\/span\x3e SourceType.AttachedUrl,  \n\x3cspan class=\x22hljs-symbol\x22\x3e            attachedUrl:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/club.jd.com\/productpage\/p-{productid}-s-0-t-3-p-0.html\x22\x3c\/span\x3e,  \n\x3cspan class=\x22hljs-symbol\x22\x3e            selectorType:\x3c\/span\x3e SelectorType.JsonPath,  \n\x3cspan class=\x22hljs-symbol\x22\x3e            selector:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22$.comments\x22\x3c\/span\x3e,  \n\x3cspan class=\x22hljs-symbol\x22\x3e            repeated:\x3c\/span\x3e true,  \n\x3cspan class=\x22hljs-symbol\x22\x3e            children:\x3c\/span\x3e[  \n                {  \n\x3cspan class=\x22hljs-symbol\x22\x3e                    name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22com_content\x22\x3c\/span\x3e,  \n\x3cspan class=\x22hljs-symbol\x22\x3e                    selectorType:\x3c\/span\x3e SelectorType.JsonPath,  \n\x3cspan class=\x22hljs-symbol\x22\x3e                    selector:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22$.content\x22\x3c\/span\x3e  \n                },  \n                {  \n\x3cspan class=\x22hljs-symbol\x22\x3e                    name:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22com_nickname\x22\x3c\/span\x3e,  \n\x3cspan class=\x22hljs-symbol\x22\x3e                    selectorType:\x3c\/span\x3e SelectorType.JsonPath,  \n\x3cspan class=\x22hljs-symbol\x22\x3e                    selector:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22$.nickname\x22\x3c\/span\x3e  \n                },  \n            ]  \n        }  \n    ]  \n};  \nconfigs.onProcessHelperUrl = function(url, content, site){  \n    if(!content.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x22抱歉，没有找到\x22\x3c\/span\x3e)){  \n        var currentPage = parseInt(url.substring(url.indexOf(\x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;page=\x22\x3c\/span\x3e) \x2b \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e));  \n        if(currentPage == \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){  \n            currentPage = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;  \n        }  \n        var page = currentPage \x2b \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;  \n        var nextUrl = url.replace(\x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;page=\x22\x3c\/span\x3e \x2b currentPage, \x3cspan class=\x22hljs-string\x22\x3e\x22\x26amp;page=\x22\x3c\/span\x3e \x2b page);  \n        site.addUrl(nextUrl);  \n    }  \n    return true;  \n};  \nvar crawler = new Crawler(configs);  \ncrawler.start();  \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里主要给大家讲一下这个评论的配置，由于评论是多项，且评论还有子项，在框架中，是通过children关键字来配置的。具体参照代码既可，我们可以在子项中在定义不同的字段，像这里的comments抽取项会有content和nickname两个子抽取项，分别对应的是评论的内容和昵称。\x3c\/p\x3e\n\x3cp\x3e这里是一个简化的版本，由于京东页面相对很复杂，我们在抽取评论的时候，只抽取前一部分评论，当然我们还可以拿到更多的信息，包括评论数，评论人的等级等等，这里大家就自行探索吧。\x3c\/p\x3e\n\x3cp\x3e最后，由于京东会对IP进行封锁，虽然说神箭手会自动分布式开启爬虫，不过依然扛不住京东大叔的封锁，因此这里需要通过接入代理IP解决这样的问题，类似开启js渲染，爬取速度会大大下降，需要大家耐心等待结果喽，代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22configs.enableProxy = true;  \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs nix\x22\x3e\x3ccode\x3econfigs.\x3cspan class=\x22hljs-attr\x22\x3eenableProxy\x3c\/span\x3e = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;  \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e大功告成，开启爬虫，喝杯咖啡，京东商品的评论就可以看到啦：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVvHWu\x22 src=\x22https:\/\/static.alili.tech\/img\/bVvHWu\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e评论因为是数字，因此会存储的时候，会直接存储成json格式：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVvHWw\x22 src=\x22https:\/\/static.alili.tech\/img\/bVvHWw\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e对爬虫感兴趣的童鞋可以加qq群讨论：342953471。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>手把手教你写电商爬虫-第五课 京东商品评论爬虫 一起来对付反爬虫</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005134770">https://segmentfault.com/a/1190000005134770</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qywsb1h24df/" target="_blank">https://alili.tech/archive/qywsb1h24df/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>