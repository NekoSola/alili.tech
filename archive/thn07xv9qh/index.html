<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="页面性能优化实践总结"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>页面性能优化实践总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/thn07xv9qh/",
				"appid": "1613049289050283", 
				"title": "页面性能优化实践总结 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-07T02:30:15"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/8xj5ijvsjku/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/0cmme76hvn4m/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f&text=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f&text=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f&title=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f&is_video=false&description=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f&title=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f&title=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f&title=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fthn07xv9qh%2f&title=%e9%a1%b5%e9%9d%a2%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96%e5%ae%9e%e8%b7%b5%e6%80%bb%e7%bb%93"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">页面性能优化实践总结</h1><div class="meta"><div class="postdate"><time datetime="2019-02-07" itemprop="datePublished">2019-02-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e页面性能优化\x3c\/h1\x3e\n\x3cp\x3e\x3ccode\x3e学而不思则惘，思而不学则殆\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e前几天接到一个页面效果优化的任务，边做边查阅了一些关于页面性能的资料。做完任务之后，抽空写了一篇总结，梳理一下思路，加深自己的理解。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e1. chrome的timeline\x3c\/h2\x3e\n\x3cp\x3e先思考这样的一个问题：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e什么叫页面性能好？如何进行评判？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e直观上讲，我们通常会通过一个页面流不流畅来判断一个页面的性能好不好。但是开发中，总不能这么随意吧。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e1-1 fps\x3c\/h3\x3e\n\x3cp\x3eFPS(frame per second)，即一秒之间能够完成多少次重新渲染.\x3c\/p\x3e\n\x3cp\x3e网页动画的每一帧（frame）都是一次重新渲染，每秒低于\x3ccode\x3e24帧\x3c\/code\x3e的动画，人眼就能感受到停顿。一般的网页动画，\x3ccode\x3e需要达到每秒30帧到60帧的频率，才能比较流畅\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e而大多数显示器的刷新频率是\x3ccode\x3e60Hz\x3c\/code\x3e，为了与系统一致，以及节省电力，浏览器会自动按照这个频率，刷新动画。所以，如果网页能够做到每秒60帧，就会跟显示器同步刷新，达到最佳的视觉效果。这意味着，一秒之内进行60次重新渲染，每次重新渲染的时间不能超过\x3ccode\x3e16.66ms\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cem\x3e在实际的开发，只要达到30fps就可以了\x3c\/em\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e1-2 timeline\x3c\/h3\x3e\n\x3cp\x3e强大的chrome给我们提供了一个工具，叫做timeline，在帧模式下，我们可以看到代码的执行情况\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVzb66\x22 src=\x22https:\/\/static.alili.tech\/img\/bVzb66\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e柱状\x27frame\x27：表示渲染过程中的一帧，也就是浏览器为了渲染单个内容块而必须要做的工作，包括：执行js，处理事件，修改DOM，更改样式和布局，绘制页面等。帧柱的高度表示了该帧的总耗时，帧柱中的颜色分别对应该帧中包含的不停类型的事件。我们的目标就是控制其在30fps，即1000ms \/ 30 = \x3ccode\x3e33.34ms\x3c\/code\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e蓝色: 网络和HTML解析\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e黄色: JavaScript 脚本运行\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e紫色: 样式重计算和布局 ( Layout , Recaculate Style, Update Layer tree)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e绿色: 绘制和合成 ( Paint , Composite Layers)\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e30fps和60fps的基准线，可以直观地看到页面每一帧的情况\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e灰色区块：那些没有被DevTools感知到的活动\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e空白区块：显示刷新周期（display refresh cycles）中的空闲时间段？？\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eevent ：事件，上面可以看到触发了什么的事件，然后执行的语句是哪些，\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3erecalculate style: 重新计算样式\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eupdate layer tree: 【耗时】\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecomposite layers: 【耗时】\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3epaint X n: 【耗时】\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e2. 页面渲染的原理和过程\x3c\/h2\x3e\n\x3cp\x3e接下来思考这个问题：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e什么是update layer tree，什么是compsite layers，它们为什么那么耗时？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e要理解\x3ccode\x3eupdate layer tree\x3c\/code\x3e和\x3ccode\x3ecomposite layers\x3c\/code\x3e，我们必须了解页面的渲染原理和过程。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e2-1 页面生成的过程\x3c\/h3\x3e\n\x3cp\x3e我们都知道网页生成过程，大致可以分成五步\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3eHTML代码转化为DOM\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eCSS代码转化成CSSOM（CSS Object Model）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e结合DOM和CSSOM，生成一棵渲染树（包含每个节点的视觉信息）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e生成布局（layout），即将所有渲染树的所有节点进行平面合成\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e将布局绘制（paint）在屏幕上\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e那么，浏览器是如何进行渲染的？\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e2-2 理解图层\x3c\/h3\x3e\n\x3cp\x3e浏览器在渲染一个页面时，会将页面分为很多个图层，图层有大有小，每个图层上有一个或多个节点。浏览器实际所做的工作有：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e获取DOM后分隔为多个图层\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e对每个图层的节点计算样式结果（recalculate style）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e为每个节点生成图形和位置（layout即reflow和重布局）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e将每个节点绘制填充到图层位图汇总（paint，repaint）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e图层作为纹理加载到GPU\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e合并多个图层到页面上，生成最终图像（composite layers）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e渲染的过程通常是相当耗时，低效的代码往往就是触发过程的layout，paint，composite layers，导致页面卡顿。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e3. 低效的代码\x3c\/h2\x3e\n\x3cp\x3e明白了整个渲染的过程和timeline的操作的含义，那么可以思考这样的一个问题：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e什么样的代码会触发这么耗时的操作，导致我们的页面卡顿？\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e3-1. 重排和重绘\x3c\/h3\x3e\n\x3cp\x3e网页生成的时候，至少会渲染一次。而我们需要关注的是用户访问过程中，那些会导致网页重新渲染的行为：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e修改DOM\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e修改样式表\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e用户事件（例如鼠标悬停，页面滚动，输入框输入文字等）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e重新渲染，就涉及\x3ccode\x3e重排\x3c\/code\x3e和\x3ccode\x3e重绘\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e重排（reflow）\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e即重新生成布局，重排必然导致重绘，如元素位置的改变，就会触发重排和重绘。\x3c\/p\x3e\n\x3cp\x3e会触发重排的的属性：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\n\x3cp\x3e盒子模型相关属性会触发重布局：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3ewidth\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eheight\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3epadding\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emargin\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3edisplay\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eborder-width\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eborder\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3emin-height\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e定位属性及浮动也会触发重布局：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3etop\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebottom\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eleft\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eright\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eposition\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3efloat\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eclear\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e改变节点内部文字结构也会触发重布局：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3etext-align\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoverflow-y\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3efont-weight\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoverflow\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3efont-family\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eline-height\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evertival-align\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ewhite-space\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3efont-size\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e\x3cstrong\x3e重绘（repaint）\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e即重新绘制，需要注意的是，\x3ccode\x3e重绘不一定需要重排\x3c\/code\x3e，比如改变某个元素的颜色，就只会触发重绘，而不会触发重排。\x3c\/p\x3e\n\x3cp\x3e会触发重绘的属性\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3ecolor\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eborder-style\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eborder-radius\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3evisibility\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etext-decoration\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebackground\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebackground-image\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebackground-position\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebackground-repeat\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebackground-size\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoutline-color\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoutline\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoutline-style\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoutline-width\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebox-shadow\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cem\x3e手机就算重绘也很慢\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e重排和重绘会不断触发，这是不可避免的，但是它们非常消耗资源，是导致网页性能低下的根本原因。\x3c\/p\x3e\n\x3cp\x3e提高网页性能，就是\x3ccode\x3e要降低重排和重绘的频率和成本，尽量少触发重新渲染\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e大部分浏览器通过\x3ccode\x3e队列化修改\x3c\/code\x3e和\x3ccode\x3e批量显示\x3c\/code\x3e优化重排版过程。然而有些操作会强迫刷新并要求所有计划改变的部分立刻应用。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3e3-2 创建图层\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e1. 创建图层有什么用？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e我们知道浏览器layout和paint是在每一个图层上进行的，当有一个元素经常变化，为了减少这个元素对页面的影响，我们可以为这个元素创建一个单独的图层，来提供页面的性能。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2. 在什么时候会创建图层？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e3D或透视变换（perspective transform）CSS属性（例如translateZ(0)\/translate3d(0,0,0)）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e使用加速视频解码的\x26amp;lt;video\x26amp;gt;节点\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e拥有3D（WebGL）上下文或加速的2D上下文的\x26amp;lt;canvas\x26amp;gt;节点\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e混合插件（如Flash）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e对自己的opacity做CSS动画或使用一个动画webkit变换的元素\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e拥有加速CSS过滤器的元素\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e元素有一个包含复合层的后代节点（一个元素拥有一个子元素，该子元素在自己的层里）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e元素有一个z-index较低且包含一个复合层的兄弟元素（换句话说就是该元素在复合层上面渲染）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cem\x3eposition为fixed也会创建图层，而absolute则不会\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e3. 创建图层的弊端\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e图层的创建也需要一定的开销，太多的图层会消耗过多的内存。这可能导致出现预期之外的行为，可能会导致潜在的崩溃。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e3-3 硬件加速\x3c\/h3\x3e\n\x3cp\x3e\x3cstrong\x3e1. 什么是硬件加速？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e现代浏览器大都可以利用GPU来加速页面渲染。在GPU的众多特性之中，它可以存储一定数量的纹理（一个矩形的像素点集合）并且高效地操作这些纹理（比如进行特定的移动、缩放和旋转操作）。这些特性在实现一个流畅的动画时特别有用。浏览器不会在动画的每一帧都绘制一次，而是生成DOM元素的快照，并作为GPU纹理（也被叫做层）存储起来。之后浏览器只需要告诉GPU去转换指定的纹理来实现DOM元素的动画效果。这就叫做GPU合成，也经常被称作\x3ccode\x3e硬件加速\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2. 怎么启用硬件加速？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3eCSS animations, transforms 以及 transitions 不会自动开启GPU加速，而是由浏览器的缓慢的软件渲染引擎来执行。那我们怎样才可以切换到GPU模式呢，很多浏览器提供了某些触发的CSS规则。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3etranslate3d(0,0,0)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3erotate3d(0,0,0,0)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3escale3d(0,0,0)\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3etranslateZ(0)【可能】\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e只需要在css中使用这类属性，即可开启硬件加速\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e3. 硬件加速真的那么好吗？\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e从本人在移动端开发的实践来看，硬件加速是比较坑的。开启硬件加速会占有手机过多的内存而导致手机卡顿（这个时候页面也肯定卡顿了），因此在我们团队中，是禁止掉硬件加速的。\x3c\/p\x3e\n\x3cp\x3e具体的原理可以参考\x3ca href=\x22http:\/\/efe.baidu.com\/blog\/hardware-accelerated-css-the-nice-vs-the-naughty\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e链接5\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader11\x22\x3e4. 总结\x3c\/h2\x3e\n\x3cp\x3e做完这个任务之后， 才觉得自己真正是在做开发。严谨细致的工匠精神，把控好自己的每一行代码。面对复杂的问题，一步步分析情况，查阅资料，不断地debug，感觉提高不少。希望自己继续加油，也与抽空看这篇文章的你共勉。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader12\x22\x3e5. 参考的文章\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/frontenddev.org\/link\/the-timeline-panel-of-the-chrome-developer-tools.html#heading-1-2\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/frontenddev.org\/link\/the-timeline-panel-of-the-chrome-developer-tools.html#heading-1-2\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000003991459\x22\x3ehttps:\/\/segmentfault.com\/a\/1190000003991459\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/gold.xitu.io\/entry\/5584c9a2e4b06b8a728fe53d\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/gold.xitu.io\/entry\/5584c9a2e4b06b8a728fe53d\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000000490328\x22\x3ehttps:\/\/segmentfault.com\/a\/1190000000490328\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/efe.baidu.com\/blog\/hardware-accelerated-css-the-nice-vs-the-naughty\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/efe.baidu.com\/blog\/hardware-accelerated-css-the-nice-vs-the-naughty\/\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>页面性能优化实践总结</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005965829">https://segmentfault.com/a/1190000005965829</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/thn07xv9qh/" target="_blank">https://alili.tech/archive/thn07xv9qh/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>