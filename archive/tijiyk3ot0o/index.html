<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="用第三方库带来的刚性成本"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>用第三方库带来的刚性成本 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/tijiyk3ot0o/",
				"appid": "1613049289050283", 
				"title": "用第三方库带来的刚性成本 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-14T02:30:37"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/pln1wv8utp/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ih3uz00lojq/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f&text=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f&text=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f&title=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f&is_video=false&description=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f&title=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f&title=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f&title=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2ftijiyk3ot0o%2f&title=%e7%94%a8%e7%ac%ac%e4%b8%89%e6%96%b9%e5%ba%93%e5%b8%a6%e6%9d%a5%e7%9a%84%e5%88%9a%e6%80%a7%e6%88%90%e6%9c%ac"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">用第三方库带来的刚性成本</h1><div class="meta"><div class="postdate"><time datetime="2019-02-14" itemprop="datePublished">2019-02-14</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e我之前一直在思考，在项目中引入第三方库会给我们带来什么，在\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000016801687\x22\x3e你为什么用或不用框架？\x3c\/a\x3e这篇文章中wo说了使用框架（库）带给我们的好处和不使用给我们的好处是什么，但是并未详细说明使用第三方库，它本身又会带来什么问题。\x3c\/p\x3e\n\x3cp\x3e通过查找资料，我在\x3ca href=\x22https:\/\/daverupert.com\/2018\/10\/hard-costs-of-third-party-scripts\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHard Costs of Third-Party Scripts\x3c\/a\x3e 这篇文章中找到了答案。第三方库带来的影响就是它降低了用户体验效果，增加了 \x3ccode\x3e用户成本\x3c\/code\x3e。这篇文章从7个方面说明了使用第三方库可能带来的问题，文中说的问题你大多数也都遇到过。\x3c\/p\x3e\n\x3cblockquote\x3e译文如下：\x3c\/blockquote\x3e\n\x3cp\x3e我对第三方库与用户体验成本之间的关系感兴趣。我做的每个客户端，平均大约使用30个第三方库。但开发者却因为 \x3ccode\x3e如果我们将 *async* 它们全部加载呢？\x3c\/code\x3e 减少了对它们的争论。虽然这是一个很好的反驳，但是仍然存在将它传递给用户的成本。这就是我要讲的主题。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e用户成本\x3c\/code\x3e 是什么？最常见答案可能是隐私。但就隐私被侵犯这事儿来说，从来没有明确界限。人们对个人数据暴露也有不同的容忍度。在讨论第三库的时，隐私就变得有点儿笨拙党的感觉。虽然讨论它们很有必要，但我希望将隐私与第三份库分开，并专注于应用程序带来的成本。\x3c\/p\x3e\n\x3cp\x3e为了更好地了解 \x3ccode\x3e用户成本\x3c\/code\x3e，我在Twitter上发了一个话题：\x3ca href=\x22https:\/\/twitter.com\/davatron5000\/status\/1041751023356928000?s=20\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e假设我们有一个包含约300个第三方库的站点，所有库都负责加载为异步，用户体验将面临什么？\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e1. aync代码在你自己编写的代码之前到达\x3c\/h3\x3e\n\x3cp\x3e如果异步代码在你自己编写的代码完成下载之前到达，将阻止HTML，CSS和JS解析。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e2. DNS查询成本\x3c\/h3\x3e\n\x3cp\x3e今年早些时候，我看到 \x3ca href=\x22https:\/\/webhint.io\/scanner\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewebhint\x3c\/a\x3e 的 \x3ca href=\x22https:\/\/twitter.com\/molant\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAntónMolleda\x3c\/a\x3e 做的 \x3ca href=\x22https:\/\/twitter.com\/molant\/status\/996428453829210112?s=20\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e一些数字统计\x3c\/a\x3e ，它表明即使3次DNS查询，也会在3G渲染预算上降低~5s\/170kb，额外需要10kb。有一些\x3ca href=\x22https:\/\/discuss.httparchive.org\/t\/analyzing-3rd-party-performance-via-http-archive-crux\/1359\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHTTP存档数据表明更多的第三方库会增加加载时间\x3c\/a\x3e，这似乎证实了这个数字。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e3. CPU占用\x3c\/h3\x3e\n\x3cp\x3e第三方库可能会阻止你自己编写的代码的性能。它占用了大量的可用的CPU周期，你自己编写的代码处于明显的 \x3ccode\x3e下风\x3c\/code\x3e。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e4. 网络占用\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/twitter.com\/paul_irish\/status\/1041867697250631680?s=20\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePaul Irish\x3c\/a\x3e提到了类似于CPU占用的网络占用，他说：“你的更重要的自己编写的代码的网络请求会占用较少的带宽。” 虽然你的浏览器有~5个连接线程可用于网络请求，但你自己编写的代码的任何部分或单个页面需要另一个文件或者懒加载的图像，它可能需要排队等一段时间。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e5. 用户数据和电池成本\x3c\/h3\x3e\n\x3cp\x3e手机的数据需要成本，HTTP请求也会消耗手机电池的电量。我认为无论是用户有意识地，还是由市场的无形大手的引导，最终将追求非数据消费和电池电量消耗的替代方案（例如，使用FB Messenger的微信）\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e6. 重载事件\x3c\/h3\x3e\n\x3cp\x3e它和CPU占用类似，但大多使用scroll，resize，或click的库可能会降低\x3ca href=\x22https:\/\/daverupert.com\/2015\/06\/doherty-threshold\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e页面在浏览器中的自适应性\x3c\/a\x3e，在极端情况下可能会导致布局的崩溃。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e7. 调试覆盖范围增加\x3c\/h3\x3e\n\x3cp\x3e虽然这会增加组织代码的成本，但它可能会变成影响用户体验的成本。更多库会增加调试的覆盖范围。如果出现问题，你是喜欢检查5个地方的问题还是300个？我最近遇到了由第三方库的问题而导致的错误，找出导致问题的库，花费了我一整天的时间，但我仍然不知道该如何将该库引入构建，而不产生错误。\x3c\/p\x3e\n\x3cp\x3e虽然300个第三方库，这听起来有点夸张，但是有约50或者约150个第三方请求呢？我现在有几个应用就是这个样子。\x3ca href=\x22https:\/\/trentwalton.com\/notes\/2018\/01\/23\/third-party-script-prevalence-on-alexa-top-50.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAlexa Top 50\x3c\/a\x3e的统计结果是平均约为18个第三方库。我坚信即使有了第三方提供的解决方案，你也可能会遇到部分或全部上述的问题。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e总结\x3c\/h3\x3e\n\x3cp\x3e我想这里我们可以得到这样一个结论，那就是单页应用程序和它每个路由的JS构建包可能最有可能被网络和CPU争用所扼杀。你的初始有效负载可能会获得100％的CPU，但后续页面可能会争夺其中的一小部分。但这取决于你的构建策略，如果构建策略是完美的，那么构建包会很好的加载并及时执行。不仅是SPA可能会遇到这样的问题，其它任何资源都可能延迟加载，并缓慢的执行。特别是网络不靠谱的情况下，所以这不应该让你感到非常惊讶的。\x3c\/p\x3e\n\x3cp\x3e如果你想到我遗漏的任何东西，请告诉我。我想我们都在这艘沉没的第三方船上，我们彼此都需要摆脱它。\x3c\/p\x3e\n\x3cp\x3e我在gihub[article 中开辟了一个\x3ccode\x3e想法\x3c\/code\x3e模块]，我会陆续添加一些相似的文章，希望得到大家的支持。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>用第三方库带来的刚性成本</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016830832">https://segmentfault.com/a/1190000016830832</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/tijiyk3ot0o/" target="_blank">https://alili.tech/archive/tijiyk3ot0o/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>