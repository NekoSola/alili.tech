<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="为什么是 JSONP"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>为什么是 JSONP | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/o0w4l8o5r5/",
				"appid": "1613049289050283", 
				"title": "为什么是 JSONP | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-11T02:30:49"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/b067o3b5fd/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/8h6yy84myj8/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f&text=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f&text=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f&is_video=false&description=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fo0w4l8o5r5%2f&title=%e4%b8%ba%e4%bb%80%e4%b9%88%e6%98%af%20JSONP"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">为什么是 JSONP</h1><div class="meta"><div class="postdate"><time datetime="2019-02-11" itemprop="datePublished">2019-02-11</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3eAJAX、JSON、JSONP\x3c\/h2\x3e\n\x3cp\x3e在 WEB 开发中，经常见到诸如 AJAX、JSON、JSONP 这些名词。三者看起来很像，很多同学尤其是没有系统了解过前端技术体系的同学，平常只是借助类似 JQuery 这类库封装好的函数使用而已，并不了解其原理。但这三种东西具体是什么，有什么关系和区别却常常说不清楚。\x3c\/p\x3e\n\x3cp\x3e接下来，会简要介绍一下三者的的含义，重点阐述 JSONP 的来源和原理，以及为什么 JSONP 不是 AJAX。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3eAJAX （Asynchronous JavaScript \x2b XML）\x3c\/h3\x3e\n\x3cblockquote\x3e\n\x3cp\x3eAjax isn’t a technology. It’s really several technologies, each flourishing in its own right, coming together in powerful new ways. Ajax incorporates:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3estandards-based presentation using XHTML and CSS;\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3edynamic display and interaction using the Document Object Model;\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3edata interchange and manipulation using XML and XSLT;\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3easynchronous data retrieval using XMLHttpRequest;\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eand JavaScript binding everything together.\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e异步 JavaScript \x2b XML，是在 2005 年由 \x3ca href=\x22http:\/\/adaptivepath.org\/ideas\/ajax-new-approach-web-applications\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJesse James Garrett 提出的一个术语\x3c\/a\x3e。 AJAX 并非特指某种技术, 描述的是一种结合使用大量已有技术的方式, 包括: HTML 或 XHTML, CSS, JavaScript, DOM, XML, XSLT, 还有最重要的 XMLHttpRequest 对象.\x3c\/p\x3e\n\x3cp\x3e尽管在 AJAX 中 X 代表 XML, 但现在更多的在使用 JSON，因为 JSON 具有很多优势，比如更轻量并且是 JavaScript 的一部分。在 AJAX 模型中 JSON 和 XML 都用于承载信息.\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3eJSON（Javascript Object Notation）\x3c\/h3\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.json.org\/json-zh.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eJSON\x3c\/a\x3e 是一种轻量级的数据交换格式。由道格拉斯·克罗克福特（Douglas Crockford）在 2012 年发明，并逐渐取代 XML 成为事实上的数据交换格式标准。\x3c\/p\x3e\n\x3cp\x3eJSON 基于 JavaScript Programming Language, Standard ECMA-262 3rd Edition - December 1999的一个子集。但采用完全独立于语言的文本格式，并使用了类似于 C 语言家族的习惯。\x3c\/p\x3e\n\x3cp\x3e在 JSON 中，一共 6 种数据类型：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3enumber：跟 Javascript 的数值一致，除去未曾使用的八进制与十六进制格式，和一些编码细节\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eboolean：\x3ccode\x3etrue\x3c\/code\x3e 和 \x3ccode\x3efalse\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3estring：是由双引号包围的任意数量Unicode字符的集合，使用反斜线转义\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3enull：\x3ccode\x3enull\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3earray：数组是值（value）的有序集合。一个数组以“[”（左中括号）开始，“]”（右中括号）结束，值之间使用“,”（逗号）分隔\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eobject：对象是一个无序的“‘名称\/值’对”集合。一个对象以“{”（左括号）开始，“}”（右括号）结束，每个“名称”后跟一个“:”（冒号）；“‘名称\/值’ 对”之间使用“,”（逗号）分隔\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e以及上面的任意组合。\x3c\/p\x3e\n\x3cp\x3e在 JavaScript 中有一个全局对象 JSON，包含两个方法 \x3ccode\x3eJSON.stringify()\x3c\/code\x3e 和 \x3ccode\x3eJSON.parse()\x3c\/code\x3e，用于序列化和解析 JSON。\x3c\/p\x3e\n\x3cp\x3e当然也有人使用 \x3ccode\x3eeval(\x22(\x22 \x2b string \x2b \x22)\x22)\x3c\/code\x3e 代替 \x3ccode\x3eJSON.parse()\x3c\/code\x3e 来 解析JSON，相比而言这种方式的容错性更高。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3eJSONP（JSON with Padding）\x3c\/h3\x3e\n\x3cp\x3e因为 \x3ccode\x3eXMLHttpRequest\x3c\/code\x3e 有同源策略，而在实际开发中又常常会有跨域的需求，早期开发者为了解决跨域问题而搞出来这样一个颇为奇怪的东西。产生原因和名字一样古怪，光听名字恐怕没几个人知道说的是个什么东西。\x3c\/p\x3e\n\x3cp\x3e刚好 \x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e 标签可以引用其他域下的静态资源，想想我们有时候在站点引入的数据统计类的 JS。\x3c\/p\x3e\n\x3cp\x3e但我们要的是数据，而不是一段静态的 JS 代码，怎么办？\x3c\/p\x3e\n\x3cp\x3e这还不简单吗，让服务器动态生成 js ，再把数据放进去不就可以吗。为了区分每一份数据，还需要针对返回的数据做一个标识，其实就是在数据外面包裹一个函数名。\x3c\/p\x3e\n\x3cp\x3e然后需要浏览器端预先设置好这样一个函数，返回的数据就相当于一次执行过程，对获取数据的处理。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e总结\x3c\/h3\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3eAJAX 是一类技术的集合，其中最重要的是 \x3ccode\x3eXMLHttpRequest\x3c\/code\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eJSON 是一个数据交换格式，也是目前事实上的标准\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eJSONP 是为解决跨域问题搞出来的一种获取数据的方式\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e举个栗子\x3c\/h2\x3e\n\x3cp\x3e接下来，用这个简单的示例来说明如何通过 JSONP 的方式获取数据，以及它到底是怎样工作的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e服务器\x3c\/h3\x3e\n\x3cp\x3e这里使用 Node.js 返回一段简单的数据。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * 一个简单的 http 服务器,返回 json 数据\n * 跟 Node 主页上的那个经典例子没太大差别\n *\/\n\nvar http = require(\x27http\x27);\nvar urllib = require(\x27url\x27);\n\nvar host = \x27127.0.0.1\x27;\nvar port = 9999;\n\nvar data = {\x27name\x27: \x27Mirreal\x27, \x27age\x27: \x2724\x27};\n\nhttp.createServer(function(req, res) {\n  var params = urllib.parse(req.url, true);\n\n  if (params.query \x26amp;\x26amp; params.query.callback) {\n\n    var str =  params.query.callback \x2b \x27(\x27 \x2b JSON.stringify(data) \x2b \x27)\x27; \/\/ jsonp\n    res.writeHead(200, { \x27Content-Type\x27: \x27application\/javascript\x27 });\n    res.end(str);\n  } else {\n    res.end(JSON.stringify(data)); \/\/ 普通的json\n  }\n\n}).listen(port, host, function() {\n  console.log(\x27server is listening on port \x27 \x2b port);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * 一个简单的 http 服务器,返回 json 数据\n * 跟 Node 主页上的那个经典例子没太大差别\n *\/\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e http = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e urllib = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27url\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e host = \x3cspan class=\x22hljs-string\x22\x3e\x27127.0.0.1\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e port = \x3cspan class=\x22hljs-number\x22\x3e9999\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e data = {\x3cspan class=\x22hljs-string\x22\x3e\x27name\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Mirreal\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27age\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x2724\x27\x3c\/span\x3e};\n\nhttp.createServer(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e params = urllib.parse(req.url, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (params.query \x26amp;\x26amp; params.query.callback) {\n\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e str =  params.query.callback \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27(\x27\x3c\/span\x3e \x2b \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(data) \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27)\x27\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ jsonp\x3c\/span\x3e\n    res.writeHead(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e, { \x3cspan class=\x22hljs-string\x22\x3e\x27Content-Type\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27application\/javascript\x27\x3c\/span\x3e });\n    res.end(str);\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    res.end(\x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(data)); \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 普通的json\x3c\/span\x3e\n  }\n\n}).listen(port, host, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27server is listening on port \x27\x3c\/span\x3e \x2b port);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e浏览器\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ zepto 的写法\n$.ajax({\n  type: \x27GET\x27,\n  url: \x27http:\/\/127.0.0.1:9999\x27,\n  data: { _input_charset: \x27utf-8\x27 },\n  dataType: \x27jsonp\x27,\n  timeout: 300,\n  context: $(\x27body\x27),\n  success: function(data){\n    console.log(data)\n  },\n  error: function(xhr, type) {\n    console.log(\x27Ajax error!\x27)\n  }\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ zepto 的写法\x3c\/span\x3e\n$.ajax({\n  \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/127.0.0.1:9999\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: { \x3cspan class=\x22hljs-attr\x22\x3e_input_charset\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27utf-8\x27\x3c\/span\x3e },\n  \x3cspan class=\x22hljs-attr\x22\x3edataType\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27jsonp\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3etimeout\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e300\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-attr\x22\x3econtext\x3c\/span\x3e: $(\x3cspan class=\x22hljs-string\x22\x3e\x27body\x27\x3c\/span\x3e),\n  \x3cspan class=\x22hljs-attr\x22\x3esuccess\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data)\n  },\n  \x3cspan class=\x22hljs-attr\x22\x3eerror\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3exhr, type\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Ajax error!\x27\x3c\/span\x3e)\n  }\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样就很轻松的通过 JSONP 的方式获取到数据，我们似乎也不需要关心里面究竟是怎么一回事。但有时候肯能会有人问起：“为什么 jsonp 不能使用 POST 方法”的问题，其实稍微了解一下 JSONP 的原理，这种问题完全就不存在了。\x3c\/p\x3e\n\x3cp\x3e虽然像 JQuery 这类库将 JSONP 封装到 \x3ccode\x3e$.Ajax()\x3c\/code\x3e 上，但准确来讲是不对的。因为 JSONP 只是通过动态地通过 \x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e 标签去请求一段 JS 代码（或者叫数据），而非使用 \x3ccode\x3eXMLHttpRequest\x3c\/code\x3e ，原理就像下面这样：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e对 JSONP 的简单封装\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/**\n * 对 JSONP 的一种简单封装\n *\n * @param {Object} options\n * @returns null\n *\/\nfunction getJsonp(options) {\n\n  var callbackName = options.callbackName;\n  var url = options.url;\n\n\n  var scriptElem = document.createElement(\x27script\x27);\n  scriptElem.setAttribute(\x27src\x27, url \x2b \x27?callback=\x27 \x2b callbackName);\n\n  scriptElem.onload = function(e) {\n    delete window[callbackName];\n    this.parentNode.removeChild(this);\n  };\n\n  scriptElem.onerror = function(e) {\n    console.log(e, \x27load error\x27);\n\n    delete window[callbackName];\n    this.parentNode.removeChild(this);\n  };\n\n  window[callbackName] = options.success;\n\n  \/\/ 调用\n  document.querySelector(\x27head\x27).appendChild(scriptElem);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/**\n * 对 JSONP 的一种简单封装\n *\n * @param {Object} options\n * @returns null\n *\/\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetJsonp\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eoptions\x3c\/span\x3e) \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e callbackName = options.callbackName;\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = options.url;\n\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e scriptElem = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e);\n  scriptElem.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e, url \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27?callback=\x27\x3c\/span\x3e \x2b callbackName);\n\n  scriptElem.onload = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e[callbackName];\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.parentNode.removeChild(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n  };\n\n  scriptElem.onerror = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e, \x3cspan class=\x22hljs-string\x22\x3e\x27load error\x27\x3c\/span\x3e);\n\n    \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e[callbackName];\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.parentNode.removeChild(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e);\n  };\n\n  \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e[callbackName] = options.success;\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 调用\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27head\x27\x3c\/span\x3e).appendChild(scriptElem);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这段代码对 JSONP 进行一层简单包装，调用也很简单：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22getJsonp({\n  \x27url\x27: \x27http:\/\/127.0.0.1:9999\/\x27,\n  \x27callbackName\x27: \x27log\x27,\n  \x27success\x27: function(data) {\n     console.log(\x27我是回调函数,我拿到数据了\x27, data);\n  }\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3egetJsonp({\n  \x3cspan class=\x22hljs-string\x22\x3e\x27url\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/127.0.0.1:9999\/\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27callbackName\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27log\x27\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x27success\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n     \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27我是回调函数,我拿到数据了\x27\x3c\/span\x3e, data);\n  }\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e看上去代码还挺长的，实际上核心代码不多，分三步：\x3c\/p\x3e\n\x3ch4\x3e1.创建一个 \x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e 标签，并设置其 url\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var scriptElem = document.createElement(\x27script\x27);\nscriptElem.setAttribute(\x27src\x27, url \x2b \x27?callback=\x27 \x2b callbackName);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e scriptElem = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e);\nscriptElem.setAttribute(\x3cspan class=\x22hljs-string\x22\x3e\x27src\x27\x3c\/span\x3e, url \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27?callback=\x27\x3c\/span\x3e \x2b callbackName);\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e2.设置回调函数\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window[callbackName] = options.success;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e[callbackName] = options.success;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里简单处理，直接把传入的回调函数设置成全局的\x3c\/p\x3e\n\x3ch4\x3e3.调用\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22document.querySelector(\x27head\x27).appendChild(scriptElem);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27head\x27\x3c\/span\x3e).appendChild(scriptElem);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e实际上就是把 \x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e 加到 html 文档中，这样就会去加载标签的内容，也就是一个 JS 文件。\x3c\/p\x3e\n\x3cp\x3e但通常现实中跑的代码内容会更多，包含一些错误控制、参数拼接、超时处理、性能安全等方面的，但它仍然清楚地描述 JSONP 的原理。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e安全\x3c\/h2\x3e\n\x3cp\x3e早期的浏览器处于安全层面的考量，制定同源策略，限制了一个源（origin）中加载文本或脚本与来自其它源（origin）中资源的交互方式。\x3c\/p\x3e\n\x3cp\x3e但是随着互联网的发展催生了跨域访问进行数据交互的需求，于是 JSONP 就产生了，以及后来的 CORS 机制，允许 XMLHttpRequest 对象发起跨域的请求。\x3c\/p\x3e\n\x3cp\x3e但是另一方面，也增加了安全风险，我们在使用的时候应当更加谨慎小心，防止 XSS、CSRF 等攻击。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e其他\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e数据预览\x3c\/h3\x3e\n\x3cp\x3e之前碰到一个问题，在调用一些接口返回的数据无法使用 Chrome 预览，自己写测试接口的时候也碰到过。后来发现，只是因为没有在 response 头部加上 \x3ccode\x3eContent-Type: application\/javascript\x3c\/code\x3e，仅此而已。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>为什么是 JSONP</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000004953537">https://segmentfault.com/a/1190000004953537</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/o0w4l8o5r5/" target="_blank">https://alili.tech/archive/o0w4l8o5r5/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>