<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="跨域几种方式"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>跨域几种方式 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/k02gj6evynn/",
				"appid": "1613049289050283", 
				"title": "跨域几种方式 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-13T02:31:23"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/0r5e3i5ynfhi/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/gknqo3vc5n/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f&text=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f&text=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f&title=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f&is_video=false&description=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f&title=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f&title=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f&title=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk02gj6evynn%2f&title=%e8%b7%a8%e5%9f%9f%e5%87%a0%e7%a7%8d%e6%96%b9%e5%bc%8f"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">跨域几种方式</h1><div class="meta"><div class="postdate"><time datetime="2019-02-13" itemprop="datePublished">2019-02-13</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e一、什么是跨域\x3c\/h2\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016756435?w=872\x26amp;h=208\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016756435?w=872\x26amp;h=208\x22 alt=\x22url的组成\x22 title=\x22url的组成\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3eJavaScript出于安全方面的考虑，不允许跨域调用其他页面的对象。那什么是跨域呢，简单地理解就是因为JavaScript同源策略的限制，a.com域名下的js无法操作b.com或是c.a.com域名下的对象。\x3cbr\x3e\x3cstrong\x3e当协议、子域名、主域名、端口号中任意一个不相同时，都算作不同域\x3c\/strong\x3e。不同域之间相互请求资源，就算作“跨域”。\x3cbr\x3e例如：\x3ca href=\x22http:\/\/www.abc.com\/index.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.abc.com\/index.html\x3c\/a\x3e 请求 \x3ca href=\x22http:\/\/www.efg.com\/service.php\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.efg.com\/service.php\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e有一点必须要注意：\x3cstrong\x3e跨域并不是请求发不出去，请求能发出去，服务端能收到请求并正常返回结果，只是结果被浏览器拦截了\x3c\/strong\x3e。之所以会跨域，是因为受到了同源策略的限制，同源策略要求源相同才能正常进行通信，即协议、域名、端口号都完全一致。\x3c\/p\x3e\n\x3cp\x3e大家可以参照下图，有助于深入理解跨域。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016756436\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016756436\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e特别说明两点：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第一：如果是协议和端口造成的跨域问题“前台”是无能为力的。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e第二：在跨域问题上，域仅仅是通过“URL的首部”来识别而不会根据域名对应的IP地址是否相同来判断。“URL的首部”可以理解为“协议, 域名和端口必须匹配”\x3c\/strong\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e二、什么是同源策略及其限制\x3c\/h2\x3e\n\x3cp\x3e同源策略限制从一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这是一个用于隔离潜在恶意文件的关键的安全机制。\x3cstrong\x3e它的存在可以保护用户隐私信息，防止身份伪造等(读取Cookie)。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e同源策略限制内容有：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eCookie、LocalStorage、IndexedDB 等存储性内容\x3c\/li\x3e\n\x3cli\x3eDOM 节点\x3c\/li\x3e\n\x3cli\x3eAJAX 请求不能发送\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e但是有三个标签是允许跨域加载资源：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x221.\x3cimg src=XXX\x3e\n2.\x3clink href=XXX\x3e\n3.\x3cscript src=XXX\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e1.\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eimg\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3eXXX\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n2.\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3elink\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ehref\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3eXXX\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n3.\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3eXXX\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3c\/pre\x3e\n\x3cp\x3e接下来我们讨论下有哪些处理跨域的方法。但所有的跨域都必须经过信息提供方的允许。如果未经允许即可获取，那是浏览器同源策略出现漏洞。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e三、处理跨域方法一——JSONP\x3c\/h2\x3e\n\x3ch4\x3e1.JSONP原理\x3c\/h4\x3e\n\x3cp\x3e\x3cstrong\x3e利用 \x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e 元素的这个开放策略，网页可以得到从其他来源动态产生的 JSON 数据。JSONP请求一定需要对方的服务器做支持才可以。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch4\x3e2.JSONP和AJAX对比\x3c\/h4\x3e\n\x3cp\x3eJSONP和AJAX相同，都是客户端向服务器端发送请求，从服务器端获取数据的方式。但AJAX属于同源策略，JSONP属于非同源策略（跨域请求）\x3c\/p\x3e\n\x3ch4\x3e3.JSONP优缺点\x3c\/h4\x3e\n\x3cp\x3eJSONP优点是兼容性好，可用于解决主流浏览器的跨域数据访问的问题。\x3cstrong\x3e缺点是仅支持get方法具有局限性。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch4\x3e4.JSONP的流程(以第三方API地址为例，不必考虑后台程序)\x3c\/h4\x3e\n\x3cul\x3e\n\x3cli\x3e声明一个回调函数，其函数名(如fn)当做参数值，要传递给跨域请求数据的服务器，函数形参为要获取目标数据(服务器返回的data)。\x3c\/li\x3e\n\x3cli\x3e\n\x3cp\x3e创建一个\x3ccode\x3e\x26lt;script\x26gt;\x3c\/code\x3e标签，把那个跨域的API数据接口地址，赋值给script的src,还要在这个地址中向服务器传递该函数名（可以通过问号传参:?callback=fn）。\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e服务器接收到请求后，需要进行特殊的处理：把传递进来的函数名和它需要给你的数据拼接成一个字符串,例如：传递进去的函数名是fn，它准备好的数据是fn([{\x22name\x22:\x22jianshu\x22}]）。\x3c\/li\x3e\x3c\/ul\x3e\n\x3c\/li\x3e\n\x3cli\x3e最后服务器把准备的数据通过HTTP协议返回给客户端，客户端再调用执行之前声明的回调函数（fn），对返回的数据进行操作。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    function fn(data) {\n        alert(data.msg);\n    }\n\x3c\/script\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot; src=\x26quot;http:\/\/crossdomain.com\/jsonServerResponse?jsonp=fn\x26quot;\x3e\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3efn\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(data)\x3c\/span\x3e \x3c\/span\x3e{\n        alert(data.msg);\n    }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/crossdomain.com\/jsonServerResponse?jsonp=fn\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e其中 fn 是客户端注册的回调的函数,目的获取跨域服务器上的json数据后，对数据进行在处理。\x3cbr\x3e 最后服务器返回给客户端数据的格式为:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22fn({ msg:\x27this  is  json  data\x27})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs css\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-selector-tag\x22\x3efn\x3c\/span\x3e({ \x3cspan class=\x22hljs-attribute\x22\x3emsg\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27this  is  json  data\x27\x3c\/span\x3e})\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e5.jQuery的jsonp形式\x3c\/h4\x3e\n\x3cp\x3e\x3cstrong\x3eJSONP都是GET和异步请求的，不存在其他的请求方式和同步请求，且jQuery默认就会给JSONP的请求清除缓存。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$.ajax({\nurl:\x26quot;http:\/\/crossdomain.com\/jsonServerResponse\x26quot;,\ndataType:\x26quot;jsonp\x26quot;,\ntype:\x26quot;get\x26quot;,\/\/可以省略\njsonpCallback:\x26quot;fn\x26quot;,\/\/-\x3e自定义传递给服务器的函数名，而不是使用jQuery自动生成的，可省略\njsonp:\x26quot;jsonp\x26quot;,\/\/-\x3e把传递函数名的那个形参callback变为jsonp，可省略\nsuccess:function (data){\nconsole.log(data);}\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode\x3e$.ajax({\n\x3cspan class=\x22hljs-symbol\x22\x3eurl:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/crossdomain.com\/jsonServerResponse\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3edataType:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22jsonp\x22\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3etype:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22get\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/可以省略\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ejsonpCallback:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22fn\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/-\x26gt;自定义传递给服务器的函数名，而不是使用jQuery自动生成的，可省略\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3ejsonp:\x3c\/span\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22jsonp\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-comment\x22\x3e\/\/-\x26gt;把传递函数名的那个形参callback变为jsonp，可省略\x3c\/span\x3e\n\x3cspan class=\x22hljs-symbol\x22\x3esuccess:\x3c\/span\x3efunction (data){\nconsole.log(data);}\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e四、处理跨域方法二——CORS\x3c\/h2\x3e\n\x3ch4\x3e1.CORS原理\x3c\/h4\x3e\n\x3cp\x3e整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。\x3cstrong\x3e因此，实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨源通信\x3c\/strong\x3e。\x3c\/p\x3e\n\x3ch4\x3e2.CORS优缺点\x3c\/h4\x3e\n\x3cp\x3e\x3cstrong\x3eCORS要求浏览器(\x26gt;IE10)和服务器的同时支持，是跨域的根本解决方法，由浏览器自动完成\x3c\/strong\x3e。\x3cbr\x3e优点在于功能更加强大支持各种HTTP Method，缺点是兼容性不如JSONP。\x3cbr\x3e只需要在服务器端做一些小小的改造即可：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22header(\x26quot;Access-Control-Allow-Origin:*\x26quot;);\nheader(\x26quot;Access-Control-Allow-Methods:POST,GET\x26quot;);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs abnf\x22\x3e\x3ccode\x3eheader(\x3cspan class=\x22hljs-string\x22\x3e\x22Access-Control-Allow-Origin:*\x22\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\nheader(\x3cspan class=\x22hljs-string\x22\x3e\x22Access-Control-Allow-Methods:POST,GET\x22\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e例如：网站\x3ca href=\x22http:\/\/localhost\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost\x3c\/a\x3e:63342\/ 页面要请求\x3ca href=\x22http:\/\/localhost\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost\x3c\/a\x3e:3000\/users\/userlist  页面，userlist页面返回json字符串格{name: \x27Mr.Cao\x27, gender: \x27male\x27, career: \x27IT Education\x27}\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/在服务器端设置同源策略地址\nrouter.get(\x26quot;\/userlist\x26quot;, function (req, res, next) {   \n    var user = {name: \x27Mr.Cao\x27, gender: \x27male\x27, career: \x27IT Education\x27};  \n    res.writeHeader(200,{\x26quot;Access-Control-Allow-Origin\x26quot;:\x27http:\/\/localhost:63342\x27});  \n    res.write(JSON.stringify(user));  \n    res.end();  \n}); \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/在服务器端设置同源策略地址\x3c\/span\x3e\nrouter.get(\x3cspan class=\x22hljs-string\x22\x3e\x22\/userlist\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ereq, res, next\x3c\/span\x3e) \x3c\/span\x3e{   \n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e user = {\x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27Mr.Cao\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3egender\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27male\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-attr\x22\x3ecareer\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27IT Education\x27\x3c\/span\x3e};  \n    res.writeHeader(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e,{\x3cspan class=\x22hljs-string\x22\x3e\x22Access-Control-Allow-Origin\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:63342\x27\x3c\/span\x3e});  \n    res.write(\x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(user));  \n    res.end();  \n}); \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在响应头上添加Access-Control-Allow-Origin属性，指定同源策略的地址。同源策略默认地址是网页的本身。\x3cstrong\x3e只要浏览器检测到响应头带上了CORS，并且允许的源包括了本网站，那么就不会拦截请求响应\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016756437\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016756437\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e五、处理跨域方法三——WebSocket\x3c\/h2\x3e\n\x3cp\x3e\x3cstrong\x3eWebsocket是HTML5的一个持久化的协议，它实现了浏览器与服务器的全双工通信，同时也是跨域的一种解决方案\x3c\/strong\x3e。WebSocket和HTTP都是应用层协议，都基于 TCP 协议。但是 WebSocket 是一种双向通信协议，在建立连接之后，WebSocket 的 server 与 client 都能主动向对方发送或接收数据。同时，WebSocket 在建立连接时需要借助 HTTP 协议，连接建立好了之后 client 与 server 之间的双向通信就与 HTTP 无关了。\x3c\/p\x3e\n\x3cp\x3e原生WebSocket API使用起来不太方便，我们使用Socket.io，它很好地封装了webSocket接口，提供了更简单、灵活的接口，也对不支持webSocket的浏览器提供了向下兼容。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/前端代码：\n\x3cdiv\x3euser input：\x3cinput type=\x26quot;text\x26quot;\x3e\x3c\/div\x3e\n\x3cscript src=\x26quot;.\/socket.io.js\x26quot;\x3e\x3c\/script\x3e\n\x3cscript\x3e\nvar socket = io(\x27http:\/\/www.domain2.com:8080\x27);\n\/\/ 连接成功处理\nsocket.on(\x27connect\x27, function() {\n    \/\/ 监听服务端消息\n    socket.on(\x27message\x27, function(msg) {\n        console.log(\x27data from server: ---\x3e \x27 \x2b msg); \n    });\n\n \/\/ 监听服务端关闭\n    socket.on(\x27disconnect\x27, function() { \n        console.log(\x27Server socket has closed.\x27); \n    });\n});\ndocument.getElementsByTagName(\x27input\x27)[0].onblur = function() {\n    socket.send(this.value);\n};\n\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\/\/前端代码：\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3euser input：\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22.\/socket.io.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e socket = io(\x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/www.domain2.com:8080\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 连接成功处理\x3c\/span\x3e\nsocket.on(\x3cspan class=\x22hljs-string\x22\x3e\x27connect\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听服务端消息\x3c\/span\x3e\n    socket.on(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emsg\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27data from server: ---\x26gt; \x27\x3c\/span\x3e \x2b msg); \n    });\n\n \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听服务端关闭\x3c\/span\x3e\n    socket.on(\x3cspan class=\x22hljs-string\x22\x3e\x27disconnect\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Server socket has closed.\x27\x3c\/span\x3e); \n    });\n});\n\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByTagName(\x3cspan class=\x22hljs-string\x22\x3e\x27input\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].onblur = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    socket.send(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.value);\n};\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/Nodejs socket后台：\nvar http = require(\x27http\x27);\nvar socket = require(\x27socket.io\x27);\n\/\/ 启http服务\nvar server = http.createServer(function(req, res) {\n    res.writeHead(200, {\n        \x27Content-type\x27: \x27text\/html\x27\n    });\n    res.end();\n});\nserver.listen(\x278080\x27);\nconsole.log(\x27Server is running at port 8080...\x27);\n\/\/ 监听socket连接\nsocket.listen(server).on(\x27connection\x27, function(client) {\n    \/\/ 接收信息\n    client.on(\x27message\x27, function(msg) {\n        client.send(\x27hello：\x27 \x2b msg);\n        console.log(\x27data from client: ---\x3e \x27 \x2b msg);\n    });\n\n    \/\/ 断开处理\n    client.on(\x27disconnect\x27, function() {\n        console.log(\x27Client socket has closed.\x27); \n    });\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/Nodejs socket后台：\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e http = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27http\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e socket = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27socket.io\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 启http服务\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e server = http.createServer(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ereq, res\x3c\/span\x3e) \x3c\/span\x3e{\n    res.writeHead(\x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e, {\n        \x3cspan class=\x22hljs-string\x22\x3e\x27Content-type\x27\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27text\/html\x27\x3c\/span\x3e\n    });\n    res.end();\n});\nserver.listen(\x3cspan class=\x22hljs-string\x22\x3e\x278080\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Server is running at port 8080...\x27\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 监听socket连接\x3c\/span\x3e\nsocket.listen(server).on(\x3cspan class=\x22hljs-string\x22\x3e\x27connection\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eclient\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 接收信息\x3c\/span\x3e\n    client.on(\x3cspan class=\x22hljs-string\x22\x3e\x27message\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3emsg\x3c\/span\x3e) \x3c\/span\x3e{\n        client.send(\x3cspan class=\x22hljs-string\x22\x3e\x27hello：\x27\x3c\/span\x3e \x2b msg);\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27data from client: ---\x26gt; \x27\x3c\/span\x3e \x2b msg);\n    });\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 断开处理\x3c\/span\x3e\n    client.on(\x3cspan class=\x22hljs-string\x22\x3e\x27disconnect\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27Client socket has closed.\x27\x3c\/span\x3e); \n    });\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e六、处理跨域方法四——postMessage\x3c\/h2\x3e\n\x3cp\x3e如果两个网页不同源，就无法拿到对方的DOM。典型的例子是iframe窗口和window.open方法打开的窗口，它们与父窗口无法通信。HTML5为了解决这个问题，引入了一个全新的API：跨文档通信 API（Cross-document messaging）。这个API为window对象新增了一个window.postMessage方法，允许跨窗口通信，不论这两个窗口是否同源。\x3cstrong\x3epostMessage方法的第一个参数是具体的信息内容，第二个参数是接收消息的窗口的源（origin），即\x22协议 \x2b 域名 \x2b 端口\x22\x3c\/strong\x3e。也可以设为*，表示不限制域名，向所有窗口发送。\x3c\/p\x3e\n\x3cp\x3e接下来我们看个例子：\x3cbr\x3e\x3ccode\x3ehttp:\/\/localhost:63342\/index.html\x3c\/code\x3e页面向\x3ccode\x3ehttp:\/\/localhost:3000\/message.html\x3c\/code\x3e传递“跨域请求信息”\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/发送信息页面 http:\/\/localhost:63342\/index.html\n\x3chtml lang=\x26quot;en\x26quot;\x3e  \n\x3chead\x3e  \n    \x3cmeta charset=\x26quot;UTF-8\x26quot;\x3e  \n    \x3ctitle\x3e跨域请求\x3c\/title\x3e   \n\x3c\/head\x3e  \n\x3cbody\x3e  \n    \x3ciframe src=\x26quot;http:\/\/localhost:3000\/users\/reg\x26quot; id=\x26quot;frm\x26quot;\x3e\x3c\/iframe\x3e  \n    \x3cinput type=\x26quot;button\x26quot; value=\x26quot;OK\x26quot; onclick=\x26quot;run()\x26quot;\x3e  \n\x3c\/body\x3e  \n\x3c\/html\x3e  \n\x3cscript\x3e  \n   function  run(){  \n        var frm=document.getElementById(\x26quot;frm\x26quot;);  \n        frm.contentWindow.postMessage(\x26quot;跨域请求信息\x26quot;,\x26quot;http:\/\/localhost:3000\x26quot;);  \n   }  \n\x3c\/script\x3e  \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\/\/发送信息页面 http:\/\/localhost:63342\/index.html\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3elang\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22en\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22UTF-8\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e跨域请求\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e   \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/localhost:3000\/users\/reg\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22frm\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22button\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22OK\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonclick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22run()\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e  \n   \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e  \x3cspan class=\x22hljs-title\x22\x3erun\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{  \n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e frm=\x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x22frm\x22\x3c\/span\x3e);  \n        frm.contentWindow.postMessage(\x3cspan class=\x22hljs-string\x22\x3e\x22跨域请求信息\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/localhost:3000\x22\x3c\/span\x3e);  \n   }  \n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e  \x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/接收信息页面 http:\/\/localhost:3000\/message.html\n window.addEventListener(\x26quot;message\x26quot;,function(e){  \/\/通过监听message事件，可以监听对方发送的消息。\n  console.log(e.data);  \n},false);  \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/接收信息页面 http:\/\/localhost:3000\/message.html\x3c\/span\x3e\n \x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x22message\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ee\x3c\/span\x3e)\x3c\/span\x3e{  \x3cspan class=\x22hljs-comment\x22\x3e\/\/通过监听message事件，可以监听对方发送的消息。\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(e.data);  \n},\x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);  \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e七、参考文章\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/cors.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e跨域资源共享 CORS 详解\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/www.ruanyifeng.com\/blog\/2016\/04\/same-origin-policy.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e浏览器同源政策及其规避方法\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/blog.csdn.net\/lxcao\/article\/details\/52947291\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e你了解跨域请求吗?\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/juejin.im\/entry\/59b8fb276fb9a00a42474a6f\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e前端常见跨域解决方案（全）\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>跨域几种方式</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016756432">https://segmentfault.com/a/1190000016756432</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/k02gj6evynn/" target="_blank">https://alili.tech/archive/k02gj6evynn/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>