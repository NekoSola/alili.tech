<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="在 vue-test-utils 中 mock 全局对象"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>在 vue-test-utils 中 mock 全局对象 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/4ph000y4vox/",
				"appid": "1613049289050283", 
				"title": "在 vue-test-utils 中 mock 全局对象 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-15T02:30:44"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/nn5no7dmupi/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/6dzmclsnu5/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f&text=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f&text=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f&title=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f&is_video=false&description=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f&title=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f&title=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f&title=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f4ph000y4vox%2f&title=%e5%9c%a8%20vue-test-utils%20%e4%b8%ad%20mock%20%e5%85%a8%e5%b1%80%e5%af%b9%e8%b1%a1"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">在 vue-test-utils 中 mock 全局对象</h1><div class="meta"><div class="postdate"><time datetime="2019-02-15" itemprop="datePublished">2019-02-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3ccode\x3evue-test-utils\x3c\/code\x3e   提供了一种 mock 掉   \x3ccode\x3eVue.prototype\x3c\/code\x3e   的简单方式，不但对测试用例适用，也可以为所有测试设置默认的 mock。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader0\x22\x3e\n\x3ccode\x3emocks\x3c\/code\x3e   加载选项\x3c\/h1\x3e\n\x3cp\x3e\x3ccode\x3emocks\x3c\/code\x3e   加载选项   是一种将任何属性附加到  \x3ccode\x3e Vue.prototype\x3c\/code\x3e   上的方式。这通常包括：\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e$store\x3c\/code\x3e , for Vuex\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e$router\x3c\/code\x3e, for Vue Router\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3e$t\x3c\/code\x3e , for vue-i18n\x3c\/p\x3e\n\x3cp\x3e以及其他种种。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3evue-i18n \x3c\/code\x3e  \x3cstrong\x3e的例子\x3c\/strong\x3e\x3cbr\x3e我们来看一个 vue-i18n   的例子。虽然可以为每个测试用到  \x3ccode\x3e createLocalVue  \x3c\/code\x3e 并安装   \x3ccode\x3evue-i18n \x3c\/code\x3e，但那样可能会让事情难以处理并引入一堆样板。首先，组件 \x3ccode\x3e \x26lt;Bilingual\x26gt;  \x3c\/code\x3e 用到了   \x3ccode\x3evue-i18n\x3c\/code\x3e` :\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3ctemplate\x3e\n  \x3cdiv class=\x26quot;hello\x26quot;\x3e\n    \x22{{\x22 $t(\x26quot;helloWorld\x26quot;) \x22}}\x22\n  \x3c\/div\x3e\n\x3c\/template\x3e\n\n\x3cscript\x3e\n  export default {\n    name: \x26quot;Bilingual\x26quot;\n  }\n\x3c\/script\x3e`\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs django\x22\x3e\x3ccode\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22hello\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3c\/span\x3e\x3cspan class=\x22hljs-template-variable\x22\x3e\x22{{\x22 $t(\x22helloWorld\x22) \x22}}\x22\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etemplate\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n    \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22Bilingual\x22\x3c\/span\x3e\n  }\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e`\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e你先在另一个文件中弄好翻译，然后通过\x3ccode\x3e $t  \x3c\/code\x3e 引用，这就是  \x3ccode\x3e vue-i18n \x3c\/code\x3e 的工作方式。在本次测试中，虽然并不会真正关心翻译文件看起来什么样，不过还是看一看这次用到的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default {\n  \x26quot;en\x26quot;: {\n    helloWorld: \x26quot;Hello world!\x26quot;\n  },\n  \x26quot;ja\x26quot;: {\n    helloWorld: \x26quot;こんにちは、世界！\x26quot;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3eexport \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-string\x22\x3e\x22en\x22\x3c\/span\x3e: {\n    helloWorld: \x3cspan class=\x22hljs-string\x22\x3e\x22Hello world!\x22\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-string\x22\x3e\x22ja\x22\x3c\/span\x3e: {\n    helloWorld: \x3cspan class=\x22hljs-string\x22\x3e\x22こんにちは、世界！\x22\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e基于这个 locale，正确的翻译将被渲染出来。我们先不用 mock，尝试在测试中渲染该组件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { shallowMount } from \x26quot;@vue\/test-utils\x26quot;\nimport Bilingual from \x26quot;@\/components\/Bilingual.vue\x26quot;\n\ndescribe(\x26quot;Bilingual\x26quot;, () =\x3e {\n  it(\x26quot;renders successfully\x26quot;, () =\x3e {\n    const wrapper = shallowMount(Bilingual)\n  })\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { shallowMount } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22@vue\/test-utils\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Bilingual \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22@\/components\/Bilingual.vue\x22\x3c\/span\x3e\n\ndescribe(\x3cspan class=\x22hljs-string\x22\x3e\x22Bilingual\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  it(\x3cspan class=\x22hljs-string\x22\x3e\x22renders successfully\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    const wrapper = shallowMount(Bilingual)\n  })\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e通过 \x3ccode\x3eyarn test:unit\x3c\/code\x3e   运行测试将抛出一堆错误堆栈。若仔细端详输出则会发现：\x3c\/p\x3e\n\x3cp\x3e这是因为我们并未安装\x3ccode\x3e vue-i18n\x3c\/code\x3e ，所以全局的  \x3ccode\x3e $t\x3c\/code\x3e   方法并不存在。我们试试 \x3ccode\x3e mocks \x3c\/code\x3e  加载选项：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import { shallowMount } from \x26quot;@vue\/test-utils\x26quot;\nimport Bilingual from \x26quot;@\/components\/Bilingual.vue\x26quot;\n\ndescribe(\x26quot;Bilingual\x26quot;, () =\x3e {\n  it(\x26quot;renders successfully\x26quot;, () =\x3e {\n    const wrapper = shallowMount(Bilingual, {\n      mocks: {\n        $t: (msg) =\x3e msg\n      }\n    })\n  })\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { shallowMount } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22@vue\/test-utils\x22\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Bilingual \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22@\/components\/Bilingual.vue\x22\x3c\/span\x3e\n\ndescribe(\x3cspan class=\x22hljs-string\x22\x3e\x22Bilingual\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  it(\x3cspan class=\x22hljs-string\x22\x3e\x22renders successfully\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n    const wrapper = shallowMount(Bilingual, {\n      mocks: {\n        $t: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e(msg)\x3c\/span\x3e =\x26gt;\x3c\/span\x3e msg\n      }\n    })\n  })\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在测试通过了！\x3ccode\x3e mocks \x3c\/code\x3e  选项用处多多，而我觉得最最常用的正是开头提到过的那三样。\x3c\/p\x3e\n\x3cp\x3e（译注：通过这种方式就不能在单元测试中耦合与特定语言相关的内容了，因为翻译功能实际上已失效，也更无法处理可选参数等）\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e使用配置设置默认的 mocks\x3c\/h1\x3e\n\x3cp\x3e有时需要一个 mock 的默认值，这样就不用为每个测试用例都设置一遍了。可以用 \x3ccode\x3evue-test-utils \x3c\/code\x3e  提供的   config   API 来实现。还是 \x3ccode\x3e  vue-i18n\x3c\/code\x3e   的例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import VueTestUtils from \x26quot;@vue\/test-utils\x26quot;\n\nVueTestUtils.config.mocks[\x26quot;mock\x26quot;] = \x26quot;Default Mock Value\x26quot;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3eimport VueTestUtils from \x3cspan class=\x22hljs-string\x22\x3e\x22@vue\/test-utils\x22\x3c\/span\x3e\n\nVueTestUtils\x3cspan class=\x22hljs-selector-class\x22\x3e.config\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.mocks\x3c\/span\x3e[\x3cspan class=\x22hljs-string\x22\x3e\x22mock\x22\x3c\/span\x3e] = \x3cspan class=\x22hljs-string\x22\x3e\x22Default Mock Value\x22\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个示例中用到了 Jest，所以我将把默认 mock 描述在\x3ccode\x3e jest.init.js   \x3c\/code\x3e文件中 -- 该文件会在测试运行前被自动加载。同时我也会导入并应用此前用于示例的翻译对象。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/jest.init.js\n\nimport VueTestUtils from \x26quot;@vue\/test-utils\x26quot;\nimport translations from \x26quot;.\/src\/translations.js\x26quot;\n\nconst locale = \x26quot;en\x26quot;\n\nVueTestUtils.config.mocks[\x26quot;$t\x26quot;] = (msg) =\x3e translations[locale][msg]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs markdown\x22\x3e\x3ccode\x3e\/\/jest.init.js\n\nimport VueTestUtils from \x22@vue\/test-utils\x22\nimport translations from \x22.\/src\/translations.js\x22\n\nconst locale = \x22en\x22\n\nVueTestUtils.config.mocks[\x3cspan class=\x22hljs-string\x22\x3e\x22$t\x22\x3c\/span\x3e] = (msg) =\x26gt; translations[\x3cspan class=\x22hljs-string\x22\x3elocale\x3c\/span\x3e][\x3cspan class=\x22hljs-symbol\x22\x3emsg\x3c\/span\x3e]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在尽管还是用了一个 mock 过的\x3ccode\x3e $t\x3c\/code\x3e   函数，但会渲染一个真实的翻译了。再次运行测试，这次移除了  \x3ccode\x3e mocks \x3c\/code\x3e  加载选项并用  \x3ccode\x3e console.log   \x3c\/code\x3e打印了 \x3ccode\x3e  wrapper.html() \x3c\/code\x3e。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22describe(\x26quot;Bilingual\x26quot;, () =\x3e {\n  it(\x26quot;renders successfully\x26quot;, () =\x3e {\n    const wrapper = shallowMount(Bilingual)\n\n    console.log(wrapper.html())\n  })\n})\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lisp\x22\x3e\x3ccode\x3edescribe(\x3cspan class=\x22hljs-string\x22\x3e\x22Bilingual\x22\x3c\/span\x3e, () =\x26gt; {\n  it(\x3cspan class=\x22hljs-string\x22\x3e\x22renders successfully\x22\x3c\/span\x3e, () =\x26gt; {\n    const wrapper = shallowMount(\x3cspan class=\x22hljs-name\x22\x3eBilingual\x3c\/span\x3e)\n\n    console.log(\x3cspan class=\x22hljs-name\x22\x3ewrapper\x3c\/span\x3e.html())\n  })\n})\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e测试通过，以下结构被渲染出来：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv class=\x26quot;hello\x26quot;\x3e\n  Hello world!\n\x3c\/div\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x26lt;div \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22hello\x22\x3c\/span\x3e\x26gt;\n  Hello world!\n\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e（译注：依然无法应付复杂的翻译）\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e总结\x3c\/h1\x3e\n\x3cp\x3e本文论述了：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cstrong\x3e在测试用例中使用 \x3ccode\x3emocks \x3c\/code\x3e  以 mock 一个全局对象\x3c\/strong\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cstrong\x3e用 \x3ccode\x3econfig.mocks\x3c\/code\x3e   设置默认的 mock\x3c\/strong\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cem\x3e原文链接：\x3ca href=\x22https:\/\/www.qdfuns.com\/article.php?mod=view\x26amp;id=aaaddd492fb4c0f57287022a97293c7f\x26amp;uid=51352\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.qdfuns.com\/articl...\x3c\/a\x3e\x3c\/em\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>在 vue-test-utils 中 mock 全局对象</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016938533">https://segmentfault.com/a/1190000016938533</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/4ph000y4vox/" target="_blank">https://alili.tech/archive/4ph000y4vox/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>