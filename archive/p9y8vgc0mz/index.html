<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="React Native 实践之携程 Moles 框架"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>React Native 实践之携程 Moles 框架 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/p9y8vgc0mz/",
				"appid": "1613049289050283", 
				"title": "React Native 实践之携程 Moles 框架 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-08T02:30:41"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/cpdaicss7yt/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/g41h7crm6v5/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f&text=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f&text=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f&title=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f&is_video=false&description=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f&title=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f&title=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f&title=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fp9y8vgc0mz%2f&title=React%20Native%20%e5%ae%9e%e8%b7%b5%e4%b9%8b%e6%90%ba%e7%a8%8b%20Moles%20%e6%a1%86%e6%9e%b6"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">React Native 实践之携程 Moles 框架</h1><div class="meta"><div class="postdate"><time datetime="2019-02-08" itemprop="datePublished">2019-02-08</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cem\x3e编者：本文来自携程框架研发部高级经理魏晓军在第二期\x3cstrong\x3e【携程技术微分享】\x3c\/strong\x3e上的分享，以下为整理后的文字实录。视频回放可点击\x3ca href=\x22http:\/\/v.qq.com\/page\/w\/u\/g\/w0304ucmlug.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e。关注携程技术中心微信公号ctriptech，可获知更多微分享课程信息。\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e因为支持用javascript开发原生应用，React Native一推出就受到不少公司热捧，各家都跃跃欲试。但有一个痛点是，\x3cstrong\x3e在移动端，我们是否有必要开发多套程序：iOS、Android和H5？\x3c\/strong\x3e本次将通过对Moles框架的分享，介绍携程在React Native方面的实战干货，希望给大家一些灵感和启发。\x3c\/p\x3e\n\x3cp\x3e本次分享的内容包括三个方面：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3eMoles框架在React Native和我们主App的集成中起到了什么作用？\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eMoles框架是如何打通Android、iOS、H5、SEO，让我们一套代码跑在多个平台上？\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eMoles框架的组成以及原理是怎样的?\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e这些内容将通过以下几个部分的讲解来一一给大家进行解答：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eReact Native的现状\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eMoles 框架的出现\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eMoles 框架的组成\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eMoles 框架的功能\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eMoles 框架的原理简析\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eMoles 框架的使用\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eMoles 框架的案例\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e开源计划\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e\x3cstrong\x3e一、React Native的现状\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3eReact Native是2015年3月份Facebook开源的一个Native上的一个框架。那么为什么它现在会这么火呢。\x3c\/p\x3e\n\x3cp\x3e我们先来看看它有什么优点。\x3c\/p\x3e\n\x3cp\x3e首先，对于做前端的我来说，最吸引的就是可以用javascript来开发Native应用了。之前javascript只可以开发浏览器上的一些功能，随着Node.js的出现，又让javascript走向了服务端，现在React Native的出现又让javascript走向了Native端。如果要用现在一个时髦的词来形容javascript的话，我觉得“全栈”真的不为过。\x3c\/p\x3e\n\x3cp\x3e其次，React Native是Facebook将ReactJS的思想移植到Native端。所以React Native就拥有了RectJS的很多特性，如：组件化思想、Virtual Dom技术以及JSX与Flexbox组合完成的布局等等，同时React Native又引入了热更新机制、CssLayout机制，让开发人员尤其是Native开发人员眼前一亮。\x3c\/p\x3e\n\x3cp\x3e有优点也有缺点，我们再来看看它的不足。\x3c\/p\x3e\n\x3cp\x3e我们知道React Native先出了iOS版本，然后出了Android版本。两个版本之间存在很多的差异性，甚至有好多组件都会带有平台的后缀，这使得开发人员必须要为这两个平台写不同的代码。\x3c\/p\x3e\n\x3cp\x3e此外，对于公司来说，在移动上的投入，不仅有Native还会有H5，而在H5上React Native并没有考虑。从MVC框架的角度来看，React Native只做了View这一层，那么Controller、Model、Router还需要做。从App的完整性来看，只学会React Native并不能开发一个健全的App。它的更新策略、Hybrid API的提供，配套的UI组件、监控机制等等这些都没有。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e\x3cstrong\x3e二、Moles 框架的出现\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e伴随着React Native项目的开发，逐渐的Moles框架就形成了。\x3c\/p\x3e\n\x3cp\x3emole [məʊl] 小鼹鼠，是种凿洞能力非常强的啮齿类动物。把框架称为之为Moles，也是寄希望我们的框架能像mole一样，能够打洞，能够打通Android、iOS、H5、SEO这几个平台。当然一个mole的能力是有限的，所以我们取其复数形式Moles。\x3c\/p\x3e\n\x3cp\x3e如果说当前移动端的三大痛点是：性能、动态性、多端适配的话。那么我认为React Native解决了性能、动态性，而我们Moles则解决了多端适配的问题。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3eMoles的目标是要尽可能的做到在H5端开发的内容可以直接运行在Native上，在Native端开发的内容也可以直接运行在H5上。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e\x3cstrong\x3e三、Moles 框架的组成\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e该框架主要由三部分组成\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e1. moles-web\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e该部分主要是为H5服务，是将React Native在Android、iOS中没有差异化的Components、APIs提取出来，单独封装成一个Library供H5端来使用。这样做的好处是，这个Library只在H5上会是使用到，在Native是不需要的，以减少框架在Native的体积。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e2. moles-cui\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e该部分主要是是将React Native在Android、iOS中有差异化的Components、APIs提取出来，并且添加一些公司定制化的组件进去，包括：UI组件、监控组件、采集组件、路由组件等等。moles-cui可以说是Moles框架的核心部分，它不但Native开发需要使用，在H5上的开发也需要使用。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e3. moles-cli\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e该部分主要包括Moles项目的初始化、编译、打包等功能。\x3c\/p\x3e\n\x3cp\x3e下面是moles-web与moles-cui的一个关系图\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyoVL\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyoVL\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e\x3cstrong\x3e四、Moles 框架的功能\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3eMoles框架的功能可以用下图来说明\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyoVV\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyoVV\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e主要涵盖的对不同平台的适配、对底层API的调用以及对APP中性能和错误的监控等等。\x3c\/p\x3e\n\x3cp\x3e那么Moles在携程主App中所处的位置如何呢？\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyoV4\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyoV4\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e如上图所示它就是BU开发人员和React Native、Ctrip React Native 的一个桥梁。让开发人员更专注于自己的业务逻辑，而不必为React Native的更新问题、不同平台的兼容性问题等等而烦恼。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e\x3cstrong\x3e五、Moles 框架的原理简析\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e由于Moles涉及的内容众多，如：路由的设计、页面生命周期的设计、打包的设计等等。这里我们仅以组件的设计为例，来简析其实现原理。\x3c\/p\x3e\n\x3cp\x3e要做到Native和H5代码共享，通常想到的做法有两种：\x3c\/p\x3e\n\x3cp\x3e1、Native组件运行在H5上，如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class HelloWorld extends Component{\n  render(){\n   return(\n    \x3cView\x3e\n      \x3cText\x3eHelloWorld\x3c\/Text\x3e\n    \x3c\/View\x3e\n    )\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scala\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eHelloWorld\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e\x3c\/span\x3e{\n  render(){\n   \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e(\n    \x26lt;\x3cspan class=\x22hljs-type\x22\x3eView\x3c\/span\x3e\x26gt;\n      \x26lt;\x3cspan class=\x22hljs-type\x22\x3eText\x3c\/span\x3e\x26gt;\x3cspan class=\x22hljs-type\x22\x3eHelloWorld\x3c\/span\x3e\x26lt;\/\x3cspan class=\x22hljs-type\x22\x3eText\x3c\/span\x3e\x26gt;\n    \x26lt;\/\x3cspan class=\x22hljs-type\x22\x3eView\x3c\/span\x3e\x26gt;\n    )\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e2、H5组件运行在Native上，如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class HelloWorld extends Component{\n  render(){\n     return(\n    \x3cDiv\x3e\n      \x3cSpan\x3eHelloWorld\x3c\/Span\x3e\n    \x3c\/Div\x3e\n     )\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scala\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eHelloWorld\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e\x3c\/span\x3e{\n  render(){\n     \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e(\n    \x26lt;\x3cspan class=\x22hljs-type\x22\x3eDiv\x3c\/span\x3e\x26gt;\n      \x26lt;\x3cspan class=\x22hljs-type\x22\x3eSpan\x3c\/span\x3e\x26gt;\x3cspan class=\x22hljs-type\x22\x3eHelloWorld\x3c\/span\x3e\x26lt;\/\x3cspan class=\x22hljs-type\x22\x3eSpan\x3c\/span\x3e\x26gt;\n    \x26lt;\/\x3cspan class=\x22hljs-type\x22\x3eDiv\x3c\/span\x3e\x26gt;\n     )\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eMoles中组件的设计采用了做法1的思路，就是将Native上支持的View、Text、Navigator等组件运行在H5上。要实现Native组件运行在H5上，需要解决两个难点：1、组件化 2、组件的生命周期。\x3c\/p\x3e\n\x3cp\x3e我们刚开始的时候就讲到，React Native上的组件化思想是Facebook将ReactJS的思想用在Native上。这就为我们能在H5上实现Native的组件奠定了基础。所以我们完全可以借助ReactJS来开发这些组件，但是在实际的开发中，发现ReactJS的体量实在是太大了，所以我们最后采用了携程开源的react-lite框架。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e\x3cstrong\x3e六、Moles 框架的使用\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e为了减少大家的学习成本，Moles框架在设计方面尽量采用大家比较熟悉的语法和命令。要使用Moles，需要先安装moles-cli。\x3c\/p\x3e\n\x3cp\x3e下面是第一次使用moles-cli的简单流程：\x3c\/p\x3e\n\x3cp\x3e安装moles-cli\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ sudo cnpm install @ctrip\/moles-cli -g\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs elixir\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-variable\x22\x3e$ \x3c\/span\x3esudo cnpm install \x3cspan class=\x22hljs-variable\x22\x3e@ctrip\x3c\/span\x3e\/moles-cli -g\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e初始化Moles项目\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ moles init ProjectName\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs elixir\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-variable\x22\x3e$ \x3c\/span\x3emoles init ProjectName\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e安装项目依赖\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ cd ProjectName\n$ cnpm install\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs elixir\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-variable\x22\x3e$ \x3c\/span\x3ecd ProjectName\n\x3cspan class=\x22hljs-variable\x22\x3e$ \x3c\/span\x3ecnpm install\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3emoles-cli初始化后的目录结构和react-native-cli初始化出来的结构几乎一样，唯一不同的是多了一个web目录，该目录主要是为H5服务。\x3c\/p\x3e\n\x3cp\x3e下面来看下简单的代码使用情况\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import React,{\n  View\n} from \x27react-native\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React,{\n  View\n} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react-native\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的代码若在Native端会调用React Natie提供的react-native模块，在H5端会调用moles-web模块\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import{\n  Application,\n  Page\n}from \x27moles-cui\x27\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs clean\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e{\n  Application,\n  Page\n}\x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27moles-cui\x27\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的代码为moles-cui的使用，不论在Native端还是H5端，都需要通过引入\x27moles-cui\x27模块来使用。\x3c\/p\x3e\n\x3cp\x3e以运行iOS项目为例\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ moles run-ios\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dockerfile\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e$ moles \x3cspan class=\x22hljs-keyword\x22\x3erun\x3c\/span\x3e\x3cspan class=\x22bash\x22\x3e-ios\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e打包、拆包项目\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22$ moles packer \n    --input \/path\/to\/project \n    --entry index.ios.js \n    --output \/path\/to\/build \n    --bundle bu.bundle \n    --common true\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haml\x22\x3e\x3ccode\x3e$ moles packer \n    -\x3cspan class=\x22ruby\x22\x3e-input \/path\/to\/project \n\x3c\/span\x3e    -\x3cspan class=\x22ruby\x22\x3e-entry index.ios.js \n\x3c\/span\x3e    -\x3cspan class=\x22ruby\x22\x3e-output \/path\/to\/build \n\x3c\/span\x3e    -\x3cspan class=\x22ruby\x22\x3e-bundle bu.bundle \n\x3c\/span\x3e    -\x3cspan class=\x22ruby\x22\x3e-common \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e参数说明：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3einput：项目目录（默认为当前目录）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eentry：入口文件名称（默认为 index.js）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eoutput：输出目录（默认为 .\/build 目录）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ebundle：默认输出文件名称与入口文件同名，也可指定文件名\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ecommon：是否打common包（默认为false）\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e\x3cstrong\x3e七、Moles 框架的案例\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e目前Moles框架已在携程的主App上投入生产，有兴趣的同学可以安装携程App 6.17，进入”我的携程“频道，其中的站内信页面就是基于Moles框架开发的。现在还有攻略、游轮等频道也在陆陆续续的接入中。相信在不久的将来，大家会在携程的各大频道上看到Moles的身影。我们也希望Moles能成为携程乃至业内基于React Native开发项目的首选框架。\x3c\/p\x3e\n\x3cp\x3e下面是基于Moles开发的效果图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyoWr\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyoWr\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e\x3cem\x3e我携频道\x3c\/em\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyoWx\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyoWx\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e\x3cem\x3e攻略频道\x3c\/em\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e\x3cstrong\x3e八、开源计划\x3c\/strong\x3e\x3c\/h3\x3e\n\x3cp\x3e之前分享的时候，就有不少同学咨询开源的事情。这里简述下，Moles未来将是一个开源的框架。是一个为开发React Native项目提供解决方案的开源框架。我们会将Moles框架的相关产品逐步的开源给大家。\x3c\/p\x3e\n\x3cp\x3e目前已将Moles框架的打包工具moles-packer开源在了github上。\x3c\/p\x3e\n\x3cp\x3e关于moles-packer的一些介绍：\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3emoles-packer 是由携程框架团队研发的，与携程Moles框架配套使用的React Native 打包和拆包工具，同时支持原生的 React Native 项目。\x3c\/p\x3e\n\x3cp\x3e当前版本：0.1.3\x3cbr\x3eGitHub 地址：\x3ca href=\x22https:\/\/github.com\/ctripcorp\/moles-packer\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/ctripcorp\/moles-packer\x3c\/a\x3e\x3cbr\x3enpm 地址：\x3ca href=\x22https:\/\/www.npmjs.com\/package\/moles-packer\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.npmjs.com\/package\/moles-packer\x3c\/a\x3e\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>React Native 实践之携程 Moles 框架</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005776912">https://segmentfault.com/a/1190000005776912</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/p9y8vgc0mz/" target="_blank">https://alili.tech/archive/p9y8vgc0mz/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>