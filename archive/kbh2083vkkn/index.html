<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="[聊一聊系列]聊一聊前端功能统计那些事儿"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>[聊一聊系列]聊一聊前端功能统计那些事儿 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/kbh2083vkkn/",
				"appid": "1613049289050283", 
				"title": "[聊一聊系列]聊一聊前端功能统计那些事儿 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-08T02:30:40"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/bvcw9yibbur/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/igb8mr9kw6l/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f&text=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f&text=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f&is_video=false&description=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fkbh2083vkkn%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e5%8a%9f%e8%83%bd%e7%bb%9f%e8%ae%a1%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">[聊一聊系列]聊一聊前端功能统计那些事儿</h1><div class="meta"><div class="postdate"><time datetime="2019-02-08" itemprop="datePublished">2019-02-08</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e欢迎大家收看聊一聊系列，这一套系列文章，可以帮助前端工程师们了解前端的方方面面（不仅仅是代码）：\x3ca href=\x22https:\/\/segmentfault.com\/blog\/frontenddriver\x22\x3ehttps:\/\/segmentfault.com\/blog...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e\x3cstrong\x3e1. 什么是功能统计\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e作为一名开发，我们的产品发布出去之后，无论是产品还是运营，其实都是想及时了解产品对用户产生的影响的。用户到底喜欢什么不喜欢什么。但是如果拉住用户去一个个问的话，也无法得到最真实的大众的想法。于是，运用大数据进行分析，就变成了产品们的利器。\x3c\/p\x3e\n\x3cp\x3e那么这些反映了用户真实行为的数据，就得靠前端工程师们来打印了。\x3c\/p\x3e\n\x3cp\x3e比如，你想看一个功能有多少用户进行了点击，来证明用户是否喜欢这个功能，亦或是你想看看用户究竟会在你的页面停留多长时间，从而判断用户的黏性。那么，在用户点击那个功能的时候，前端发送一条日志到服务端，这样积累下去，我们就能获得，每天有多少用户在点击某一个功能了。在功能发生迭代后，我们也能根据统计，来判断用户是否喜欢新的变化。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e\x3cstrong\x3e2. 如何统计\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e一般来讲，只要在想统计的行为发生时，发送一条请求到达服务端即可。这样我们的服务端就有了相应的记录。我们就能开心的利用记录数量来判断点击数量了。\x3c\/p\x3e\n\x3cp\x3e一般来讲我们不必为了发送请求，就在各处点击的地方加个ajax，其实有种发送请求的方式比ajax更加的简单。而且还避免了跨域问题。\x3c\/p\x3e\n\x3cp\x3e其实直接给一个图片、script标签赋值地址，就完成了一次GET请求。\x3c\/p\x3e\n\x3cp\x3e例(如图2.1所示)：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22(new Image()).src = \x27https:\/\/gm.mmstat.com\/tmallfp.4202.7\x27;\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eImage\x3c\/span\x3e()).src = \x3cspan class=\x22hljs-string\x22\x3e\x27https:\/\/gm.mmstat.com\/tmallfp.4202.7\x27\x3c\/span\x3e;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKRb\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKRb\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.1\x3c\/p\x3e\n\x3cp\x3e我们看到，轻轻松松就发送了一条请求出去，亦或者是使用script标签，或者fetch之类的方式也可以达到目的。\x3c\/p\x3e\n\x3cp\x3e本人观察了一下腾讯网和淘宝网，的日志。发现淘宝网使用的是请求一张空图片到服务端，以此来实现的日志打印。\x3c\/p\x3e\n\x3cp\x3e而腾讯网使用的，则是发送一个js请求的方式，来打印日志(如图2.2)\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKRc\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKRc\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.2\x3c\/p\x3e\n\x3cp\x3e其实无论使用什么方式，都殊途同归，最终我们得到的是服务端的一条access日志，利用这个日志，就可以记录了。\x3c\/p\x3e\n\x3cp\x3e我们在开发的时候，在用户发生各个行为时，发送一条记录了此行为的数据。这样就能记录自己产品的方方面面了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e\x3cstrong\x3e3. 服务端如何接收并使用数据\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e一般来讲服务器的server都会有access日志。这里拿nginx来举个例子。我们需要搭建一个nginx服务器，然后馋看nginx的conf(安装路径\/conf\/nginx.conf)如图3.1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKRj\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKRj\x22 alt=\x22142009_Qii3_1177792.png\x22 title=\x22142009_Qii3_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图3.1\x3c\/p\x3e\n\x3cp\x3enginx可以配置一个access日志的文件，每当有请求打到当前的nginx上，都会产出一条access日志。\x3c\/p\x3e\n\x3cp\x3e日志的路径也是可配置的，甚至可以配置文件的切割，这里就不再赘述。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKRk\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKRk\x22 alt=\x22142650_mpnX_1177792.png\x22 title=\x22142650_mpnX_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图3.2\x3c\/p\x3e\n\x3cp\x3e接着，我们访问一下这个服务，于是就产生了一条access日志(如图3.2)，我们只要在功能点击的时候，往这台机器上发送一个简单的请求即可产生日志啦。接下来把日志整理整理，就可以产出产品经理们想要的反馈了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e\x3cstrong\x3e4. 多种多样个性化的日志\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e如果我们需要各种各样的日志，那么可以把参数给多样化，用参数来区分各个不同地方的点击或者是各种交互行为。我们的access日志中，会留存有完整的URL，只要我们将其解析，就能拿到各处的点击行为了。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e\x3cstrong\x3e5. 跟我学---进行一次简单的打印日志\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e为了各位考虑，本小节的实验在windows下进行。首先，我们将下载一个nginx（本文最后的示例代码中也有），然后，更改其conf文件(如图5.1)。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKRr\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKRr\x22 alt=\x22173545_nMU7_1177792.png\x22 title=\x22173545_nMU7_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图5.1\x3c\/p\x3e\n\x3cp\x3e并将端口改为8091。并且去掉注释，打开access日志。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKRt\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKRt\x22 alt=\x22173354_2v8l_1177792.png\x22 title=\x22173354_2v8l_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图5.2\x3c\/p\x3e\n\x3cp\x3e双击启动即可。然后，我们访问一下\x3ca href=\x22http:\/\/localhost:8091\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/localhost:8091\/\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e发现nginx已然运行成功(如图5.3)\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKRx\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKRx\x22 alt=\x22173428_pCrk_1177792.png\x22 title=\x22173428_pCrk_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图5.3\x3c\/p\x3e\n\x3cp\x3e接下来，我们看一下logs\/access.log中的记录(如图5.4)\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKRD\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKRD\x22 alt=\x22173801_c4Du_1177792.png\x22 title=\x22173801_c4Du_1177792.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图5.4\x3c\/p\x3e\n\x3cp\x3e多了一条，证明有记录了。\x3c\/p\x3e\n\x3cp\x3e接着，我们创建一个html（在哪儿创建都行）--- testlog.html\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n    \x3chead\x3e\n        \x3cmeta charset=\x26quot;utf-8\x26quot;\x3e\n    \x3c\/head\x3e\n    \x3cbody\x3e\n        \x3cbutton id=\x26quot;click2log\x26quot;\x3e点我\x3c\/button\x3e\n        \x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n            document\n            .getElementById(\x27click2log\x27)\n            .addEventListener(\x27click\x27, function () {\n                (new Image()).src = \x27http:\/\/localhost:8091\/?action=log\x26amp;clk=button\x27;\n            });\n        \x3c\/script\x3e\n    \x3c\/body\x3e\n\x3c\/html\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22utf-8\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22click2log\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e点我\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n            \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e\n            .getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27click2log\x27\x3c\/span\x3e)\n            .addEventListener(\x3cspan class=\x22hljs-string\x22\x3e\x27click\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                (\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Image()).src = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/localhost:8091\/?action=log\x26amp;clk=button\x27\x3c\/span\x3e;\n            });\n        \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行页面，点击按钮。我们发现，发送出一条日志(如图5.5)\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKR2\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKR2\x22 alt=\x22174317_geMt_1177792.png\x22 title=\x22174317_geMt_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图5.5\x3c\/p\x3e\n\x3cp\x3e我们再次打开access.log，发现多了一条日志(如图5.6)\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyKSb\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyKSb\x22 alt=\x22174403_AzSS_1177792.png\x22 title=\x22174403_AzSS_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图5.6\x3c\/p\x3e\n\x3cp\x3e于是我们的目的达成了。以后可以用action=log并且，clk=button的记录，来看有多少用户点击了按钮了。\x3c\/p\x3e\n\x3cp\x3e示例代码在此：\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/houyu01\/log-samples\/tree\/master\/log-base-sample\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/houyu01\/lo...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e\x3cstrong\x3e6. 需要注意的点\x3c\/strong\x3e\x3c\/h2\x3e\n\x3cp\x3e在日常打日志中，我们会遇到这样那样的问题，这里谨把我再工作中遇到的问题与大家分享一下。\x3c\/p\x3e\n\x3ch5\x3e1. 当点击发生本页跳转的时候，同时发送日志有一定几率无法发出。\x3c\/h5\x3e\n\x3cp\x3e当a标签发生点击的时候，我们往往会发送一条外链的点击日志，但是，如果这个a标签是本页跳转（而不是新开页面）的话，那么在日志发送之前，页面有可能就已经跳转了，这时，所有的请求都是发不出去的。目前应对这种状况，没有什么特别好的办法，\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e可以尝试使用先发日志，在日志的回调用进行跳转，这样就有可能造成跳转慢。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e使用新式API\x26nbsp;navigator.sendBeacon()，可以在本页面跳转之后，坚强的发出一条请求。但是兼容性不太好。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch5\x3e2. 发送的参数不要太多，太长\x3c\/h5\x3e\n\x3cp\x3e因为我们的请求毕竟算是GET请求，肯定有URL长度的限制。所以，发了大量的信息的话，怕会被截断。\x3c\/p\x3e\n\x3ch5\x3e3. 有一定丢失率\x3c\/h5\x3e\n\x3cp\x3e因为网络等等的原因，发送的日志，丢失率是肯定会有的，各位如果习惯的话，也就好了。\x3c\/p\x3e\n\x3cp\x3e不要走开，请关注我。下一章，我们将继续聊聊速度统计。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005869953\x22\x3ehttps:\/\/segmentfault.com\/a\/11...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e原创文章，版权所有，转载请注明出处\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>[聊一聊系列]聊一聊前端功能统计那些事儿</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005861012">https://segmentfault.com/a/1190000005861012</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/kbh2083vkkn/" target="_blank">https://alili.tech/archive/kbh2083vkkn/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>