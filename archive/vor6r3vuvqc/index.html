<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="原生JS实现DOM粒子爆炸效果"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>原生JS实现DOM粒子爆炸效果 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/vor6r3vuvqc/",
				"appid": "1613049289050283", 
				"title": "原生JS实现DOM粒子爆炸效果 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-14T02:30:37"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3k51vzbosud/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/y415qglotxo/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f&text=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f&text=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f&title=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f&is_video=false&description=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f&title=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f&title=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f&title=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fvor6r3vuvqc%2f&title=%e5%8e%9f%e7%94%9fJS%e5%ae%9e%e7%8e%b0DOM%e7%b2%92%e5%ad%90%e7%88%86%e7%82%b8%e6%95%88%e6%9e%9c"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">原生JS实现DOM粒子爆炸效果</h1><div class="meta"><div class="postdate"><time datetime="2019-02-14" itemprop="datePublished">2019-02-14</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e爆炸动效分享\x3c\/h1\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e此次分享是一次自我组件开发的总结，还是有很多不足之处，望各位大大多提宝贵意见，互相学习交流。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e分享内容介绍\x3c\/h2\x3e\n\x3cblockquote\x3e通过原生js代码，实现粒子爆炸效果组件\x3cbr\x3e组件开发过程中，使用到了公司内部十分高效的工程化环境，特此打个广告： 新浪移动诚招各种技术大大！可以私聊投简历哦！\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e效果预览\x3c\/h2\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbiJF7?w=352\x26amp;h=640\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbiJF7?w=352\x26amp;h=640\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e效果分析\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e点击作为动画开始的起点,自动结束\x3c\/li\x3e\n\x3cli\x3e每次效果产生多个抛物线粒子运动的元素，方向随机，展示内容不一样，有空间上Z轴的大小变化\x3c\/li\x3e\n\x3cli\x3e需求上可以无间隔点击，即第一组动画未结束可播放第二组动画\x3c\/li\x3e\n\x3cli\x3e动画基本执行时长一致\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch5\x3e由以上四点分析后，动画实现有哪些实现方案呢？\x3c\/h5\x3e\n\x3cul\x3e\x3cli\x3e\x3ch5\x3ecss操作态变换（如focus）使子元素执行动画\x3c\/h5\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3ccode\x3e不可取，效果可多次连点，css状态变换与需求不符\x3c\/code\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ch5\x3eJs 控制动画开始，事先写好css动画预置，通过class 包含选择器切换动画 例如： .active .items{animation:xxx ...;}\x3c\/h5\x3e\n\x3cp\x3e\x3ccode\x3e不可取，单次执行动画没有问题，但是存在效果的固定，以及无法连续执行动画\x3c\/code\x3e\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3ch5\x3e事先写好大量动画，隐藏大量dom元素，动画开始随机选取dom元素执行自己唯一的动画keyframes\x3c\/h5\x3e\n\x3cp\x3e\x3ccode\x3e实现层面来说，行得通，但是评论列表长的时候，dom数量巨大，且css大量动画造成代码量沉重、无随机性\x3c\/code\x3e\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3ch5\x3e抛弃css动画，使用canvas 绘制动画\x3c\/h5\x3e\n\x3cp\x3e\x3ccode\x3e可行，但是canvas维护成本略高，且自定义功能难设计，屏幕适配也有一定成本\x3c\/code\x3e\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3ch5\x3ejs做dom创建，生成随机css @keyframes\x3c\/h5\x3e\n\x3cp\x3e\x3ccode\x3e可行，但是创建style样式表，引发css重新渲染页面，会导致页面的性能下降，且抛物线css的复杂度不低，暂不作为首选\x3c\/code\x3e\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3ch5\x3ejs 刷帧 做dom渲染\x3c\/h5\x3e\n\x3cp\x3e\x3ccode\x3e可行，但是刷帧操作会造成性能压力\x3c\/code\x3e\x3c\/p\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch5\x3e结论\x3c\/h5\x3e\n\x3cp\x3ecanvas虽说可行，但由于其开发弊端 本次分享不以canvas为分享内容，而是使用最后一种 js刷帧的dom操作\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e组件结构\x3c\/h2\x3e\n\x3cp\x3e由截图分享，动画可以分为两个模块，首先，随机发散的粒子具有共性：抛物线动画，淡出，渲染表情\x3c\/p\x3e\n\x3cp\x3e而例子数量变多之后则为截图中的效果\x3c\/p\x3e\n\x3cp\x3e但是，由于性能原因，我们需要做到粒子的掌控，实现资源再利用，那么还需要第二个模块，作为粒子的管控组件\x3c\/p\x3e\n\x3cp\x3e所以： 此功能可使用两个模块进行开发： partical.js 粒子功能 与 boom.js 粒子管理\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e实现 Partical.js\x3c\/h2\x3e\n\x3col\x3e\x3cli\x3e\n\x3cp\x3e前置资源：抛物线运动的物理曲线需要使用Tween.js提供的速度函数\x3c\/p\x3e\n\x3cp\x3e若不想引入Tween.js 可以使用以下代码\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 \n      * Tween.js\n      * t: current time（当前时间）；\n      * b: beginning value（初始值）；\n      * c: change in value（变化量）；\n      * d: duration（持续时间）。\n      * you can visit \x27http:\/\/easings.net\/zh-cn\x27 to get effect\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs livecodeserver\x22\x3e\x3ccode\x3e \n      * Tween.js\n      * t: current \x3cspan class=\x22hljs-built_in\x22\x3etime\x3c\/span\x3e（当前时间）；\n      * b: beginning \x3cspan class=\x22hljs-built_in\x22\x3evalue\x3c\/span\x3e（初始值）；\n      * c: change \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3evalue\x3c\/span\x3e（变化量）；\n      * d: duration（持续时间）。\n      * you can visit \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/easings.net\/zh-cn\x27\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eto\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e effect\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22        *\n    \n        const Quad = {\n            easeIn: function(t, b, c, d) {\n                return c * (t \/= d) * t \x2b b;\n            },\n            easeOut: function(t, b, c, d) {\n                return -c *(t \/= d)*(t-2) \x2b b;  \n            },\n            easeInOut: function(t, b, c, d) {\n                if ((t \/= d \/ 2) \x3c 1) return c \/ 2 * t * t \x2b b;\n                return -c \/ 2 * ((--t) * (t-2) - 1) \x2b b;\n            }\n        }\n        const Linear = function(t, b, c, d) { \n            return c * t \/ d \x2b b; \n        }\n    \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e        *\n    \n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e Quad = {\n            easeIn: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(t, b, c, d)\x3c\/span\x3e \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e c * (t \/= d) * t \x2b b;\n            },\n            easeOut: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(t, b, c, d)\x3c\/span\x3e \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e -c *(t \/= d)*(t\x3cspan class=\x22hljs-number\x22\x3e-2\x3c\/span\x3e) \x2b b;  \n            },\n            easeInOut: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(t, b, c, d)\x3c\/span\x3e \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((t \/= d \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e) \x26lt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e c \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e * t * t \x2b b;\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e -c \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e * ((--t) * (t\x3cspan class=\x22hljs-number\x22\x3e-2\x3c\/span\x3e) - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) \x2b b;\n            }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e Linear = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(t, b, c, d)\x3c\/span\x3e \x3c\/span\x3e{ \n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e c * t \/ d \x2b b; \n        }\n    \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3col\x3e\x3cli\x3e\n\x3cp\x3e粒子实现\x3cbr\x3e实现思路：\x3cbr\x3e 希望在粒子管控组件时，使用new partical的方式创建粒子，每个粒子存在自己的动画开始方法，动画结束回调。\x3cbr\x3e 由于评论列表可能存在数量巨大的情况，我们希望只全局创建有限个数的粒子，那么则提供呢容器移除粒子功能以及容器添加粒子的功能，实现粒子的复用\x3c\/p\x3e\n\x3cp\x3epartical_style.css\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22     \n     \/\/粒子充满粒子容器，需要容器存在尺寸以及relative定位\n     .Boom-Partical_Holder{\n         position: absolute;\n         left:0;\n         right:0;\n         top:0;\n         bottom:0;\n         margin:auto;\n     }\n     \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs scss\x22\x3e\x3ccode\x3e     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/粒子充满粒子容器，需要容器存在尺寸以及relative定位\x3c\/span\x3e\n     \x3cspan class=\x22hljs-selector-class\x22\x3e.Boom-Partical_Holder\x3c\/span\x3e{\n         \x3cspan class=\x22hljs-attribute\x22\x3eposition\x3c\/span\x3e: absolute;\n         \x3cspan class=\x22hljs-attribute\x22\x3eleft\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-attribute\x22\x3eright\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-attribute\x22\x3etop\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-attribute\x22\x3ebottom\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-attribute\x22\x3emargin\x3c\/span\x3e:auto;\n     }\n     \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eparticle.js\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22 \n import \x26quot;partical_style.css\x26quot;;\n \n class Partical{\n     \/\/ dom为装载动画元素的容器 用于设置位置等样式\n     dom = null;\n     \/\/ 动画开始时间\n     StartTime = -1;\n     \/\/ 当前粒子的动画方向，区别上抛运动与下抛运动\n     direction = \x26quot;UP\x26quot;;\n     \/\/ 动画延迟\n     delay = 0;\n     \/\/ 三方向位移值\n     targetZ = 0;\n     targetY = 0;\n     targetX = 0;\n     \/\/ 缩放倍率\n     scaleNum = 1;\n     \/\/ 是否正在执行动画\n     animating = false;\n     \/\/ 粒子的父容器，标识此粒子被渲染到那个元素内\n     parent = null;\n     \/\/ 动画结束的回调函数列表\n     animEndCBList = [];\n     \/\/ 粒子渲染的内容容器 slot\n     con = null;\n     \n     constructor(){\n         \/\/创建动画粒子dom\n         this.dom = document.createElement(\x26quot;div\x26quot;);\n         this.dom.classList.add(\x26quot;Boom-Partical_Holder\x26quot;);\n         this.dom.innerHTML = `\n             \x3cdiv class=\x26quot;Boom-Partical_con\x26quot;\x3e\n                 Boom\n             \x3c\/div\x3e\n         `;\n     }\n     \n     \/\/ 在哪里渲染\n     renderIn(parent) {\n         \/\/ dom判断此处省略\n         parent.appendChild(this.dom);\n         this.parent = parent;\n         \/\/ 此处为初始化 slot 容器\n         !this.con \x26amp;\x26amp; ( this.con = this.dom.querySelector(\x26quot;.Boom-Partical_con\x26quot;));\n     }\n     \n     \/\/ 用于父容器移除当前粒子\n     deleteEl(){\n         \/\/ dom判断此处省略\n         this.parent.removeChild(this.dom);\n     }\n     \n     \/\/ 执行动画，需要此粒子执行动画的角度，动画的力度，以及延迟时间\n     animate({ deg, pow, delay } = {}){\n         \/\/ 后续补全\n     }\n     \n     \/\/ 动画结束回调存储\n     onAnimationEnd(cb) {\n         if (typeof cb !== \x27function\x27) return;\n         this.animEndCBList.push(cb);\n     }\n     \n     \/\/ 动画结束回调执行\n     emitEndCB() {\n         this.dom.style.cssText \x2b= `;-webkit-transform:translate3d(0,0,0);opacity:1;`;\n         this.animating = false;\n         try {\n             for (let cb  of this.animEndCBList) {\n                 cb();\n             }\n         } catch (error) {\n             console.warn(\x26quot;回调报错:\x26quot;,cb);\n         }\n     }\n     \n     \/\/ 简易实现slot功能，向粒子容器内添加元素\n     insertChild(child){\n         this.con.innerHTML = \x27\x27;\n         this.con.appendChild(child);\n     }\n }\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e \n \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22partical_style.css\x22\x3c\/span\x3e;\n \n \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ePartical\x3c\/span\x3e\x3c\/span\x3e{\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ dom为装载动画元素的容器 用于设置位置等样式\x3c\/span\x3e\n     dom = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 动画开始时间\x3c\/span\x3e\n     StartTime = \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 当前粒子的动画方向，区别上抛运动与下抛运动\x3c\/span\x3e\n     direction = \x3cspan class=\x22hljs-string\x22\x3e\x22UP\x22\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 动画延迟\x3c\/span\x3e\n     delay = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 三方向位移值\x3c\/span\x3e\n     targetZ = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n     targetY = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n     targetX = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 缩放倍率\x3c\/span\x3e\n     scaleNum = \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 是否正在执行动画\x3c\/span\x3e\n     animating = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 粒子的父容器，标识此粒子被渲染到那个元素内\x3c\/span\x3e\n     parent = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 动画结束的回调函数列表\x3c\/span\x3e\n     animEndCBList = [];\n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 粒子渲染的内容容器 slot\x3c\/span\x3e\n     con = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n     \n     \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(){\n         \x3cspan class=\x22hljs-comment\x22\x3e\/\/创建动画粒子dom\x3c\/span\x3e\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dom = document.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22div\x22\x3c\/span\x3e);\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dom.classList.add(\x3cspan class=\x22hljs-string\x22\x3e\x22Boom-Partical_Holder\x22\x3c\/span\x3e);\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dom.innerHTML = `\n             \x26lt;div \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e=\x22\x3cspan class=\x22hljs-title\x22\x3eBoom\x3c\/span\x3e-\x3cspan class=\x22hljs-title\x22\x3ePartical_con\x3c\/span\x3e\x22\x26gt;\x3c\/span\x3e\n                 Boom\n             \x26lt;\/div\x26gt;\n         `;\n     }\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在哪里渲染\x3c\/span\x3e\n     renderIn(parent) {\n         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ dom判断此处省略\x3c\/span\x3e\n         parent.appendChild(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dom);\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.parent = parent;\n         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 此处为初始化 slot 容器\x3c\/span\x3e\n         !\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.con \x26amp;\x26amp; ( \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.con = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dom.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x22.Boom-Partical_con\x22\x3c\/span\x3e));\n     }\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 用于父容器移除当前粒子\x3c\/span\x3e\n     deleteEl(){\n         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ dom判断此处省略\x3c\/span\x3e\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.parent.removeChild(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dom);\n     }\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 执行动画，需要此粒子执行动画的角度，动画的力度，以及延迟时间\x3c\/span\x3e\n     animate({ deg, pow, delay } = {}){\n         \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 后续补全\x3c\/span\x3e\n     }\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 动画结束回调存储\x3c\/span\x3e\n     onAnimationEnd(cb) {\n         \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (typeof cb !== \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.animEndCBList.push(cb);\n     }\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 动画结束回调执行\x3c\/span\x3e\n     emitEndCB() {\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dom.style.cssText \x2b= `;-webkit-transform:translate3d(\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e);opacity:\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e;`;\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.animating = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n             \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (let cb  of \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.animEndCBList) {\n                 cb();\n             }\n         } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (error) {\n             console.warn(\x3cspan class=\x22hljs-string\x22\x3e\x22回调报错:\x22\x3c\/span\x3e,cb);\n         }\n     }\n     \n     \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 简易实现slot功能，向粒子容器内添加元素\x3c\/span\x3e\n     insertChild(child){\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.con.innerHTML = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n         \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.con.appendChild(child);\n     }\n }\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3c\/li\x3e\x3c\/ol\x3e\n\x3cp\x3e致此，我们先创建了一个粒子对象的构造函数，现在考虑一下我们实现了我们的设计思路吗？\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e使用构造函数new Partical( )粒子\x3c\/li\x3e\n\x3cli\x3e粒子实力对象存在 animate 执行动画方法\x3c\/li\x3e\n\x3cli\x3e有动画结束回调函数的存储和执行\x3c\/li\x3e\n\x3cli\x3e设置粒子的父元素: renderIn 方法\x3c\/li\x3e\n\x3cli\x3e父元素删除粒子: deleteEl 方法\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e为了更好的展示粒子内容，我们特意在constructor里创建了一个 Boom-Partical_con 元素用于模拟slot功能:  insertChild方法，用于使用者展示不同的内容进行爆炸💥\x3c\/p\x3e\n\x3cp\x3e接下来考虑一下动画的实现过程，动画毫无疑问为抛物线动画，这种动画在代码中实现可以使用物理公式，\x3cbr\x3e但是我们也可以通过速度曲线实现，想想上抛过程可以想成 由于重力影响 ，变成一个速度逐渐减小的向上位移的过程，\x3cbr\x3e而下抛过程可以理解为加速过程；\x3cbr\x3e则可对应为速度曲线的easeOut 与 easeIn, \x3cbr\x3e而水平方向可以理解为匀速运动，则是 linear；\x3c\/p\x3e\n\x3cp\x3e我们以水平向右为X正方向0度，顺时针方向角度增加；\x3cbr\x3e则 小于 180度为向下， 大于180度为向上\x3cbr\x3e假设方向为\x3ccode\x3e四点钟\x3c\/code\x3e方向，夹角则为 \x3ccode\x3e30\x3c\/code\x3e 度，\x3cbr\x3e按照高中物理，大小为N的力:\x3cbr\x3e\x3ccode\x3e 在X轴的分量应为 cos(30) * N \x3c\/code\x3e\x3cbr\x3e\x3ccode\x3e 在Y轴的分量应为 sin(30) * N\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbiJtz?w=600\x26amp;h=522\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbiJtz?w=600\x26amp;h=522\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e也就是说 我们可以知道一个方向上的力在XY轴的分量大小，\x3cbr\x3e假设我们将 力 的概念 转化为 视图中 位移的概念，\x3cbr\x3e我们将 力量1 记为 10vh的大小\x3cbr\x3e于是我们可以定义全局变量\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const POWER = 10; \/\/ 单位 vh 力的单位转化比例\nconst G = 5;      \/\/ 单位 vh 重力值\nconst DEG = Math.PI \/ 180;  \nconst Duration = .4e3; \/\/假设动画执行时长400毫秒\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dart\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e POWER = \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 单位 vh 力的单位转化比例\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e G = \x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e;      \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 单位 vh 重力值\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e DEG = Math.PI \/ \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e;  \n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDuration\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e.4e3\x3c\/span\x3e; \x3cspan class=\x22hljs-comment\x22\x3e\/\/假设动画执行时长400毫秒\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e由此 我们补全 animate方法\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 执行动画 角度 ， 力 1 ~ 10 ; 1 = 10vh\nanimate({ deg, pow, delay } = {}) {\n    this.direction = deg \x3e 180 ? \x26quot;UP\x26quot; : \x26quot;DOWN\x26quot;;\n    this.delay = delay || 0;\n    let r = Math.random();\n    this.targetZ = 0;\n    this.targetY = Math.round(pow * Math.sin(deg * DEG) * POWER);\n    this.targetX = Math.round(pow * Math.cos(deg * DEG) * POWER) * (r \x2b 1);\n    this.scaleNum = (r * 0.8) * (r \x3c 0.5 ? -1 : 1);\n    this.raf();\n}\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs arduino\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 执行动画 角度 ， 力 1 ~ 10 ; 1 = 10vh\x3c\/span\x3e\nanimate({ deg, \x3cspan class=\x22hljs-built_in\x22\x3epow\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3edelay\x3c\/span\x3e } = {}) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.direction = deg \x26gt; \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x22UP\x22\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x22DOWN\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3edelay\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3edelay\x3c\/span\x3e || \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    let r = Math.\x3cspan class=\x22hljs-built_in\x22\x3erandom\x3c\/span\x3e();\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetZ = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetY = Math.round(\x3cspan class=\x22hljs-built_in\x22\x3epow\x3c\/span\x3e * Math.\x3cspan class=\x22hljs-built_in\x22\x3esin\x3c\/span\x3e(deg * DEG) * POWER);\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetX = Math.round(\x3cspan class=\x22hljs-built_in\x22\x3epow\x3c\/span\x3e * Math.\x3cspan class=\x22hljs-built_in\x22\x3ecos\x3c\/span\x3e(deg * DEG) * POWER) * (r \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scaleNum = (r * \x3cspan class=\x22hljs-number\x22\x3e0.8\x3c\/span\x3e) * (r \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0.5\x3c\/span\x3e ? \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e : \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.raf();\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eanimte的思路为：通过传入的角度和力度 计算目标终点位置（因为力最终转化为位移值，力越大，目标位移越大）\x3c\/p\x3e\n\x3cp\x3e使用随机数计算此次动画的缩放值变化范围（-0.8 ～ 0.8）\x3c\/p\x3e\n\x3cp\x3e然后执行刷帧操作 raf\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22raf(){\n    \/\/ 正在执行动画    \n    this.animating = true;\n\n    \/\/ 动画开始时间\n    this.StartTime = \x2bnew Date();\n    let StartTime = this.StartTime;\n    \n    \/\/ 获取延时\n    let delay = this.delay;\n    \n    \/\/ 动画会在延时后开始，也就是真正开始动画的时间\n    let StartTimeAfterDelay = StartTime \x2b delay\n\n\n\n    let animate = () =\x3e {\n        \/\/ 获取从执行动画开始经过了多久\n        let timeGap = \x2bnew Date() - StartTimeAfterDelay;\n        \/\/ 大于0 证明过了delay时间\n        if (timeGap \x3e= 0) {\n            \/\/ 大于Duration证明过了结束时间\n            if (timeGap \x3e Duration) {\n                \/\/ 执行动画结束回调\n                this.emitEndCB();\n                return;\n            }\n            \/\/ 设置应该设置的位置的样式\n            this.dom.style.cssText \x2b= `;will-change:transform;-webkit-transform:translate3d(${this.moveX(timeGap)}vh,${this.moveY(timeGap)}vh,0) scale(${this.scale(timeGap)});opacity:${this.opacity(timeGap)};`;\n        }\n        requestAnimationFrame(animate);\n    }\n    animate();\n}\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3eraf(){\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 正在执行动画    \x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.animating = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 动画开始时间\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.StartTime = \x2b\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e();\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e StartTime = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.StartTime;\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取延时\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e delay = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.delay;\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 动画会在延时后开始，也就是真正开始动画的时间\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e StartTimeAfterDelay = StartTime \x2b delay\n\n\n\n    \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e animate = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 获取从执行动画开始经过了多久\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e timeGap = \x2b\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e() - StartTimeAfterDelay;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 大于0 证明过了delay时间\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (timeGap \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 大于Duration证明过了结束时间\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (timeGap \x26gt; Duration) {\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 执行动画结束回调\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.emitEndCB();\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置应该设置的位置的样式\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.dom.style.cssText \x2b= \x3cspan class=\x22hljs-string\x22\x3e`;will-change:transform;-webkit-transform:translate3d(\x3cspan class=\x22hljs-subst\x22\x3e${\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.moveX(timeGap)}\x3c\/span\x3evh,\x3cspan class=\x22hljs-subst\x22\x3e${\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.moveY(timeGap)}\x3c\/span\x3evh,0) scale(\x3cspan class=\x22hljs-subst\x22\x3e${\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scale(timeGap)}\x3c\/span\x3e);opacity:\x3cspan class=\x22hljs-subst\x22\x3e${\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.opacity(timeGap)}\x3c\/span\x3e;`\x3c\/span\x3e;\n        }\n        requestAnimationFrame(animate);\n    }\n    animate();\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e刷帧操作中判断了delay时间的处理以及结束的时间处理回调\x3c\/p\x3e\n\x3cp\x3e那么揭晓来就剩下 moveX，moveY，scale，opacity的设置\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 水平方向为匀速，所以使用Linear\nmoveX(currentDuration) {\n    \/\/ 此处 * 2 是效果矫正后的处理，可根据自己的需求修改水平位移速度\n    return Linear(currentDuration, 0, this.targetX, Duration) * 2;\n}\n\n\/\/ 缩放 使用了easeOut曲线， 可根据需求自行修改\nscale(currentDuration) {\n    return Quad.easeOut(currentDuration, 1, this.scaleNum, Duration);\n}\n\n\/\/ 透明度 使用了easeIn速度曲线，保证后消失\nopacity(currentDuration) {\n    return Quad.easeIn(currentDuration, 1, -1, Duration);\n}\n\n\/\/ 竖直方向上位移计算\nmoveY(currentDuration) {\n    let direction = this.direction;\n    if (direction === \x27UP\x27) {\n        \/\/ G用于模拟上抛过程的重力\n        \/\/ 如果是上抛运动\n        if (currentDuration \x3c Duration \/ 2) {\n            \/\/ 上抛过程 我们使用easeOut速度逐渐减小，我们让动画在一半时移到最高点\n            return Quad.easeOut(currentDuration, 0, this.targetY \x2b G, Duration \/ 2);\n        }\n        \/\/ 上抛的下降过程，从最高点下降\n        return this.targetY \x2b G - Quad.easeIn(currentDuration - Duration \/ 2, 0, this.targetY \/ 2, Duration \/ 2);\n    }\n    \/\/ 下抛运动直接easeIn\n    return Quad.easeIn(currentDuration, 0, this.targetY, Duration);\n}\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 水平方向为匀速，所以使用Linear\x3c\/span\x3e\nmoveX(currentDuration) {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 此处 * 2 是效果矫正后的处理，可根据自己的需求修改水平位移速度\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Linear(currentDuration, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetX, Duration) * \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e;\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 缩放 使用了easeOut曲线， 可根据需求自行修改\x3c\/span\x3e\nscale(currentDuration) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Quad.easeOut(currentDuration, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.scaleNum, Duration);\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 透明度 使用了easeIn速度曲线，保证后消失\x3c\/span\x3e\nopacity(currentDuration) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Quad.easeIn(currentDuration, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e, Duration);\n}\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 竖直方向上位移计算\x3c\/span\x3e\nmoveY(currentDuration) {\n    let direction = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.direction;\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (direction === \x3cspan class=\x22hljs-string\x22\x3e\x27UP\x27\x3c\/span\x3e) {\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ G用于模拟上抛过程的重力\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果是上抛运动\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (currentDuration \x26lt; Duration \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e) {\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 上抛过程 我们使用easeOut速度逐渐减小，我们让动画在一半时移到最高点\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Quad.easeOut(currentDuration, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetY \x2b G, Duration \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 上抛的下降过程，从最高点下降\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetY \x2b G - Quad.easeIn(currentDuration - Duration \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetY \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, Duration \/ \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 下抛运动直接easeIn\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Quad.easeIn(currentDuration, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.targetY, Duration);\n}\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e至此，partical.js 结束，文件末尾加一行\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export default Partical; \n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cpp\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e Partical; \n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此时 我们的partical.js输出一个构造函数:\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3enew 的时候创建了粒子元素，\x3c\/li\x3e\n\x3cli\x3e使用onAnimtionEnd可以实现动画结束的回调函数\x3c\/li\x3e\n\x3cli\x3einsertChild可以向粒子内渲染使用者自定义的dom\x3c\/li\x3e\n\x3cli\x3erenderIn 可以设置粒子父元素\x3c\/li\x3e\n\x3cli\x3edeleteEl 可以从父元素删除粒子\x3c\/li\x3e\n\x3cli\x3eanimate 可以执行刷帧，渲染计算位置，触发回调\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e于是对于粒子来说，只剩下在执行animte的时候 传入的力的大小，方向，以及延迟时间\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e粒子管理 Boom.js\x3c\/h2\x3e\n\x3cp\x3e\x3ccode\x3e之所以叫Boom是因为一开始组件名叫Boom，其实叫ParticalController更好一些，哈哈😄\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e对于Boom.js的功能需求为\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e创建粒子\x3c\/li\x3e\n\x3cli\x3e执行粒子动画，赋予动画力、角度、延时\x3c\/li\x3e\n\x3cli\x3e设置粒子容器\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e可达到效果：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e不关心业务，业务使用者传入每个粒子slot内容数组\x3c\/li\x3e\n\x3cli\x3e粒子组件可复用\x3c\/li\x3e\n\x3cli\x3e易于维护（可能是哈哈哈）\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch5\x3e于是粒子管理器构架为：\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Partical from \x26quot;partical.js\x26quot;;\n\nclass Boom{\n    \/\/ 实例化的粒子列表\n    particalList = [];\n    \/\/ 单次生成的粒子个数\n    particalNumbers = 6;\n    \/\/ 执行动画的间隔时间\n    boomTimeGap = .1e3;\n    boomTimer = 0;\n    \/\/ 用户插入粒子的slot 的内容\n    childList = [];\n    \/\/ 默认旋转角度\n    rotate = 120;\n    \/\/ 默认的粒子发散范围\n    spread = 180;\n    \/\/ 默认随机延迟范围\n    delayRange = 100;\n    \/\/ 默认力度\n    power = 3;\n    \/\/ 此次执行粒子爆炸的是那个容器\n    con = null;\n    \n    constructor({ childList , container , boomNumber , rotate , spread , delayRange , power} = {}){\n        \n        this.childList = childList || [];\n        this.con = container || null;\n        this.particalNumbers = boomNumber || 6;\n        this.rotate = rotate || 120;\n        this.spread = spread || 180;\n        this.delayRange = delayRange || 100;\n        this.power = power || 3;\n        this.createParticals(this.particalNumbers);\n    }\n    setContainer(con){\n        this.con = con;\n    }\n    \/\/ 创建粒子 存入内存数组中\n    createParticals(num){\n        for(let i = 0 ; i \x3c num ; i\x2b\x2b){\n            let partical = new Partical();\n            partical.onAnimationEnd(()=\x3e{\n                partical.deleteEl();\n            });\n            this.particalList.push(partical)\n        }\n    }\n    \/\/ 执行动画\n    boom(){\n        \/\/ 限制动画执行间隔\n        let lastBoomTimer = this.boomTimer;\n        let now = \x2bnew Date();\n        if(now - lastBoomTimer \x3c this.boomTimeGap){\n            \/\/ console.warn(\x26quot;点的太快了\x26quot;);\n            return;\n        }\n        this.boomTimer = now;\n        \n        \n        console.warn(\x26quot;粒子总数:\x26quot; , this.particalList.length)\n        let boomNums = 0;\n        \/\/ 在内存列表找，查找没有执行动画的粒子\n        let unAnimateList = this.particalList.filter(partical =\x3e partical.animating == false);\n\n        let childList = this.childList;\n        let childListLength = childList.length;\n\n        let rotate = this.rotate;\n        let spread = this.spread;\n        let delayRange = this.delayRange;\n        let power = this.power;\n        \n        \/\/ 每有一个未执行动画的粒子，执行一次动画\n        for(let partical of unAnimateList){\n            if(boomNums \x3e= this.particalNumbers) return ;\n            \n            boomNums\x2b\x2b;\n            let r = Math.random();\n            \/\/ 设置粒子父容器\n            partical.renderIn(this.con);\n            \/\/ 随机选择粒子的slot内容\n            partical.insertChild(childList[Math.floor(r * childListLength)].cloneNode(true));\n            \/\/ 执行动画，在输入范围内随机角度、力度、延迟\n            partical.animate({\n                deg: (r * spread \x2b rotate) % 360,\n                pow: r * power \x2b 1,\n                delay: r * delayRange,\n            });\n        }\n        \/\/ 如果粒子树木不够，则再次创建，防止下次不够用\n        if(boomNums \x3c this.particalNumbers){\n            this.createParticals(this.particalNumbers - boomNums);\n        }\n    }\n}\n\n\nexport default Boom;\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Partical \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22partical.js\x22\x3c\/span\x3e;\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eBoom\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 实例化的粒子列表\x3c\/span\x3e\n    particalList = [];\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 单次生成的粒子个数\x3c\/span\x3e\n    particalNumbers = \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 执行动画的间隔时间\x3c\/span\x3e\n    boomTimeGap = \x3cspan class=\x22hljs-number\x22\x3e.1e3\x3c\/span\x3e;\n    boomTimer = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 用户插入粒子的slot 的内容\x3c\/span\x3e\n    childList = [];\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认旋转角度\x3c\/span\x3e\n    rotate = \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认的粒子发散范围\x3c\/span\x3e\n    spread = \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认随机延迟范围\x3c\/span\x3e\n    delayRange = \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认力度\x3c\/span\x3e\n    power = \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 此次执行粒子爆炸的是那个容器\x3c\/span\x3e\n    con = \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n    \n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e({ childList , container , boomNumber , rotate , spread , delayRange , power} = {}){\n        \n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.childList = childList || [];\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.con = container || \x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.particalNumbers = boomNumber || \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.rotate = rotate || \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.spread = spread || \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.delayRange = delayRange || \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.power = power || \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.createParticals(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.particalNumbers);\n    }\n    setContainer(con){\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.con = con;\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建粒子 存入内存数组中\x3c\/span\x3e\n    createParticals(num){\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ; i \x26lt; num ; i\x2b\x2b){\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e partical = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Partical();\n            partical.onAnimationEnd(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n                partical.deleteEl();\n            });\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.particalList.push(partical)\n        }\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 执行动画\x3c\/span\x3e\n    boom(){\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 限制动画执行间隔\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e lastBoomTimer = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.boomTimer;\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e now = \x2b\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e();\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(now - lastBoomTimer \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.boomTimeGap){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ console.warn(\x22点的太快了\x22);\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.boomTimer = now;\n        \n        \n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.warn(\x3cspan class=\x22hljs-string\x22\x3e\x22粒子总数:\x22\x3c\/span\x3e , \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.particalList.length)\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e boomNums = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 在内存列表找，查找没有执行动画的粒子\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e unAnimateList = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.particalList.filter(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3epartical\x3c\/span\x3e =\x26gt;\x3c\/span\x3e partical.animating == \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e);\n\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e childList = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.childList;\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e childListLength = childList.length;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e rotate = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.rotate;\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e spread = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.spread;\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e delayRange = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.delayRange;\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e power = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.power;\n        \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 每有一个未执行动画的粒子，执行一次动画\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e partical \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e unAnimateList){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(boomNums \x26gt;= \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.particalNumbers) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e ;\n            \n            boomNums\x2b\x2b;\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e r = \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.random();\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置粒子父容器\x3c\/span\x3e\n            partical.renderIn(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.con);\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 随机选择粒子的slot内容\x3c\/span\x3e\n            partical.insertChild(childList[\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.floor(r * childListLength)].cloneNode(\x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e));\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 执行动画，在输入范围内随机角度、力度、延迟\x3c\/span\x3e\n            partical.animate({\n                \x3cspan class=\x22hljs-attr\x22\x3edeg\x3c\/span\x3e: (r * spread \x2b rotate) % \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-attr\x22\x3epow\x3c\/span\x3e: r * power \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e,\n                \x3cspan class=\x22hljs-attr\x22\x3edelay\x3c\/span\x3e: r * delayRange,\n            });\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 如果粒子树木不够，则再次创建，防止下次不够用\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(boomNums \x26lt; \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.particalNumbers){\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.createParticals(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.particalNumbers - boomNums);\n        }\n    }\n}\n\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e Boom;\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e使用demo\x3c\/h5\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\nlet boomChildList = [];\n\n\nfor(let i = 0 ; i \x3c 10; i\x2b\x2b){\n    let tempDom = document.createElement(\x26quot;div\x26quot;);\n    tempDom.className = \x26quot;demoDom\x26quot;;\n    tempDom.innerHTML = i;\n    boomChildList.push(tempDom);\n}\n\nlet boom = new Boom({\n    childList: boomChildList,\n    boomNumber: 6,\n    rotate: 0,\n    spread: 360,\n    delayRange: 100,\n    power: 3,\n});\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs mipsasm\x22\x3e\x3ccode\x3e\nlet \x3cspan class=\x22hljs-keyword\x22\x3eboomChildList \x3c\/span\x3e= []\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\n\nfor(let i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e; i \x26lt; 10; i\x2b\x2b){\x3c\/span\x3e\n    let tempDom = document.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22div\x22\x3c\/span\x3e)\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n    tempDom.className = \x3cspan class=\x22hljs-string\x22\x3e\x22demoDom\x22\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n    tempDom.innerHTML = i\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eboomChildList.push(tempDom);\n\x3c\/span\x3e}\n\nlet \x3cspan class=\x22hljs-keyword\x22\x3eboom \x3c\/span\x3e= new \x3cspan class=\x22hljs-keyword\x22\x3eBoom({\n\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e    childList:\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eboomChildList,\n\x3c\/span\x3e\x3cspan class=\x22hljs-symbol\x22\x3e    boomNumber:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e6\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    rotate:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    spread:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    delayRange:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e,\n\x3cspan class=\x22hljs-symbol\x22\x3e    power:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e,\n})\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e代码资源\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/pan.baidu.com\/s\/1qBMZ12GuL71Ah_4dM7TBcQ\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e源码网盘链接\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e组件效果预览\x3c\/h2\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbiJGO?w=352\x26amp;h=640\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbiJGO?w=352\x26amp;h=640\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader10\x22\x3e结尾\x3c\/h2\x3e\n\x3cp\x3e，可能效果中实现的思维还有不妥和欠缺，欢迎各位大大提出宝贵意见，互相交流、学习！\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>原生JS实现DOM粒子爆炸效果</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016818603">https://segmentfault.com/a/1190000016818603</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/vor6r3vuvqc/" target="_blank">https://alili.tech/archive/vor6r3vuvqc/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>