<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="小程序云开发初探"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>小程序云开发初探 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/ndlmy1qb0t/",
				"appid": "1613049289050283", 
				"title": "小程序云开发初探 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-15T02:30:44"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/a389msrmfwv/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/lh4tj7epycq/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f&text=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f&text=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f&is_video=false&description=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fndlmy1qb0t%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e4%ba%91%e5%bc%80%e5%8f%91%e5%88%9d%e6%8e%a2"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">小程序云开发初探</h1><div class="meta"><div class="postdate"><time datetime="2019-02-15" itemprop="datePublished">2019-02-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e云开发是微信平台新开放的功能，为开发者提供集成了服务器，数据库和资源存储的云服务。本文将基于官方文档，以一个小例子来作为探索云开发的相关功能。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/developers.weixin.qq.com\/miniprogram\/dev\/wxcloud\/basis\/getting-started.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e云开发官方文档\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e一、新建云开发项目\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e新建项目\x3c\/h3\x3e\n\x3cp\x3e将微信开发助手更新之后，选择云开发模板。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775913\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775913\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e项目目录\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775914\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775914\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e项目目录分为了2大块内容：cloudfunctions（云函数）和miniprogram。miniprogram存放的是和普通开发相同的业务代码和资源，cloudfunctions中则存放了可以上传至云端的代码，在云开发中被称为云函数。\x3cbr\x3e云开发模板建立之后，会带有一些相关例子可以熟悉api。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e二、控制台\x3c\/h3\x3e\n\x3cp\x3e微信开发者工具更新之后，在工具栏上会有一个控制台入口，点击可出现以下面板，可查看相关数据情况。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775915\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775915\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e概览\x3c\/h4\x3e\n\x3cp\x3e概览界面如上图所示，展示了该 云开发项目下使用云资源的统计数据。\x3c\/p\x3e\n\x3ch4\x3e用户管理\x3c\/h4\x3e\n\x3cp\x3e凡是访问过云项目的用户，都会在用户管理下留有访问记录。前提是该小程序在\x3ccode\x3eapp.js\x3c\/code\x3e中设置\x3ccode\x3etraceUser:true\x3c\/code\x3e，表示允许记录用户信息。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    wx.cloud.init({\n        env:\x27......\x27,\n        traceUser: true,\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    wx.cloud.init({\n        \x3cspan class=\x22hljs-attr\x22\x3eenv\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27......\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-attr\x22\x3etraceUser\x3c\/span\x3e: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e,\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e数据库\x3c\/h4\x3e\n\x3cp\x3e数据库是控制台中最常用的功能之一，在该界面下，可以快速建立数据集合，可以理解为数据表。可在控制台中建立新的集合，添加记录有三种方式：控制台手动添加、文件导入以及调用api。调用api会在每条记录中自动插入用户_openid。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775916\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775916\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e存储管理\x3c\/h4\x3e\n\x3cp\x3e存储管理可保存小程序端上传的文件，可通过调用api进行上传，上传名称和路径需要自己定义。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775917\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775917\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e云函数\x3c\/h4\x3e\n\x3cp\x3e云函数对cloudfunctions中上传的函数进行管理，可进行调试，查看调用日志等信息。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775918\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775918\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775919\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775919\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e云函数添加方式有2种，可视化添加与IDE添加，可视化添加的云函数直接上传至了云端，IDE中添加需要上传部署才可以调用。如果要删除云函数，在控制台删除之后，IDE中同步云函数列表即可。\x3c\/p\x3e\n\x3ch4\x3e统计分析\x3c\/h4\x3e\n\x3cp\x3e统计分析对云服务的调用情况有针对得给出了数据。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775920\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775920\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e三、环境配置\x3c\/h3\x3e\n\x3cp\x3eapi会在每条记录中自动插入用户_openid。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775921\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775921\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e项目初始化需要在\x3ccode\x3eapp.js\x3c\/code\x3e中进行配置，\x3ccode\x3eenv\x3c\/code\x3e中填写的就是自主配置的环境ID。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    wx.cloud.init({\n        env:\x27mina-cloud-test001\x27\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    wx.cloud.init({\n        \x3cspan class=\x22hljs-attr\x22\x3eenv\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27mina-cloud-test001\x27\x3c\/span\x3e\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e四、实际应用\x3c\/h3\x3e\n\x3cp\x3e本例以上传书籍信息为实际应用，实现基本的书籍信息增删改查功能，以及图片的上传删除。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775922\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775922\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000016775923\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000016775923\x22 alt=\x22enter image description here\x22 title=\x22enter image description here\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e读取数据库数据\x3c\/h4\x3e\n\x3cp\x3e先通过调用wx.cloud.database();获取数据库所有集合，然后通过查询具体集合的方式获取数据。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    const db = wx.cloud.database();\n    const _ = db.command;\n    \n    db.collection(\x27bookList\x27).get().then(res =\x3e {\n        console.log(\x27get\x27, res)\n        self.setData({\n            bookList: res.data\n        });\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e db = wx.cloud.database();\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e _ = db.command;\n    \n    db.collection(\x3cspan class=\x22hljs-string\x22\x3e\x27bookList\x27\x3c\/span\x3e).get().then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27get\x27\x3c\/span\x3e, res)\n        self.setData({\n            \x3cspan class=\x22hljs-attr\x22\x3ebookList\x3c\/span\x3e: res.data\n        });\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e增加数据\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    const db = wx.cloud.database();\n    const _ = db.command;\n    \n    db.collection(\x27bookList\x27).add({\n        data: {\n          bookMes: self.data.bookMes\n        }\n    }).then(res =\x3e {\n        console.log(res)         \n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e db = wx.cloud.database();\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e _ = db.command;\n    \n    db.collection(\x3cspan class=\x22hljs-string\x22\x3e\x27bookList\x27\x3c\/span\x3e).add({\n        \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: {\n          \x3cspan class=\x22hljs-attr\x22\x3ebookMes\x3c\/span\x3e: self.data.bookMes\n        }\n    }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(res)         \n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e删除数据\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    db.collection(\x27bookList\x27).doc(id).remove().then(res =\x3e {\n        console.log(res)\n        wx.showToast({\n            title: \x27删除成功！\x27,\n        })\n        self.getBook();\n        }).catch(err =\x3e {\n            console.log(\x27err\x27, res)\n        })\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    db.collection(\x3cspan class=\x22hljs-string\x22\x3e\x27bookList\x27\x3c\/span\x3e).doc(id).remove().then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(res)\n        wx.showToast({\n            \x3cspan class=\x22hljs-attr\x22\x3etitle\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27删除成功！\x27\x3c\/span\x3e,\n        })\n        self.getBook();\n        }).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27err\x27\x3c\/span\x3e, res)\n        })\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e增加数据\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    const db = wx.cloud.database();\n    const _ = db.command;\n    \n    db.collection(\x27bookList\x27).doc(id).remove().then(res =\x3e {\n        console.log(res)\n        }).catch(err =\x3e {\n            console.log(\x27err\x27, res)\n        })\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e db = wx.cloud.database();\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e _ = db.command;\n    \n    db.collection(\x3cspan class=\x22hljs-string\x22\x3e\x27bookList\x27\x3c\/span\x3e).doc(id).remove().then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(res)\n        }).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27err\x27\x3c\/span\x3e, res)\n        })\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e改变数据\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    const db = wx.cloud.database();\n    const _ = db.command\n\n    db.collection(\x27bookList\x27).doc(self.data.currentId).update({\n        data: {\n          bookMes:self.data.bookMes\n        }\n    }).then(res=\x3e{\n        console.log(\x27update\x27,res)\n        self.getBook();\n    }).catch(console.error)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e db = wx.cloud.database();\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e _ = db.command\n\n    db.collection(\x3cspan class=\x22hljs-string\x22\x3e\x27bookList\x27\x3c\/span\x3e).doc(self.data.currentId).update({\n        \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: {\n          \x3cspan class=\x22hljs-attr\x22\x3ebookMes\x3c\/span\x3e:self.data.bookMes\n        }\n    }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27update\x27\x3c\/span\x3e,res)\n        self.getBook();\n    }).catch(\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.error)\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e查询数据\x26amp;调用云函数\x3c\/h4\x3e\n\x3cp\x3e查询数据采用云函数为例\x3c\/p\x3e\n\x3cp\x3e先在云函数中定义查询函数，每个需要调用云开发api的云函数都必须使用\x3ccode\x3ewx-server-sdk\x3c\/code\x3e，当新创建一个云函数时，项目会提示是否需要使用依赖，选择是则会自动安装\x3ccode\x3ewx-server-sdk\x3c\/code\x3e。\x3cbr\x3e函数中的\x3ccode\x3eevent\x3c\/code\x3e参数代表由小程序端传递过来的参数，除此之外默认包含了\x3ccode\x3euserInfo\x3c\/code\x3e，可用来做用户鉴权操作。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    \/\/云函数入口文件\n    const cloud = require(\x27wx-server-sdk\x27)\n    cloud.init()\n    const db = cloud.database()\n    const _ = db.command\n    \n    \/\/云函数函数入口\n    exports.main = async (event, context) =\x3e {\n        return db.collection(\x27bookList\x27).where({\n            \x27bookMes.name\x27: _.eq(event.bookMes.name),\n            \x27bookMes.chooseTags\x27:_.in(event.bookMes.chooseTags)\n    }).get({\n        success:function(res){\n          return res\n        }\n      })\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-comment\x22\x3e\/\/云函数入口文件\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e cloud = \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27wx-server-sdk\x27\x3c\/span\x3e)\n    cloud.init()\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e db = cloud.database()\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e _ = db.command\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/云函数函数入口\x3c\/span\x3e\n    exports.main = \x3cspan class=\x22hljs-keyword\x22\x3easync\x3c\/span\x3e (event, context) =\x26gt; {\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e db.collection(\x3cspan class=\x22hljs-string\x22\x3e\x27bookList\x27\x3c\/span\x3e).where({\n            \x3cspan class=\x22hljs-string\x22\x3e\x27bookMes.name\x27\x3c\/span\x3e: _.eq(event.bookMes.name),\n            \x3cspan class=\x22hljs-string\x22\x3e\x27bookMes.chooseTags\x27\x3c\/span\x3e:_.in(event.bookMes.chooseTags)\n    }).get({\n        \x3cspan class=\x22hljs-attr\x22\x3esuccess\x3c\/span\x3e:\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e)\x3c\/span\x3e{\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e res\n        }\n      })\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e小程序端引用云函数，\x3ccode\x3ename\x3c\/code\x3e为云函数文件夹的名称，\x3ccode\x3edata\x3c\/code\x3e中存放的是传递给云函数的参数，云函数通过\x3ccode\x3eevent\x3c\/code\x3e获取：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    wx.cloud.callFunction({\n        name: \x27searchBook\x27,\n        \/\/ 传给云函数的参数\n        data: {\n            bookMes: self.data.bookMes\n        }\n    }).then(res =\x3e {\n        console.log(\x27search\x27,res.result.data)\n        self.setData({\n            bookList:res.result.data\n        })\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    wx.cloud.callFunction({\n        \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27searchBook\x27\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 传给云函数的参数\x3c\/span\x3e\n        data: {\n            \x3cspan class=\x22hljs-attr\x22\x3ebookMes\x3c\/span\x3e: self.data.bookMes\n        }\n    }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27search\x27\x3c\/span\x3e,res.result.data)\n        self.setData({\n            \x3cspan class=\x22hljs-attr\x22\x3ebookList\x3c\/span\x3e:res.result.data\n        })\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e本文中的api使用方式仅为示例，实际上服务端的api比小程序端的api丰富，实现功能更多。建议设计文件存储、数据库增删改查的操作都在云函数中进行。\x3c\/p\x3e\n\x3ch4\x3e上传图片\x3c\/h4\x3e\n\x3cp\x3e上传图片需要先调用\x3ccode\x3ewx.chooseImage\x3c\/code\x3e返回的\x3ccode\x3efilePath\x3c\/code\x3e参数，然后自主定义\x3ccode\x3ecloudPath\x3c\/code\x3e，即上传至云端的地址。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    choose() {\n        let self = this\n        wx.chooseImage({\n            count: 1, \/\/ 默认9\n            sizeType: [\x27original\x27, \x27compressed\x27], \/\/ 可以指定是原图还是压缩图，默认二者都有\n            sourceType: [\x27album\x27, \x27camera\x27], \/\/ 可以指定来源是相册还是相机，默认二者都有\n            success: function (res) {\n            \/\/ console.log(res.tempFilePaths[0])\n            \/\/ 返回选定照片的本地文件路径列表，tempFilePath可以作为img标签的src属性显示图片\n                self.setData({\n                    bookPic: res.tempFilePaths[0]\n                })\n            }\n        })\n    }，\n    upload(){\n        let self = this\n        const filePath = self.data.bookPic\n        let myDate = new Date();\n        let time = \x27\x27 \x2b myDate.getFullYear() \x2b (myDate.getMonth() \x2b 1) \x2b myDate.getDate() \x2b myDate.getHours() \x2b myDate.getMinutes() \x2b myDate.getSeconds();\n        const cloudPath = \x27book-image\x27 \x2b time \x2b filePath.match(\/\\.[^.]\x2b?$\/)[0];\n    \n        return wx.cloud.uploadFile({\n            cloudPath,\n            filePath,\n        }).then(res =\x3e {\n            console.log(\x27upload\x27, res)\n            let bookMes = self.data.bookMes;\n            bookMes.bookPic = res.fileID;\n            return self.setData({\n                bookMes\n            });\n        }).catch(err =\x3e {\n            console.log(\x27error\x27,err)\n        })\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    choose() {\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e self = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n        wx.chooseImage({\n            \x3cspan class=\x22hljs-attr\x22\x3ecount\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 默认9\x3c\/span\x3e\n            sizeType: [\x3cspan class=\x22hljs-string\x22\x3e\x27original\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27compressed\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 可以指定是原图还是压缩图，默认二者都有\x3c\/span\x3e\n            sourceType: [\x3cspan class=\x22hljs-string\x22\x3e\x27album\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27camera\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 可以指定来源是相册还是相机，默认二者都有\x3c\/span\x3e\n            success: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e) \x3c\/span\x3e{\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ console.log(res.tempFilePaths[0])\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回选定照片的本地文件路径列表，tempFilePath可以作为img标签的src属性显示图片\x3c\/span\x3e\n                self.setData({\n                    \x3cspan class=\x22hljs-attr\x22\x3ebookPic\x3c\/span\x3e: res.tempFilePaths[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]\n                })\n            }\n        })\n    }，\n    upload(){\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e self = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e filePath = self.data.bookPic\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e myDate = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eDate\x3c\/span\x3e();\n        \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e time = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e \x2b myDate.getFullYear() \x2b (myDate.getMonth() \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) \x2b myDate.getDate() \x2b myDate.getHours() \x2b myDate.getMinutes() \x2b myDate.getSeconds();\n        \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e cloudPath = \x3cspan class=\x22hljs-string\x22\x3e\x27book-image\x27\x3c\/span\x3e \x2b time \x2b filePath.match(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\.[^.]\x2b?$\/\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n    \n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e wx.cloud.uploadFile({\n            cloudPath,\n            filePath,\n        }).then(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27upload\x27\x3c\/span\x3e, res)\n            \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e bookMes = self.data.bookMes;\n            bookMes.bookPic = res.fileID;\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e self.setData({\n                bookMes\n            });\n        }).catch(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e,err)\n        })\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3e删除图片\x3c\/h4\x3e\n\x3cp\x3e删除图片或其他文件需要具体的fileId，可通过查询得到，通过该fileID进行删除。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    wx.cloud.deleteFile({\n        fileList: [fileId],\n        success: res =\x3e {\n            console.log(\x27delete\x27, res.fileList)\n        },\n        fail: err =\x3e {\n            console.log(\x27deleteE\x27, err)\n        }\n    })\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    wx.cloud.deleteFile({\n        \x3cspan class=\x22hljs-attr\x22\x3efileList\x3c\/span\x3e: [fileId],\n        \x3cspan class=\x22hljs-attr\x22\x3esuccess\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eres\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27delete\x27\x3c\/span\x3e, res.fileList)\n        },\n        \x3cspan class=\x22hljs-attr\x22\x3efail\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eerr\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x27deleteE\x27\x3c\/span\x3e, err)\n        }\n    })\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e五、发现存在的问题\x3c\/h3\x3e\n\x3cp\x3e在实际写例子的过程中，也发现了一些问题，因为云开发的功能开放不久，功能并不是很完善，总结了一些发现的小问题：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e数据库暂不支持模糊查询\x3c\/li\x3e\n\x3cli\x3e数据库集合之间无法关联\x3c\/li\x3e\n\x3cli\x3e上传图片如果cloudPath和之前的图片一致的话，返回结果虽然现实成功，但实际替换成了之前的旧图\x3c\/li\x3e\n\x3cli\x3eglobalData定义方法发生改变，无法与onLaunch同级进行定义。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e六、结语\x3c\/h3\x3e\n\x3cp\x3e关于云开发，官方文档给出的说明比较详细，仔细阅读文档可以较快速得实现上手应用。但由于目前其功能的局限性，较为复杂的公司业务不适合采用该模式进行开发，适合个人小型业务采用。\x3cbr\x3e上文中如有不尽不实之处，欢迎指出修改，谢谢！ヾ(=･ω･=)o\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e广而告之\x3c\/h2\x3e\n\x3cp\x3e本文发布于\x3ca href=\x22https:\/\/github.com\/BooheeFE\/weekly\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e薄荷前端周刊\x3c\/a\x3e，欢迎Watch \x26amp; Star ★，转载请注明出处。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e欢迎讨论，点个赞再走吧  ｡◕‿◕｡ ～\x3c\/h3\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>小程序云开发初探</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016775910">https://segmentfault.com/a/1190000016775910</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/ndlmy1qb0t/" target="_blank">https://alili.tech/archive/ndlmy1qb0t/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>