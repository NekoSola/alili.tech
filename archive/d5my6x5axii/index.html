<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Vue 源码解析之一：transition"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Vue 源码解析之一：transition | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/d5my6x5axii/",
				"appid": "1613049289050283", 
				"title": "Vue 源码解析之一：transition | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-12T02:30:12"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/uxsgax9sgi/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/49we3itqvll/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f&text=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f&text=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f&title=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f&is_video=false&description=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f&title=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f&title=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f&title=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd5my6x5axii%2f&title=Vue%20%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e4%b9%8b%e4%b8%80%ef%bc%9atransition"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Vue 源码解析之一：transition</h1><div class="meta"><div class="postdate"><time datetime="2019-02-12" itemprop="datePublished">2019-02-12</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e最近公司的项目选型使用了vue，所以用vue开发了一个项目，期间在处理一些动画的时候，发现vue-transition虽然用起来简单，但是局限性很大，比如无法处理一个组件中父子元素的联动动画。这就极大得限制了我们的发挥，你只能进行单层次的动画，类似modal这种两种动画联动的就很难做，你很可能需要分成两个组件来做，这就不符合组件化的原则。\x3c\/p\x3e\n\x3cp\x3e所以打算研读一下源码，然后研究一下如何解决这个问题。\x3c\/p\x3e\n\x3cp\x3e既然是看transition，那么首先就得狙击\x3ccode\x3etransition\x3c\/code\x3e指令，然后\x3ccode\x3etransition\x3c\/code\x3e指令代码如此简单：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ (\/src\/directives\/internal\/transition.js)\n\nexport default {\n\n  priority: TRANSITION,\n\n  update (id, oldId) {\n    var el = this.el\n    \/\/ resolve on owner vm\n    var hooks = resolveAsset(this.vm.$options, \x27transitions\x27, id)\n    id = id || \x27v\x27\n    \/\/ apply on closest vm\n    el.__v_trans = new Transition(el, id, hooks, this.el.__vue__ || this.vm)\n    if (oldId) {\n      removeClass(el, oldId \x2b \x27-transition\x27)\n    }\n    addClass(el, id \x2b \x27-transition\x27)\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vim\x22\x3e\x3ccode class=\x22javscript\x22\x3e\/\/ (\/src\/directives\/internal\/transition.js)\n\nexport default {\n\n  priority: TRANSITION,\n\n  \x3cspan class=\x22hljs-keyword\x22\x3eupdate\x3c\/span\x3e (id, oldId) {\n    var \x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e = this.\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e\n    \/\/ \x3cspan class=\x22hljs-built_in\x22\x3eresolve\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e owner \x3cspan class=\x22hljs-keyword\x22\x3evm\x3c\/span\x3e\n    var hooks = resolveAsset(this.\x3cspan class=\x22hljs-keyword\x22\x3evm\x3c\/span\x3e.$\x3cspan class=\x22hljs-keyword\x22\x3eoptions\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27transitions\x27\x3c\/span\x3e, id)\n    id = id || \x3cspan class=\x22hljs-string\x22\x3e\x27v\x27\x3c\/span\x3e\n    \/\/ apply \x3cspan class=\x22hljs-keyword\x22\x3eon\x3c\/span\x3e closest \x3cspan class=\x22hljs-keyword\x22\x3evm\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e.__v_trans = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Transition(\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e, id, hooks, this.\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e.__vue__ || this.\x3cspan class=\x22hljs-keyword\x22\x3evm\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (oldId) {\n      removeClass(\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e, oldId \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27-transition\x27\x3c\/span\x3e)\n    }\n    addClass(\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e, id \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27-transition\x27\x3c\/span\x3e)\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在这里我们指令在\x3ccode\x3eel\x3c\/code\x3e上加上了一个\x3ccode\x3e__v_trans\x3c\/code\x3e属性，这个属性是一个\x3ccode\x3eTransition\x3c\/code\x3e的实例，所以我们去看看这个实例干了什么\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ (\/src\/transition\/transition.js)\n\nexport default function Transition (el, id, hooks, vm) {\n    ...\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ (\/src\/transition\/transition.js)\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3edefault\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eTransition\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eel, id, hooks, vm\x3c\/span\x3e) \x3c\/span\x3e{\n    ...\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这就是一个保存这个过渡动画应该包含的一些属性和钩子，我们还是不知道什么时候通过什么方法调用了动画\x3c\/p\x3e\n\x3cp\x3e这时候我回头去看了vue的文档，在transition的介绍里有这么一句：\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3etransition 特性可以与下面资源一起用：\x3c\/p\x3e\n\x3cp\x3ev-if\x3cbr\x3ev-show\x3cbr\x3ev-for （只为插入和删除触发）\x3cbr\x3e动态组件 （介绍见组件）\x3cbr\x3e在组件的根节点上，并且被 Vue 实例 DOM 方法（如 vm.$appendTo(el)）触发。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e这时候我就怀疑只有特定的场景才能触发transition，而触发的关键就在这些指令里面，于是我就去看\x3ccode\x3ev-if\x3c\/code\x3e指令，然后在他插入节点的时候发现了这一句代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22this.frag = this.factory.create(this._host, this._scope, this._frag)\nthis.frag.before(this.anchor)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.frag = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.factory.create(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._host, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._scope, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._frag)\n\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.frag.before(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.anchor)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个\x3ccode\x3efactory\x3c\/code\x3e是什么？，接着找\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22this.elseFactory = new FragmentFactory(this.vm, next)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gradle\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.elseFactory = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e FragmentFactory(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.vm, \x3cspan class=\x22hljs-keyword\x22\x3enext\x3c\/span\x3e)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e他是一个\x3ccode\x3eFragmentFactory\x3c\/code\x3e，在这个\x3ccode\x3eFragmentFactory\x3c\/code\x3e里面我看到了这一个方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function singleBefore (target, withTransition) {\n  this.inserted = true\n  var method = withTransition !== false\n    ? beforeWithTransition\n    : before\n  method(this.node, target, this.vm)\n  if (inDoc(this.node)) {\n    this.callHook(attach)\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs aspectj\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3efunction \x3cspan class=\x22hljs-title\x22\x3esingleBefore\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e, withTransition)\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.inserted = \x3cspan class=\x22hljs-keyword\x22\x3etrue\x3c\/span\x3e\n  var method = withTransition !== \x3cspan class=\x22hljs-keyword\x22\x3efalse\x3c\/span\x3e\n    ? beforeWithTransition\n    : before\n  method(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.node, \x3cspan class=\x22hljs-keyword\x22\x3etarget\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.vm)\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (inDoc(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.node)) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.callHook(attach)\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e貌似看到了一些曙光，我们终于看到跟transition有关的东西，这里我们继续找到\x3ccode\x3ebeforeWithTransition\x3c\/code\x3e这个方法，代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export function beforeWithTransition (el, target, vm, cb) {\n  applyTransition(el, 1, function () {\n    before(el, target)\n  }, vm, cb)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vim\x22\x3e\x3ccode\x3eexport \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ebeforeWithTransition\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e(el, target, vm, cb)\x3c\/span\x3e {\x3c\/span\x3e\n  applyTransition(\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e {\x3c\/span\x3e\n    before(\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e, target)\n  }, \x3cspan class=\x22hljs-keyword\x22\x3evm\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ecb\x3c\/span\x3e)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里调用了applyTransition，代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22export function applyTransition (el, direction, op, vm, cb) {\n  var transition = el.__v_trans\n  if (\n    !transition ||\n    \/\/ skip if there are no js hooks and CSS transition is\n    \/\/ not supported\n    (!transition.hooks \x26amp;\x26amp; !transitionEndEvent) ||\n    \/\/ skip transitions for initial compile\n    !vm._isCompiled ||\n    \/\/ if the vm is being manipulated by a parent directive\n    \/\/ during the parent\x27s compilation phase, skip the\n    \/\/ animation.\n    (vm.$parent \x26amp;\x26amp; !vm.$parent._isCompiled)\n  ) {\n    op()\n    if (cb) cb()\n    return\n  }\n  var action = direction \x3e 0 ? \x27enter\x27 : \x27leave\x27\n  transition[action](op, cb)\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eexport\x3c\/span\x3e \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eapplyTransition\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eel, direction, op, vm, cb\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e transition = el.__v_trans\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\n    !transition ||\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ skip if there are no js hooks and CSS transition is\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ not supported\x3c\/span\x3e\n    (!transition.hooks \x26amp;\x26amp; !transitionEndEvent) ||\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ skip transitions for initial compile\x3c\/span\x3e\n    !vm._isCompiled ||\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ if the vm is being manipulated by a parent directive\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ during the parent\x27s compilation phase, skip the\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ animation.\x3c\/span\x3e\n    (vm.$\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e \x26amp;\x26amp; !vm.$\x3cspan class=\x22hljs-built_in\x22\x3eparent\x3c\/span\x3e._isCompiled)\n  ) {\n    op()\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (cb) cb()\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e action = direction \x26gt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ? \x3cspan class=\x22hljs-string\x22\x3e\x27enter\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27leave\x27\x3c\/span\x3e\n  transition[action](op, cb)\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在这里我们终于看到了\x3ccode\x3eel.__v_trans\x3c\/code\x3e这个属性，那么这个回路基本就算走完了。\x3c\/p\x3e\n\x3cp\x3e然后我去看了一下\x3ccode\x3ev-show\x3c\/code\x3e指令，于是发现，还有更简单的方法。。。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22apply (el, value) {\n    if (inDoc(el)) {\n      applyTransition(el, value ? 1 : -1, toggle, this.vm)\n    } else {\n      toggle()\n    }\n    function toggle () {\n      el.style.display = value ? \x27\x27 : \x27none\x27\n    }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs vim\x22\x3e\x3ccode\x3eapply (\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e, value) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (inDoc(\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e)) {\n      applyTransition(\x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e, value ? \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e : -\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, toggle, this.\x3cspan class=\x22hljs-keyword\x22\x3evm\x3c\/span\x3e)\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      toggle()\n    }\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etoggle\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e {\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3eel\x3c\/span\x3e.style.\x3cspan class=\x22hljs-keyword\x22\x3edisplay\x3c\/span\x3e = value ? \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e : \x3cspan class=\x22hljs-string\x22\x3e\x27none\x27\x3c\/span\x3e\n    }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e直接\x3ccode\x3eapplyTransition\x3c\/code\x3e就可以调用了\x3c\/p\x3e\n\x3cp\x3e现在我们知道为什么\x3ccode\x3ev-transition\x3c\/code\x3e是只能单点的了，因为本质上他只能作用于特定指令所影响的特定元素，他的实现方式并不是类似于react的\x3ccode\x3eTransitionGroup\x3c\/code\x3e这样通过给子组件增加生命周期在通过子组件在生命周期自定义动画的方式，vue的局限性表露无遗，让我觉得很奇怪作者为什么选择这种方式，难道真的只是为了降低使用难度？\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e问题提出来了，就得想办法了\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e我得想想。。。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Vue 源码解析之一：transition</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000004670036">https://segmentfault.com/a/1190000004670036</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/d5my6x5axii/" target="_blank">https://alili.tech/archive/d5my6x5axii/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>