<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="在Vue中如何使用axios请求拦截"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>在Vue中如何使用axios请求拦截 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/nn5no7dmupi/",
				"appid": "1613049289050283", 
				"title": "在Vue中如何使用axios请求拦截 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-15T02:30:44"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/8pqzn2bdkaf/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/4ph000y4vox/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f&text=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f&text=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f&title=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f&is_video=false&description=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f&title=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f&title=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f&title=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fnn5no7dmupi%2f&title=%e5%9c%a8Vue%e4%b8%ad%e5%a6%82%e4%bd%95%e4%bd%bf%e7%94%a8axios%e8%af%b7%e6%b1%82%e6%8b%a6%e6%88%aa"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">在Vue中如何使用axios请求拦截</h1><div class="meta"><div class="postdate"><time datetime="2019-02-15" itemprop="datePublished">2019-02-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e\x3cstrong\x3e一、前言\x3c\/strong\x3e\x3c\/h1\x3e\n\x3ch4\x3eaxios的基础使用就不过多的讲解啦，如何使用可以看axios文档\x3ca href=\x22https:\/\/www.kancloud.cn\/yunye\/axios\/234845\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e使用说明·Axios中文说明\x3c\/a\x3e\n\x3c\/h4\x3e\n\x3ch4\x3e在这里和大家分享一下axios拦截在\x3cstrong\x3e实际项目\x3c\/strong\x3e中的使用\x3c\/h4\x3e\n\x3cp\x3e很多人都看过axios的官方文档中拦截器这一栏，有的人可能会有点懵，因为文档只告诉你有这个东西，而不告诉你在什么情况下使用。很多初学者就会放弃使用axios拦截器，毕竟拦截器是可以不使用的，但是使用拦截器，会在页面中减少很多不必要的代码。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e\x3cstrong\x3e二、说在前面的\x3c\/strong\x3e\x3c\/h1\x3e\n\x3ch4\x3e项目使用的ui框架是iview\x3c\/h4\x3e\n\x3cp\x3e以下友好提示均使用iview ui的message提示组件，例如this.$Message.xxx\x3cbr\x3e\/api\/request  仅仅只是例子接口，实际开发用后台提供的接口。\x3cbr\x3ecode是后台状态码，我这里也只是例子，不要问我为毛我的返回码和你的怎么不一样这样的问题哈...这些都需要和后台沟通约定的。\x3cbr\x3e使用的请求头是：axios.defaults.headers[\x27Content-Type\x27] = \x27application\/x-www-form-urlencoded\x27;至于为什么使用这个请求头可以看看我的另外一篇文章\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000016040998\x22\x3e关于axios会发送两次请求，有个OPTIONS请求的问题\x3c\/a\x3e\x3cbr\x3e因为使用的是这个请求头所以需要用\x3cstrong\x3eqs模块\x3c\/strong\x3e，不然后台不认这个数据。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader2\x22\x3e\x3cstrong\x3e三、不使用请求拦截\x3c\/strong\x3e\x3c\/h1\x3e\n\x3ch4\x3e如果不使用请求拦截，也是可以的，但是会多了非常多的代码，我们以登录页为例。\x3c\/h4\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbiAXv?w=427\x26amp;h=337\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbiAXv?w=427\x26amp;h=337\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e一个单纯，没有花里胡哨的页面，|ω・）\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/双向数据绑定获取值\nlet httpRequest = {};\nhttpRequest.loginName = this.loginName\nhttpRequest.password= this.password\n\nthis.$axios.post(\x26quot;\/api\/request\x26quot;, this.$qs.stringify(httpRequest)).then(data =\x3e {\n    \/\/特殊错误处理，状态为10时为登录超时\n    if(data.data.code === 10){\n        this.$Message.error(\x26quot;登录已超时，请重新登录\x26quot;)\n        this.$router.push(\x26quot;\/login\x26quot;)\n    \/\/其余错误状态处理    \n    }else if(data.data.code != 0){\n        this.$Message.error(data.data.msg)\n    \/\/请求成功\n    }else if(data.data.code === 0){\n        \/\/进行成功业务逻辑\n    }\n    \/\/.......\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/双向数据绑定获取值\x3c\/span\x3e\nlet httpRequest = {};\nhttpRequest.loginName = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.loginName\nhttpRequest.password= \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.password\n\n\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$axios.post(\x3cspan class=\x22hljs-string\x22\x3e\x22\/api\/request\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$qs.stringify(httpRequest)).then(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e =\x26gt; {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/特殊错误处理，状态为10时为登录超时\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.code === \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$Message.error(\x3cspan class=\x22hljs-string\x22\x3e\x22登录已超时，请重新登录\x22\x3c\/span\x3e)\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$router.push(\x3cspan class=\x22hljs-string\x22\x3e\x22\/login\x22\x3c\/span\x3e)\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/其余错误状态处理    \x3c\/span\x3e\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.code != \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$Message.error(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.msg)\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/请求成功\x3c\/span\x3e\n    }\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e.code === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/进行成功业务逻辑\x3c\/span\x3e\n    }\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/.......\x3c\/span\x3e\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果不使用请求拦截，那么对每一条请求每一个状态都要特殊处理，如果请求特殊状态有数十个，每个页面有很多请求，那么页面会变得很长很臃肿，不好维护。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e\x3cstrong\x3e三、使用请求拦截\x3c\/strong\x3e\x3c\/h1\x3e\n\x3cp\x3e相同的请求返回代码我们可以抽取出来，写在请求拦截中\x3cbr\x3e当我们设置了拦截之后，在我们的组件代码中可以简化很多，还是以\x3cstrong\x3e登录界面\x3c\/strong\x3e为例：\x3c\/p\x3e\n\x3ch4\x3e在\x3cstrong\x3emain.js\x3c\/strong\x3e中\x3c\/h4\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/请求发送拦截，把数据发送给后台之前做些什么......\naxios.interceptors.request.use((request) =\x3e {\n\n  \/\/这个例子中data是loginName和password\n  let REQUEST_DATA = request.data\n  \/\/统一进行qs模块转换\n  request.data = qs.stringify(REQUEST_DATA)\n  \/\/再发送给后台\n  return request;\n\n}, function (error) {\n  \/\/ Do something with request error\n  return Promise.reject(error);\n});\n\n\/\/请求返回拦截，把数据返回到页面之前做些什么...\naxios.interceptors.response.use((response) =\x3e {\n  \/\/特殊错误处理，状态为10时为登录超时\n  if (response.data.code === 10) {\n    iView.Message.error(\x26quot;登录已超时，请重新登录\x26quot;);\n    router.push(\x26quot;\/login\x26quot;)\n  \/\/其余错误状态处理    \n  } else if (response.data.code != 0) {\n    iView.Message.error(response.data.msg)\n  \/\/请求成功\n  } else if(response.data.code === 0){\n    \/\/将我们请求到的信息返回页面中请求的逻辑\n    return response;\n  }\n \/\/......\n\n}, function (error) {\n  return Promise.reject(error);\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gauss\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/请求发送拦截，把数据发送给后台之前做些什么......\x3c\/span\x3e\naxios.interceptors.request.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e((request) =\x26gt; {\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/这个例子中data是loginName和password\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e REQUEST_DATA = request.data\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/统一进行qs模块转换\x3c\/span\x3e\n  request.data = qs.stringify(REQUEST_DATA)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/再发送给后台\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e request;\n\n}, function (\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Do something with request error\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Promise.reject(\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e);\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/请求返回拦截，把数据返回到页面之前做些什么...\x3c\/span\x3e\naxios.interceptors.response.\x3cspan class=\x22hljs-keyword\x22\x3euse\x3c\/span\x3e((response) =\x26gt; {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/特殊错误处理，状态为10时为登录超时\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (response.data.\x3cspan class=\x22hljs-built_in\x22\x3ecode\x3c\/span\x3e === \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e) {\n    iView.Message.\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22登录已超时，请重新登录\x22\x3c\/span\x3e);\n    router.\x3cspan class=\x22hljs-keyword\x22\x3epush\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22\/login\x22\x3c\/span\x3e)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/其余错误状态处理    \x3c\/span\x3e\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (response.data.\x3cspan class=\x22hljs-built_in\x22\x3ecode\x3c\/span\x3e != \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e) {\n    iView.Message.\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e(response.data.msg)\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/请求成功\x3c\/span\x3e\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(response.data.\x3cspan class=\x22hljs-built_in\x22\x3ecode\x3c\/span\x3e === \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e){\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/将我们请求到的信息返回页面中请求的逻辑\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e response;\n  }\n \x3cspan class=\x22hljs-comment\x22\x3e\/\/......\x3c\/span\x3e\n\n}, function (\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e Promise.reject(\x3cspan class=\x22hljs-built_in\x22\x3eerror\x3c\/span\x3e);\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/双向数据绑定获取值\nlet httpRequest = {};\nhttpRequest.loginName = this.loginName\nhttpRequest.password= this.password\n\nthis.$axios.post(\x26quot;\/api\/request\x26quot;, httpRequest).then(data =\x3e {\n    \/\/这是要先判断data，如果请求的数据状态code不为0,会被拦截，则data为undefined\n    if(data){\n        \/\/进行请求返回成功逻辑\n    }\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/双向数据绑定获取值\x3c\/span\x3e\nlet httpRequest = {};\nhttpRequest.loginName = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.loginName\nhttpRequest.password= \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.password\n\n\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$axios.post(\x3cspan class=\x22hljs-string\x22\x3e\x22\/api\/request\x22\x3c\/span\x3e, httpRequest).then(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e =\x26gt; {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/这是要先判断data，如果请求的数据状态code不为0,会被拦截，则data为undefined\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/进行请求返回成功逻辑\x3c\/span\x3e\n    }\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样我们就对axios请求添加了拦截，可以减少很多代码逻辑，页面可读性更高，可维护性也更高\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3e\x3cstrong\x3e四、其他\x3c\/strong\x3e\x3c\/h1\x3e\n\x3cp\x3e这就是axios拦截的最基础的用法，当然也不止于此，我们也可以进行扩展延伸，做更多的事情，只要你的业务有需求，axios拦截总能帮到你，这些就需要举一反三，工具是死的人是活的，我可以再举个小例子，比如设置\x3cstrong\x3e请求签名\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e请求签名是前台和后台约定的一种沟通方式，对数据进行加密，可以一定程度上保证数据的安全性\x3c\/p\x3e\n\x3cp\x3e还是以这个登录页面为例\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/双向数据绑定获取值\nlet httpRequest = {};\nhttpRequest.loginName = this.loginName\nhttpRequest.password= this.password\n\nthis.$axios.post(\x26quot;\/api\/request\x26quot;, httpRequest).then(data =\x3e {\n    \/\/这是要先判断data，如果请求的数据状态code不为0,会被拦截，则data为undefined\n    if(data){\n        \/\/进行请求返回成功逻辑\n    }\n});\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/双向数据绑定获取值\x3c\/span\x3e\nlet httpRequest = {};\nhttpRequest.loginName = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.loginName\nhttpRequest.password= \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.password\n\n\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.$axios.post(\x3cspan class=\x22hljs-string\x22\x3e\x22\/api\/request\x22\x3c\/span\x3e, httpRequest).then(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e =\x26gt; {\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/这是要先判断data，如果请求的数据状态code不为0,会被拦截，则data为undefined\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3edata\x3c\/span\x3e){\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/进行请求返回成功逻辑\x3c\/span\x3e\n    }\n});\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e我们把httpRequest这个data信息数据发送给后台之前，进行签名，并加密数据\x3cbr\x3e在\x3cstrong\x3emain.js\x3c\/strong\x3e中，我们对发送的数据进行拦截\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/请求发送拦截\naxios.interceptors.request.use((request) =\x3e {\n\n  \/\/获取请求的数据，这里是loginName和password\n  let REQUEST_DATA = request.data\n  \/\/获取请求的地址，这里是\/api\/request\n  let REQUEST_URL = request.url\n   \n  \/\/设置签名并进行qs转换，且赋值给request的data，签名函数另外封装\n  request.data = qs.stringify(requestDataFn(REQUEST_DATA, REQUEST_URL))\n  \/\/发送请求给后台\n  return request;\n\n}, function (error) {\n  \/\/ Do something with request error\n  return Promise.reject(error);\n});\n\n\/\/已封装好的签名函数\nfunction requestDataFn(data, method) {\n\n  let postData = {}\n\n  \/\/时间戳，时间戳函数不作展示，也是已封装好的\n  postData.timestamp = getNowFormatDate();\n\n  \/\/请求用户的session以及secretKey信息,为空是未登录，登录后我把它存在localStorage中，这个存在哪里都可以，这里只作为例子。\n  postData.session = localStorage.getItem(\x27session\x27) || \x27\x27;\n  postData.secretKey = localStorage.getItem(\x27secretKey\x27) || \x27\x27;\n  \n  \/\/请求的地址，这里是\/api\/request\n  postData.method = method;\n    \n  \/\/请求的数据这里是loginName和password，进行base64加密\n  let base64Data = Base64.encode(JSON.stringify(data));\n   \n  \/\/设置签名并进行md5加密\n  let signature = md5.hex(postData.secretKey \x2b base64Data \x2b postData.method \x2b postData.session \x2b postData.timestamp \x2b postData.secretKey);\n   \n  \/\/把数据再次进行加密\n  postData.data = encodeURI(base64Data);\n\n  postData.signature = signature;\n   \n  return postData\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/请求发送拦截\x3c\/span\x3e\naxios.interceptors.request.use(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3erequest\x3c\/span\x3e) =\x26gt;\x3c\/span\x3e {\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取请求的数据，这里是loginName和password\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e REQUEST_DATA = request.data\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/获取请求的地址，这里是\/api\/request\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e REQUEST_URL = request.url\n   \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置签名并进行qs转换，且赋值给request的data，签名函数另外封装\x3c\/span\x3e\n  request.data = qs.stringify(requestDataFn(REQUEST_DATA, REQUEST_URL))\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/发送请求给后台\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e request;\n\n}, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eerror\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ Do something with request error\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ePromise\x3c\/span\x3e.reject(error);\n});\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/已封装好的签名函数\x3c\/span\x3e\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erequestDataFn\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata, method\x3c\/span\x3e) \x3c\/span\x3e{\n\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e postData = {}\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/时间戳，时间戳函数不作展示，也是已封装好的\x3c\/span\x3e\n  postData.timestamp = getNowFormatDate();\n\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/请求用户的session以及secretKey信息,为空是未登录，登录后我把它存在localStorage中，这个存在哪里都可以，这里只作为例子。\x3c\/span\x3e\n  postData.session = localStorage.getItem(\x3cspan class=\x22hljs-string\x22\x3e\x27session\x27\x3c\/span\x3e) || \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n  postData.secretKey = localStorage.getItem(\x3cspan class=\x22hljs-string\x22\x3e\x27secretKey\x27\x3c\/span\x3e) || \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e;\n  \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/请求的地址，这里是\/api\/request\x3c\/span\x3e\n  postData.method = method;\n    \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/请求的数据这里是loginName和password，进行base64加密\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e base64Data = Base64.encode(\x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.stringify(data));\n   \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/设置签名并进行md5加密\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e signature = md5.hex(postData.secretKey \x2b base64Data \x2b postData.method \x2b postData.session \x2b postData.timestamp \x2b postData.secretKey);\n   \n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/把数据再次进行加密\x3c\/span\x3e\n  postData.data = \x3cspan class=\x22hljs-built_in\x22\x3eencodeURI\x3c\/span\x3e(base64Data);\n\n  postData.signature = signature;\n   \n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e postData\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样我们就完成了对数据加密以及签名，这样再发送给后台。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e注意：这里只作为例子展示，如果需要用到签名，如何签名，是前台和后台沟通的结果!\x3c\/strong\x3e\x3cbr\x3eaxios请求拦截的用处远远不止这样，具体如何使用，还需要在实际工作，实际项目中随机应变啦。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e\x3cstrong\x3e如果对你有帮助请点赞收藏支持一下，有什么疑问欢迎留言，有错误欢迎大力指出\x3c\/strong\x3e\x3c\/h3\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>在Vue中如何使用axios请求拦截</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016787376">https://segmentfault.com/a/1190000016787376</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/nn5no7dmupi/" target="_blank">https://alili.tech/archive/nn5no7dmupi/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>