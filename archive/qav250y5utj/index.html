<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="CSS 3D Panorama（全景） - 淘宝造物节技术剖析"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>CSS 3D Panorama（全景） - 淘宝造物节技术剖析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qav250y5utj/",
				"appid": "1613049289050283", 
				"title": "CSS 3D Panorama（全景） - 淘宝造物节技术剖析 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-04T02:30:58"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/axkafrehxl5/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/pekr43ipge/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f&text=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f&text=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f&title=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f&is_video=false&description=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f&title=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f&title=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f&title=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqav250y5utj%2f&title=CSS%203D%20Panorama%ef%bc%88%e5%85%a8%e6%99%af%ef%bc%89%20-%20%e6%b7%98%e5%ae%9d%e9%80%a0%e7%89%a9%e8%8a%82%e6%8a%80%e6%9c%af%e5%89%96%e6%9e%90"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">CSS 3D Panorama（全景） - 淘宝造物节技术剖析</h1><div class="meta"><div class="postdate"><time datetime="2019-02-04" itemprop="datePublished">2019-02-04</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e本文转自\x3cstrong\x3e凹凸实验室\x3c\/strong\x3e：\x3ca href=\x22https:\/\/aotu.io\/notes\/2016\/08\/24\/2016-8-24-css-3d-panorama\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/aotu.io\/notes\/2016\/08...\x3c\/a\x3e  \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000011381045\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000011381045\x22 alt=\x22cover.jpg\x22 title=\x22cover.jpg\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e前言\x3c\/h3\x3e\n\x3cp\x3e3D 全景并不是什么新鲜事物了，但以前我们在 Web 上看到的 3D 全景一般是通过 Flash 实现的。若我们能将 \x3ccode\x3eCSS3 Transform\x3c\/code\x3e 的相关知识运用得当，也是能实现类似的效果。换句话说，3D 全景其实就是 CSS3 3D 的应用场景之一。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e准备\x3c\/h3\x3e\n\x3cp\x3e在实现 CSS3 3D 全景之前，我们先理清部分 CSS3 Transform 相关的属性：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/developer.mozilla.org\/zh-CN\/docs\/Web\/CSS\/transform-origin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etransform-origin\x3c\/a\x3e：元素变形的原点（默认值为 50% 50% 0，该数值和后续提及的百分比默认均基于元素自身的宽高算出具体数值）；\x3c\/li\x3e\n\x3cli\x3e\n\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/CSS\/transform-style\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etransform-style\x3c\/a\x3e：为子元素提供 2D 还是 3D 的场景。另外，该属性是非继承的；\x3c\/li\x3e\n\x3cli\x3e\n\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/CSS\/transform\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3etransform\x3c\/a\x3e：修改 CSS 可视化模型的坐标空间，包括 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/CSS\/transform-function\/translate3d\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e平移（translate）\x3c\/a\x3e、\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/CSS\/transform-function\/rotate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e旋转（rotate）\x3c\/a\x3e、\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/CSS\/transform-function\/scale\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e缩放（scale）\x3c\/a\x3e 和 \x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/CSS\/transform-function\/skew\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e扭曲（skew）\x3c\/a\x3e。\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e下面我们对上述的一些点进行更深入的分析：\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e对于 \x3ccode\x3eperspective\x3c\/code\x3e，该属性指定了“眼睛”与元素的 \x3ccode\x3eperspective-origin\x3c\/code\x3e（默认值是 \x3ccode\x3e50% 50% 0\x3c\/code\x3e）点的距离。那么问题来了：“当我们以 \x3ccode\x3epx\x3c\/code\x3e 作为衡量单位时，它的实际距离该如何量化呢？”   \x3cbr\x3e答：当屏幕分辨率是 1080P（1920*1080px）且该元素或其祖先元素的 \x3ccode\x3eperspective\x3c\/code\x3e 数值的值为 \x3ccode\x3e1920px\x3c\/code\x3e 时，应用了 CSS3 3D Transform 的子元素的立体效果就相当于我们在距离一个屏幕宽度（1920px）的屏幕前观看该元素时的真实效果。尽管如此，目前笔者也不知道如何准确地为元素设置一个合适的 \x3ccode\x3eperspective\x3c\/code\x3e 值，只能猜测大概值后进行调整，以达到满意的呈现效果。\x3c\/li\x3e\x3c\/ul\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880859?w=680\x26amp;h=465\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880859?w=680\x26amp;h=465\x22 alt=\x22此处输入图片的描述\x22 title=\x22此处输入图片的描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e根据 \x3ca href=\x22https:\/\/zh.wikipedia.org\/wiki\/%E7%9B%B8%E4%BC%BC%E4%B8%89%E8%A7%92%E5%BD%A2\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e相似三角形\x3c\/a\x3e 的性质可计算出被前移的元素最终在屏幕上显示的实际大小  \x3c\/p\x3e\n\x3cp\x3e另外，关于 \x3ccode\x3eperspective\x3c\/code\x3e 还有另外一个重要的点是：因为 \x3ccode\x3eperspective-origin\x3c\/code\x3e 属性的默认值是 \x3ccode\x3e50% 50% 0\x3c\/code\x3e，所以对哪个元素应用 \x3ccode\x3eperspective\x3c\/code\x3e 属性，就决定了“眼睛”的位置（即我们的“眼睛”是在哪个角度看物体）。一般来说，当我们需要正视物体时，就会将该属性设置在与该元素中心重合的\x3cstrong\x3e某一祖先元素\x3c\/strong\x3e上。\x3c\/p\x3e\n\x3cp\x3e再另外，如果说：“如何让一个元素（的背面）不可见？”，你可能会回答 \x3ccode\x3ebackface-visibility:hidden;\x3c\/code\x3e。其实，对于在“眼睛”背后的元素（以元素的 \x3ccode\x3etransform-origin\x3c\/code\x3e 为参考点），即元素的 \x3ccode\x3eZ\x3c\/code\x3e 轴坐标值大于 \x3ccode\x3eperspective\x3c\/code\x3e 的值时，浏览器是不会将其渲染出来的。\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e对于 \x3ccode\x3etransform-style\x3c\/code\x3e，该属性指定了其\x3cstrong\x3e子元素\x3c\/strong\x3e是处于 3D 场景还是 2D 场景。对于 2D 场景，元素的前后位置是按照平时的渲染方式（即若在普通文档流中，同层级元素是按照代码中元素的先后编写顺序，后面的元素会遮住在其前面的元素）；对于 3D 场景，元素的前后位置则按照真实世界的规则排序（即靠近“眼睛”的元素，会遮住离“眼睛”远的元素）。\x3cp\x3e另外，由于 \x3ccode\x3etransform-style\x3c\/code\x3e 属性是非继承的，对于中间节点需要显式设定。\x3c\/p\x3e\n\x3c\/li\x3e\n\x3cli\x3e对于 \x3ccode\x3etransform\x3c\/code\x3e 属性：下图整理了 rotate3d、translate3d 的变换方向：  \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880860?w=423\x26amp;h=424\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880860?w=423\x26amp;h=424\x22 alt=\x22transform\x22 title=\x22transform\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e需要注意的是：transform 中的变换属性的顺序是有关系的，如 translateX(10px) rotate(30deg) 与 rotate(30deg) translateX(10px) 是不等价的。\x3c\/p\x3e\n\x3cp\x3e另外，需要注意的是 scale 中如果有负值，则该方向会产生 180 度的翻转；\x3c\/p\x3e\n\x3cp\x3e再另外，部分 transform 效果会导致元素（字体）模糊，如 translate 的数值存在小数、通过 translateZ 或 scale 放大元素等等。\x3cstrong\x3e每个浏览器都有其不同的表现\x3c\/strong\x3e。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e实现\x3c\/h3\x3e\n\x3cp\x3e上面理清了一些 CSS Transform 相关的知识点，下面就讲讲如何实现 CSS 3D 全景 ：\x3c\/p\x3e\n\x3cp\x3e想象一下，当我们站在十字路口中间，身体旋转 360°，这个过程中所看到的画面就是一幅以你为中心的全景图了。其实，当焦距不变时，我们就等同于站在一个圆柱体的中心。  \x3c\/p\x3e\n\x3cp\x3e但是，虚拟世界与现实世界的最大不同是：没有东西是连续的，即所有东西都是离散的。例如，你无法在屏幕上显示一个完美的圆。你只能以一个正多边形表示圆：边越多，圆就越“完美”。 \x3c\/p\x3e\n\x3cp\x3e同理，在三维空间中，每个 3D 模型都是一个多面体（即 3D 模型由不可弯曲的平面组成）。当我们讨论一个本身就是多面体（如立方体）的模型时并不足以为奇，但我们想展示其它模型时，如球体，就需要记住这个原理了。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880861?w=700\x26amp;h=405\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880861?w=700\x26amp;h=405\x22 alt=\x22三维环境的球体\x22 title=\x22三维环境的球体\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22http:\/\/zwj360.im20.com.cn\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e淘宝造物节的活动页\x3c\/a\x3e 就是 CSS 3D 全景的一个很赞的页面，它将全景图分割成 20 等份，相邻的元素构成的夹角 18°（360\/20，相邻两侧面相对于棱柱中心所构成的夹角）。需要注意的是：我们要确保\x3cstrong\x3e每个元素的正面是指向棱柱中心的\x3c\/strong\x3e。所以要计算好每等份的旋转角度值后，再将元素向外（即 Z 轴方向）平移 \x3ccode\x3er\x3c\/code\x3e px。对于立方体的 \x3ccode\x3er\x3c\/code\x3e 就是 \x3ccode\x3e边长\/2\x3c\/code\x3e，而对于其它更复杂的正多面体呢？  \x3c\/p\x3e\n\x3cp\x3e举例：对于正九棱柱，每个元素的宽为 \x3ccode\x3e210px\x3c\/code\x3e，对应的角度为 \x3ccode\x3e40°\x3c\/code\x3e，即如下图：  \x3cbr\x3e图片来自：\x3ca href=\x22https:\/\/desandro.github.io\/3dtransforms\/docs\/carousel.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/desandro.github.io\/3d...\x3c\/a\x3e  \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880862?w=540\x26amp;h=402\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880862?w=540\x26amp;h=402\x22 alt=\x22正九棱柱的俯视图\x22 title=\x22正九棱柱的俯视图\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e正九棱柱的俯视图  \x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880863?w=329\x26amp;h=383\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880863?w=329\x26amp;h=383\x22 alt=\x22计算过程\x22 title=\x22计算过程\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e计算过程  \x3c\/p\x3e\n\x3cp\x3e由此可得到一个公用函数，只需传入含有\x3cstrong\x3e元素的宽度\x3c\/strong\x3e和\x3cstrong\x3e元素数量\x3c\/strong\x3e的对象，即可得到 \x3ccode\x3er\x3c\/code\x3e 值：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function calTranslateZ(opts) {\n  return Math.round(opts.width \/ (2 * Math.tan(Math.PI \/ opts.number)))\n}\n\ncalTranlateZ({\n    width: 210,\n    number: 9\n});  \/\/ 288\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecalTranslateZ\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eopts\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.round(opts.width \/ (\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e * \x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.tan(\x3cspan class=\x22hljs-built_in\x22\x3eMath\x3c\/span\x3e.PI \/ opts.number)))\n}\n\ncalTranlateZ({\n    \x3cspan class=\x22hljs-attr\x22\x3ewidth\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e210\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-attr\x22\x3enumber\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e9\x3c\/span\x3e\n});  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 288\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880864?w=387\x26amp;h=386\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880864?w=387\x26amp;h=386\x22 alt=\x22俯视时所看到的元素外移动画\x22 title=\x22俯视时所看到的元素外移动画\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e俯视时所看到的元素外移动画  \x3c\/p\x3e\n\x3cp\x3e另外，为了让下文易于理解，我们约定 HTML 的结构：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22#view(perspective:1000px)\n    #stage(transform-style:preserve-3d)\n        #cube(transform-style:preserve-3d)\n            .div（width:600px;height:600px;） \/*组成立方体的元素*\/\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs leaf\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3e#\x3c\/span\x3e\x3cspan class=\x22hljs-title\x22\x3eview\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-variable\x22\x3eperspective\x3c\/span\x3e:1000\x3cspan class=\x22hljs-variable\x22\x3epx\x3c\/span\x3e)\x3c\/span\x3e\x3c\/span\x3e\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3e#\x3c\/span\x3e\x3cspan class=\x22hljs-title\x22\x3estage\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-variable\x22\x3etransform\x3c\/span\x3e-\x3cspan class=\x22hljs-variable\x22\x3estyle\x3c\/span\x3e:\x3cspan class=\x22hljs-variable\x22\x3epreserve\x3c\/span\x3e-3\x3cspan class=\x22hljs-variable\x22\x3ed\x3c\/span\x3e)\x3c\/span\x3e\x3c\/span\x3e\n        \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3e#\x3c\/span\x3e\x3cspan class=\x22hljs-title\x22\x3ecube\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(\x3cspan class=\x22hljs-variable\x22\x3etransform\x3c\/span\x3e-\x3cspan class=\x22hljs-variable\x22\x3estyle\x3c\/span\x3e:\x3cspan class=\x22hljs-variable\x22\x3epreserve\x3c\/span\x3e-3\x3cspan class=\x22hljs-variable\x22\x3ed\x3c\/span\x3e)\x3c\/span\x3e\x3c\/span\x3e\n            .div（width:600px;height:600px;） \/*组成立方体的元素*\/\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e正棱柱构建完成后，就需要将我们的“眼睛”放置在正棱柱内。由于在“眼睛”后的元素是不会被浏览器渲染的（与 \x3ccode\x3e.div元素\x3c\/code\x3e 是否设置 \x3ccode\x3ebackface-visibility:hidden;\x3c\/code\x3e 无关），而且我们保证 \x3ccode\x3e.div元素\x3c\/code\x3e 的\x3cstrong\x3e正面\x3c\/strong\x3e都是指向正棱柱中心，这样就形成 360° 被环绕的效果了。\x3c\/p\x3e\n\x3cp\x3e那“眼睛”具体被放置在哪个位置呢？  \x3cbr\x3e答：通过设置 \x3ccode\x3e#stage\x3c\/code\x3e 元素的 \x3ccode\x3etranslateZ\x3c\/code\x3e 值，让不能被看到的 \x3ccode\x3e.div元素\x3c\/code\x3e 在 \x3ccode\x3eZ\x3c\/code\x3e 轴上的最终坐标值（即其自身 \x3ccode\x3eZ\x3c\/code\x3e 坐标和祖先元素 \x3ccode\x3eZ\x3c\/code\x3e 坐标相加）大于 \x3ccode\x3e#view\x3c\/code\x3e 元素的 \x3ccode\x3eperspective\x3c\/code\x3e 值即可。如：立方体的正面的 \x3ccode\x3etranslateZ\x3c\/code\x3e 是 \x3ccode\x3e-300px\x3c\/code\x3e（为了保证立方体的正面是指向立方体中心，正面元素需要以自身水平方向上的中线为轴，旋转 \x3ccode\x3e180度\x3c\/code\x3e，即 \x3ccode\x3erotateY(-180deg) translateZ(-300px)\x3c\/code\x3e，即正面元素向“眼球”方向平移了 300px），而 \x3ccode\x3e#view\x3c\/code\x3e 的 \x3ccode\x3eperspective\x3c\/code\x3e 值为 \x3ccode\x3e1000px\x3c\/code\x3e，那么 \x3ccode\x3e#stage\x3c\/code\x3e 的 \x3ccode\x3etranslateZ\x3c\/code\x3e 值应该大于 \x3ccode\x3e700px\x3c\/code\x3e 且小于 \x3ccode\x3e1300px\x3c\/code\x3e 即可，具体数值则取决于你想要的呈现效果。\x3c\/p\x3e\n\x3cp\x3e根据上述知识，笔者粗略地模仿了“造物节”的效果：\x3ca href=\x22http:\/\/jdc.jd.com\/lab\/zaowu\/index_new.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/jdc.jd.com\/lab\/zaowu\/i...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e另外，只需 6 幅图就可以实现一张常见的无死角全景图。  \x3cbr\x3e笔者自己又试验了下：\x3ca href=\x22http:\/\/jdc.jd.com\/lab\/zaowu\/index2.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/jdc.jd.com\/lab\/zaowu\/i...\x3c\/a\x3e   \x3c\/p\x3e\n\x3cp\x3e可由下图看出，将水平的 4 张图片合成后就是一张全景图：  \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880865?w=1000\x26amp;h=250\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880865?w=1000\x26amp;h=250\x22 alt=\x22此处输入图片的描述\x22 title=\x22此处输入图片的描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e因此，理解上述知识后，通过 CSS3 Transform 相关属性就可以实现可交互的全景效果了。当然，交互的效果可以是拖拽，也可以是重力感应等。\x3c\/p\x3e\n\x3cp\x3e正如在上文提到的：“没有东西是连续的，即所有东西都是离散的...”。通过两个案例的对比可以发现：图片数量越多，对图片的要求也越低。你觉得呢？\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880866?w=1000\x26amp;h=453\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880866?w=1000\x26amp;h=453\x22 alt=\x22淘宝造物节整体效果图\x22 title=\x22淘宝造物节整体效果图\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e造物节全景图\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e全景图素材的制作\x3c\/h3\x3e\n\x3cp\x3e将全景图制作分为设计类与实景类：\x3c\/p\x3e\n\x3ch4\x3e设计类\x3c\/h4\x3e\n\x3cp\x3e要制作类似 \x3ca href=\x22http:\/\/zwj360.im20.com.cn\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e《淘宝造物节》\x3c\/a\x3e 的全景页面，设计稿需要有以下这些要求。\x3c\/p\x3e\n\x3cp\x3e注：下面提及的具体数据均基于《造物节》，可根据自身要求进行调整（若发现欠缺，欢迎作出补充）。\x3c\/p\x3e\n\x3cp\x3e整体背景设计图如下（2580*1170px，被分成 20 等份）：  \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880866?w=1000\x26amp;h=453\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880866?w=1000\x26amp;h=453\x22 alt=\x22淘宝造物节整体效果图\x22 title=\x22淘宝造物节整体效果图\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e基本要求：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e水平方向上需要首尾相连；\x3c\/li\x3e\n\x3cli\x3e因为效果图最终需要切成 \x3cstrong\x3eN 等份\x3c\/strong\x3e，所以尽可能让 \x3cstrong\x3e设计图的宽度能被 N 整除\x3c\/strong\x3e；\x3c\/li\x3e\n\x3cli\x3e图片尺寸不仅要考虑正视图的大小，还要考虑元素在上下旋转时依然能覆盖视野（可选）。\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e当然，上图只是作为背景，我们还可以添加一些小物体素材（与背景图的运动速度不同时，可形成视差效果，增强立体感），如：   \x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880867?w=516\x26amp;h=220\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880867?w=516\x26amp;h=220\x22 alt=\x22物体小元素1\x22 title=\x22物体小元素1\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880868?w=322\x26amp;h=339\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880868?w=322\x26amp;h=339\x22 alt=\x22物体小元素2\x22 title=\x22物体小元素2\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e小物体元素（虚线用于参考，造物节中共有 21 个小物体）\x3c\/p\x3e\n\x3cp\x3e如上图所示，每个图片也被等分成 M 等份，而且 M 的宽度应该与 N（背景元素）的宽度相等（具体原因，请看文章评论）。\x3c\/p\x3e\n\x3cp\x3e对于顶部和底图图片，则无特殊要求。\x3c\/p\x3e\n\x3ch4\x3e实景类\x3c\/h4\x3e\n\x3cp\x3e如果想制作实景的全景效果，可以看看 Google 街景：  \x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.google.com\/streetview\/publish\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGoogle 街景\x3c\/a\x3e 推荐的设备如下：\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006880869?w=1000\x26amp;h=1640\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006880869?w=1000\x26amp;h=1640\x22 alt=\x22Google 街景推荐的设备\x22 title=\x22Google 街景推荐的设备\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e如上图，最实惠的方式就是最后一个选项——\x3ca href=\x22https:\/\/www.google.com\/streetview\/apps\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGoogle 街景 APP\x3c\/a\x3e，该应用提供了全景相机功能，但正如图片介绍所说，这是需要练习的，因此对操作要求比较高。\x3c\/p\x3e\n\x3cp\x3e补充：\x3cbr\x3e上周六（2016.8.20）参加了 TGDC 的分享会，嘉宾分享了他们处理全景的方式：\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e利用 RICOH THETA S 等专业设备拍出全景图\x3c\/li\x3e\n\x3cli\x3e导出静态图像\x3c\/li\x3e\n\x3cli\x3e利用设备专门提供的 APP 或 krpamo tools、pano2vr、Glsky box 等工具将静态图像转为 6 张图\x3c\/li\x3e\n\x3cli\x3e利用 Web 技术制作可交互的全景图\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e其中 Web 技术有以下 3 种可选方式（当然，还有其它）：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3eCSS3（本文所提及的方式）\x3c\/li\x3e\n\x3cli\x3eThree.js\x3c\/li\x3e\n\x3cli\x3ekrpano（为全景而生，低级浏览器则回退到 Flash），\x3ca href=\x22http:\/\/krpano.com\/docu\/tutorials\/quickstart\/?from=groupmessage\x26amp;isappinstalled=0#top\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e查看教程\x3c\/a\x3e\n\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e当时，嘉宾现场快速制作的 \x3ca href=\x22http:\/\/wt.qq.com\/act\/tgdc_lottery\/lottery.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e会议现场全景\x3c\/a\x3e。\x3c\/p\x3e\n\x3cp\x3e可见，优秀硬件设备的出现，大大减少了后期处理的时间，而 Web 则提供了一个很好的展现平台。\x3c\/p\x3e\n\x3chr\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e最后\x3c\/h3\x3e\n\x3cp\x3e随着终端设备的软硬件不断完善和提高，Web 在 3D 领域也不甘落后，如果你玩腻了 2D 的 H5 或者想为用户提供更加新颖优秀的体验，全景也许是一种选择。\x3c\/p\x3e\n\x3cp\x3e最后，如有不清晰或不明白的地方，可以留言，我会尽可能解决的。谢谢谢~\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>CSS 3D Panorama（全景） - 淘宝造物节技术剖析</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000006880856">https://segmentfault.com/a/1190000006880856</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qav250y5utj/" target="_blank">https://alili.tech/archive/qav250y5utj/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>