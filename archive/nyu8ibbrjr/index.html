<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="Elm入门实践（三）——进阶篇"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>Elm入门实践（三）——进阶篇 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/nyu8ibbrjr/",
				"appid": "1613049289050283", 
				"title": "Elm入门实践（三）——进阶篇 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-08T02:30:40"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/6kd5kbi7qlk/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/0vlx5i5umvdf/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f&text=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f&text=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f&title=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f&is_video=false&description=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f&title=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f&title=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f&title=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fnyu8ibbrjr%2f&title=Elm%e5%85%a5%e9%97%a8%e5%ae%9e%e8%b7%b5%ef%bc%88%e4%b8%89%ef%bc%89%e2%80%94%e2%80%94%e8%bf%9b%e9%98%b6%e7%af%87"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">Elm入门实践（三）——进阶篇</h1><div class="meta"><div class="postdate"><time datetime="2019-02-08" itemprop="datePublished">2019-02-08</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e在之前我们介绍了Elm的\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005701562?_ea=870137\x22\x3e基础\x3c\/a\x3e和\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005701589?_ea=870135\x22 target=\x22_blank\x22\x3e类型\x3c\/a\x3e，并且在Elm的在线编辑器中实现了一个Counter，代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Html exposing (..)\nimport Html.Events exposing (onClick)\nimport Html.App as App\n\ntype alias Model = Int\n\ntype Msg = Increment | Decrement\n\nupdate : Msg -\x3e Model -\x3e Model\nupdate msg model =\n  case msg of\n    Increment -\x3e\n      model \x2b 1\n    Decrement -\x3e\n      model - 1\n\nview : Model -\x3e Html Msg\nview model =\n  div []\n    [ button [onClick Decrement] [text \x26quot;-\x26quot;]\n    , text (toString model)\n    , button [onClick Increment] [text \x26quot;\x2b\x26quot;]\n  ]\n\ninitModel : Model\ninitModel = 3\n\nmain = App.beginnerProgram {model = initModel, view = view, update = update}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Html \x3cspan class=\x22hljs-keyword\x22\x3eexposing\x3c\/span\x3e (..)\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Html.Events \x3cspan class=\x22hljs-keyword\x22\x3eexposing\x3c\/span\x3e (onClick)\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Html.App \x3cspan class=\x22hljs-keyword\x22\x3eas\x3c\/span\x3e App\n\n\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eIncrement\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eDecrement\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e msg model =\n  \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e msg \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e\n    \x3cspan class=\x22hljs-type\x22\x3eIncrement\x3c\/span\x3e -\x26gt;\n      model \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n    \x3cspan class=\x22hljs-type\x22\x3eDecrement\x3c\/span\x3e -\x26gt;\n      model - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-title\x22\x3eview\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eHtml\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eview\x3c\/span\x3e model =\n  div []\n    [ button [onClick \x3cspan class=\x22hljs-type\x22\x3eDecrement\x3c\/span\x3e] [text \x3cspan class=\x22hljs-string\x22\x3e\x22-\x22\x3c\/span\x3e]\n    , text (toString model)\n    , button [onClick \x3cspan class=\x22hljs-type\x22\x3eIncrement\x3c\/span\x3e] [text \x3cspan class=\x22hljs-string\x22\x3e\x22\x2b\x22\x3c\/span\x3e]\n  ]\n\n\x3cspan class=\x22hljs-title\x22\x3einitModel\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3einitModel\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eApp\x3c\/span\x3e.beginnerProgram {model = initModel, view = view, update = update}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e相信你对这门语言已经不再感到陌生，甚至想开始用它做一些小项目。\x3c\/p\x3e\n\x3cp\x3e然而，目前这个Counter还只能运行在elm官网提供的在线编辑器上，如何搭建一个Elm本地工程？如何封装和复用Elm模块？这些就是我们今天将要介绍的内容\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e搭建本地工程\x3c\/h2\x3e\n\x3cp\x3e以上一篇文章中写好的Counter为例，让我们创建一个运行Counter的本地Elm工程，新建一个名为elm-in-practice的文件夹（当然名字随便了）作为项目目录。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3epackage.json 与 elm-package.json\x3c\/h3\x3e\n\x3cp\x3e在创建好项目目录后，第一件事就是创建package.json文件（可以使用\x3ccode\x3enpm init\x3c\/code\x3e），虽然是elm项目，但是依托npm的依赖管理和构建工具也非常有用，并且更符合前端开发者的习惯，这里我们用到的是elm和elm-live两个包：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22npm i --save-dev elm elm-live\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3enpm i --save-dev elm elm-live\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后是创建\x3ccode\x3eelm-package.json\x3c\/code\x3e，正如它的名字一样，elm也提供了类似npm的包管理机制，你可以自由地发布或者\x3ca href=\x22http:\/\/package.elm-lang.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e使用\x3c\/a\x3eelm模块。在Counter中我们需要用到的有\x3ccode\x3eelm-lang\/core\x3c\/code\x3e和\x3ccode\x3eelm-lang\/html\x3c\/code\x3e两个模块，之前我们使用的在线编辑器内置了这些常用依赖，在本地项目中则需要自行配置。完整的\x3ccode\x3eelm-package.json\x3c\/code\x3e文件如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n    \x26quot;version\x26quot;: \x26quot;1.0.0\x26quot;,\n    \x26quot;summary\x26quot;: \x26quot;learn you a elm for great good\x26quot;,\n    \x26quot;repository\x26quot;: \x26quot;https:\/\/github.com\/kpaxqin\/elm-in-practice.git\x26quot;,\n    \x26quot;license\x26quot;: \x26quot;BSD3\x26quot;,\n    \x26quot;source-directories\x26quot;: [\n        \x26quot;.\x26quot;\n    ],\n    \x26quot;exposed-modules\x26quot;: [],\n    \x26quot;dependencies\x26quot;: {\n        \x26quot;elm-lang\/core\x26quot;: \x26quot;4.0.0 \x3c= v \x3c 5.0.0\x26quot;,\n        \x26quot;elm-lang\/html\x26quot;: \x26quot;1.0.0 \x3c= v \x3c 2.0.0\x26quot;\n    },\n    \x26quot;elm-version\x26quot;: \x26quot;0.17.0 \x3c= v \x3c 0.18.0\x26quot;\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e{\n    \x3cspan class=\x22hljs-string\x22\x3e\x22version\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x221.0.0\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22summary\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22learn you a elm for great good\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22repository\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/github.com\/kpaxqin\/elm-in-practice.git\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22license\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22BSD3\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22source-directories\x22\x3c\/span\x3e: [\n        \x3cspan class=\x22hljs-string\x22\x3e\x22.\x22\x3c\/span\x3e\n    ],\n    \x3cspan class=\x22hljs-string\x22\x3e\x22exposed-modules\x22\x3c\/span\x3e: [],\n    \x3cspan class=\x22hljs-string\x22\x3e\x22dependencies\x22\x3c\/span\x3e: {\n        \x3cspan class=\x22hljs-string\x22\x3e\x22elm-lang\/core\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x224.0.0 \x26lt;= v \x26lt; 5.0.0\x22\x3c\/span\x3e,\n        \x3cspan class=\x22hljs-string\x22\x3e\x22elm-lang\/html\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x221.0.0 \x26lt;= v \x26lt; 2.0.0\x22\x3c\/span\x3e\n    },\n    \x3cspan class=\x22hljs-string\x22\x3e\x22elm-version\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x220.17.0 \x26lt;= v \x26lt; 0.18.0\x22\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后执行\x3ccode\x3enode_modules\/.bin\/elm-package install\x3c\/code\x3e，和npm类似，这个命令会把相关的依赖安装到名为\x3ccode\x3eelm-stuff\x3c\/code\x3e的文件夹下。\x3c\/p\x3e\n\x3cp\x3e注意之前我们并没有使用\x3ccode\x3e-g\x3c\/code\x3e参数将\x3ccode\x3eelm\x3c\/code\x3e和\x3ccode\x3eelm-live\x3c\/code\x3e安装到全局，这意味着你不能直接在命令行里使用它们，而只能使用\x3ccode\x3enode_modules\/.bin\/\x26lt;command\x26gt; [args]\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e这样做的好处是隔离项目间依赖，如果你的电脑上有多个项目依赖了不同的elm版本，切换项目会是非常麻烦的事。其它团队成员设置环境时也会更麻烦。\x3c\/p\x3e\n\x3cp\x3e但老是写\x3ccode\x3enode_modules\/.bin\/\x26lt;command\x26gt;\x3c\/code\x3e就像重复代码一样多余，更常见的是结合\x3ca href=\x22https:\/\/docs.npmjs.com\/cli\/run-script\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3enpm run-script\x3c\/a\x3e，将需要执行的命令添加到package.json的scripts字段。在使用\x3ccode\x3enpm run\x3c\/code\x3e执行scripts的时候，\x3ccode\x3enode_modules\/.bin\/\x3c\/code\x3e会被临时添加到PATH中，因此是可以省去的。\x3c\/p\x3e\n\x3cp\x3e向\x3ccode\x3epackage.json\x3c\/code\x3e中添加\x3ccode\x3eelm-install\x3c\/code\x3e命令\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \x26quot;name\x26quot;: \x26quot;elm-in-practice\x26quot;,\n  \x26quot;version\x26quot;: \x26quot;1.0.0\x26quot;,\n  \x26quot;description\x26quot;: \x26quot;\x26quot;,\n  \x26quot;main\x26quot;: \x26quot;index.js\x26quot;,\n  \x26quot;scripts\x26quot;: {\n    \x26quot;elm-install\x26quot;: \x26quot;elm-package install\x26quot;\n  },\n  \x26quot;author\x26quot;: \x26quot;\x26quot;,\n  \x26quot;license\x26quot;: \x26quot;ISC\x26quot;,\n  \x26quot;devDependencies\x26quot;: {\n    \x26quot;elm\x26quot;: \x26quot;^0.17.0\x26quot;,\n    \x26quot;elm-live\x26quot;: \x26quot;^2.3.0\x26quot;\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e{\n  \x3cspan class=\x22hljs-string\x22\x3e\x22name\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22elm-in-practice\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22version\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x221.0.0\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22description\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22main\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22index.js\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22scripts\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22elm-install\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22elm-package install\x22\x3c\/span\x3e\n  },\n  \x3cspan class=\x22hljs-string\x22\x3e\x22author\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22license\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22ISC\x22\x3c\/span\x3e,\n  \x3cspan class=\x22hljs-string\x22\x3e\x22devDependencies\x22\x3c\/span\x3e: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22elm\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22^0.17.0\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22elm-live\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22^2.3.0\x22\x3c\/span\x3e\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后执行\x3ccode\x3enpm run elm-install\x3c\/code\x3e即可。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e创建Main.elm文件\x3c\/h3\x3e\n\x3cp\x3e这一步非常简单，在根目录创建Main.elm文件，并将之前的Counter代码复制进去。\x3c\/p\x3e\n\x3cp\x3e目前为止不需要任何额外工作\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e和其它拥有模块机制的语言一样，Elm也有模块导出语法，但是应用的入口模块并不是必须的，只要模块中有main变量即可。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e打包生成Javascript文件\x3c\/h3\x3e\n\x3cp\x3e目前为止我们安装好了依赖，也有了Elm源代码，作为一门编译到javascript的语言，要做的当然是打包生成.js文件了。\x3c\/p\x3e\n\x3cp\x3eelm提供了\x3ccode\x3eelm-make\x3c\/code\x3e命令，在package.json中添加scripts:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \/\/...\n  scripts: {\n      \x26quot;build\x26quot;: \x26quot;elm-make Main.elm --output=build\/index.js\x26quot;\n      \/\/...\n  }\n  \/\/...\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/...\x3c\/span\x3e\n  scripts: {\n      \x3cspan class=\x22hljs-string\x22\x3e\x22build\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22elm-make Main.elm --output=build\/index.js\x22\x3c\/span\x3e\n      \x3cspan class=\x22hljs-comment\x22\x3e\/\/...\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/...\x3c\/span\x3e\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行\x3ccode\x3enpm run build\x3c\/code\x3e，不出意外的话可以成功编译出index.js文件。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22➜  elm-in-practice git:(master) ✗ npm run build\n\n\x3e elm-in-practice@1.0.0 build \/Users\/jwqin\/workspace\/elm\/elm-in-practice\n\x3e elm-make Main.elm --output=build\/index.js\n\nSuccess! Compiled 1 module.                                         \nSuccessfully generated build\/index.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs n1ql\x22\x3e\x3ccode\x3e➜  elm-in-practice git:(master) ✗ npm run \x3cspan class=\x22hljs-keyword\x22\x3ebuild\x3c\/span\x3e\n\n\x26gt; elm-\x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e-practice@\x3cspan class=\x22hljs-number\x22\x3e1.0\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.0\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ebuild\x3c\/span\x3e \/Users\/jwqin\/workspace\/elm\/elm-\x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e-practice\n\x26gt; elm-make Main.elm --output=\x3cspan class=\x22hljs-keyword\x22\x3ebuild\x3c\/span\x3e\/\x3cspan class=\x22hljs-keyword\x22\x3eindex\x3c\/span\x3e.js\n\nSuccess! Compiled \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e module.                                         \nSuccessfully generated \x3cspan class=\x22hljs-keyword\x22\x3ebuild\x3c\/span\x3e\/\x3cspan class=\x22hljs-keyword\x22\x3eindex\x3c\/span\x3e.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3e有意外也没关系，编译器会给出详细的错误信息。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e在浏览器中运行\x3c\/h3\x3e\n\x3cp\x3e有了js文件，就进入熟悉的套路了，在项目根目录下新建一个index.html文件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE HTML\x3e\n\x3chtml\x3e\n  \x3chead\x3e\n    \x3cmeta charset=\x26quot;UTF-8\x26quot;\x3e\n    \x3ctitle\x3eElm in practice\x3c\/title\x3e\n  \x3c\/head\x3e\n  \x3cbody\x3e\n    \x3cdiv id=\x26quot;container\x26quot;\x3e\n    \x3c\/div\x3e\n    \x3cscript type=\x26quot;text\/javascript\x26quot; src=\x26quot;.\/build\/index.js\x26quot;\x3e\x3c\/script\x3e\n    \x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n      var node = document.getElementById(\x27container\x27);\n      var app = Elm.Main.embed(node);\n    \x3c\/script\x3e\n  \x3c\/body\x3e\n\x3c\/html\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22xml hljs\x22\x3e\x3ccode class=\x22html\x22\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE HTML\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22UTF-8\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3eElm in practice\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etitle\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22container\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22.\/build\/index.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e node = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27container\x27\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = Elm.Main.embed(node);\n    \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里的核心是\x3ccode\x3eElm.Main.embed(node)\x3c\/code\x3e，elm会为入口模块在全局生成\x3ccode\x3eElm.\x26lt;Module Name\x26gt;\x3c\/code\x3e对象，包含三个方法：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Elm.Main = {\n    fullscreen: function() { \/* 在document.body上渲染 *\/ },\n    embed: function(node) { \/* 在指定的node上渲染 *\/ },\n    worker: function() { \/* 无UI运行 *\/ }\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3eElm.Main = {\n    \x3cspan class=\x22hljs-attr\x22\x3efullscreen\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-comment\x22\x3e\/* 在document.body上渲染 *\/\x3c\/span\x3e },\n    \x3cspan class=\x22hljs-attr\x22\x3eembed\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3enode\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-comment\x22\x3e\/* 在指定的node上渲染 *\/\x3c\/span\x3e },\n    \x3cspan class=\x22hljs-attr\x22\x3eworker\x3c\/span\x3e: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{ \x3cspan class=\x22hljs-comment\x22\x3e\/* 无UI运行 *\/\x3c\/span\x3e }\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e此处我们使用\x3ccode\x3eembed\x3c\/code\x3e将应用渲染到id为container的节点中。\x3c\/p\x3e\n\x3cp\x3e在浏览器中打开index.html，可以看到我们的Counter成功在本地运行起来了！\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e使用elm-live实现watch与live-reload\x3c\/h3\x3e\n\x3cp\x3eCounter并不是终点，接下来我们还要实现Counter list。但每次改完代码再手动运行编译命令实在是太土鳖了，怎么着也得有个watch吧？elm-live就是这方面的工具，它封装了elm-make，并且提供了watch，dev server，live reload等实用的功能，不需要任何复杂的配置，相比原生elm-make，只用添加--open来自动打开浏览器即可：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22{\n  \/\/...\n  scripts: {\n    \x26quot;start\x26quot;: \x26quot;elm-live Main.elm --output=build\/index.js --open\x26quot;,\n    \x26quot;build\x26quot;: \x26quot;elm-make Main.elm --output=build\/index.js\x26quot;\n    \/\/...\n  }\n  \/\/...\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/...\x3c\/span\x3e\n  scripts: {\n    \x3cspan class=\x22hljs-string\x22\x3e\x22start\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22elm-live Main.elm --output=build\/index.js --open\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22build\x22\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x22elm-make Main.elm --output=build\/index.js\x22\x3c\/span\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/...\x3c\/span\x3e\n  }\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/...\x3c\/span\x3e\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行\x3ccode\x3enpm start\x3c\/code\x3e感受一下吧\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e大名鼎鼎的webpack也可以用来编译并打包elm文件，甚至可以实现代码热替换（Hot Module Replace），有兴趣的可以参考\x3ca href=\x22https:\/\/github.com\/moarwick\/elm-webpack-starter\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eelm-webpack-starter\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3eCounterList\x3c\/h2\x3e\n\x3cp\x3ecounter list是由任意个counter组成的counter列表，纯react在线版：\x3cbr\x3e\x3ca href=\x22https:\/\/jsfiddle.net\/Kpaxqin\/wh8hb8wr\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/jsfiddle.net\/Kpaxqin\/wh8hb8wr\/\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Kpaxqin\/wh8hb8wr\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e\x3c\/p\x3e\n\x3cp\x3e接下来就让我们在Elm中实现同样的功能\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3eCounter模块\x3c\/h3\x3e\n\x3cp\x3e首先是需要抽象出可复用的Counter模块，新建目录src，并在此目录下创建Counter.elm。\x3cbr\x3e将Main.elm的代码复制到Counter.elm中，然后删除最后这句：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22main = App.beginnerProgram {model = initModel, view = view, update = update}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eApp\x3c\/span\x3e.beginnerProgram {model = initModel, view = view, update = update}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e作为模块，main已经不再需要了，取而代之的是我们需要导出这个模块，在Counter.elm的第一行添加：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module Counter exposing (Model, initModel, Msg, update, view)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e Counter \x3cspan class=\x22hljs-keyword\x22\x3eexposing\x3c\/span\x3e (\x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e, initModel, \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e, update, view)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e也可以使用\x3ccode\x3eexposing (..)\x3c\/code\x3e把当前文件里的所有变量都导出，但具名导出的方式要更健壮一些。\x3c\/p\x3e\n\x3cp\x3e到此为止一个可复用的Counter模块就完成了。\x3c\/p\x3e\n\x3cp\x3e在继续之前还要做一件事，就是将src文件夹添加到elm-package.json的\x3ccode\x3esource-directories\x3c\/code\x3e中：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/elm-package.json\n\n\x26quot;source-directories\x26quot;: [\n    \x26quot;.\x26quot;,\n    \x26quot;src\x26quot;\n],\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/elm-package.json\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-string\x22\x3e\x22source-directories\x22\x3c\/span\x3e: [\n    \x3cspan class=\x22hljs-string\x22\x3e\x22.\x22\x3c\/span\x3e,\n    \x3cspan class=\x22hljs-string\x22\x3e\x22src\x22\x3c\/span\x3e\n],\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样其它文件就可以直接引用src下的模块了\x3c\/p\x3e\n\x3cp\x3e再修改Main文件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Html.App exposing (beginnerProgram)\nimport Counter\n\nmain = beginnerProgram {\n  model = Counter.initModel,\n  view = Counter.view,\n  update = Counter.update}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Html.App \x3cspan class=\x22hljs-keyword\x22\x3eexposing\x3c\/span\x3e (beginnerProgram)\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Counter\n\n\x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e = beginnerProgram {\n  model = \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.initModel,\n  view = \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.view,\n  update = \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.update}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行\x3ccode\x3enpm start\x3c\/code\x3e，效果和之前完全一样，说明抽离模块的重构是成功的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3eCounterList模块\x3c\/h3\x3e\n\x3cp\x3e再在src下新建一个CounterList.elm，可能你已经忘记了写elm模块的套路，不用急，只要记得Elm的架构叫做\x3ccode\x3eM-V-U\x3c\/code\x3e就行了，任何组件都是由这几部分组成：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22--CounterList.elm\n\n\/\/Model\n\n\/\/Update\n\n\/\/View\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e--CounterList.elm\x3c\/span\x3e\n\n\/\/\x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e\n\n\/\/\x3cspan class=\x22hljs-type\x22\x3eUpdate\x3c\/span\x3e\n\n\/\/\x3cspan class=\x22hljs-type\x22\x3eView\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这背后是非常自然的逻辑：描述数据，描述数据如何改变，将一切映射到视图上。\x3c\/p\x3e\n\x3ch4\x3eModel\x3c\/h4\x3e\n\x3cp\x3e作为Counter列表，需要存储的数据当然是Counter类型的数组了\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/Model\n\ntype alias Model = {counters: List Counter}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\/\/\x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e = {counters: \x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但是这样的数据结构是有问题的：Counter类型本身并不包含id，当我们想要修改列表中某个counter时，如何查找它呢？\x3c\/p\x3e\n\x3cp\x3e为此我们需要添加额外的数据类型\x3ccode\x3eIndexedCounter\x3c\/code\x3e，负责将Counter和id组合起来：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22type alias IndexedCounter = {id: Int, counter: Counter}\n\ntype alias Model = {counters: List IndexedCounter}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e = {id: \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e, counter: \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e}\n\n\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e = {counters: \x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样就没问题了，不过还得解决如何生成id，为了简便，我们在Model上再添加一个uid字段，储存最近的id，每次添加一个counter就将它\x2b1，相当于模拟一个自增id生成器：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22type alias IndexedCounter = {id: Int, counter: Counter}\ntype alias Model = {uid: Int, counters: List IndexedCounter}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e = {id: \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e, counter: \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e}\n\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e = {uid: \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e, counters: \x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e同时，我们可以定义一个Model类型的初始值：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22initModel: Model\ninitModel = {uid= 0, counters = [{id= 0, counter= Counter.initModel}]}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-title\x22\x3einitModel\x3c\/span\x3e: \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3einitModel\x3c\/span\x3e = {uid= \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, counters = [{id= \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, counter= \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.initModel}]}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3eUpdate\x3c\/h4\x3e\n\x3ch5\x3eMsg\x3c\/h5\x3e\n\x3cp\x3e在处理变更前我们需要先定义变更，在Counter list中主要有三类：增加Counter、删除Counter、修改Counter：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22type Msg = Insert | Remove | Modify        \n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eInsert\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e        \n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e添加和删除Counter都不需要额外的信息，但修改却不一样，它需要指明\x3cstrong\x3e改哪个\x3c\/strong\x3e以及\x3cstrong\x3e怎么改\x3c\/strong\x3e，借助前面讲到的\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005701589?_ea=870135#articleHeader5\x22\x3e值构造器\x3c\/a\x3e，我们可以通过让Modify携带两个已知类型来达到目的：Int表示目标counter的id，Counter.Msg表示要对该counter做的操作。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22type Msg = Insert | Remove | Modify Int Counter.Msg\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eInsert\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\n\x3cp\x3e从架构上\x3ccode\x3etype Msg\x3c\/code\x3e对应了Redux中的action，都用来表达对系统的变更。\x3c\/p\x3e\n\x3cp\x3e此例可以看出在Elm中，基于类型的action拥有强大的组合能力，而Redux基于字符串的action在这方面的表达力则要弱一些。关于两者的对比，在下一章会继续探讨\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3cp\x3e有了Msg，update函数就很好写了，在开始写逻辑之前可以先返回原model作为占位：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22update : Msg-\x3e Model -\x3e Model\nupdate msg model = \n  case msg of \n    Insert -\x3e \n      model\n    Remove -\x3e \n      model\n    Modify id counterMsg -\x3e\n      model\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e-\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e msg model = \n  \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e msg \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e \n    \x3cspan class=\x22hljs-type\x22\x3eInsert\x3c\/span\x3e -\x26gt; \n      model\n    \x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e -\x26gt; \n      model\n    \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e id counterMsg -\x26gt;\n      model\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e添加\x3c\/h5\x3e\n\x3cp\x3e先处理添加，逻辑是给model.uid加1，并且往model.counters里添加一个IndexedCounter类的值：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22update : Msg -\x3e Model -\x3e Model\nupdate msg model =\n  case msg of\n    Insert -\x3e\n      let\n        id = model.uid \x2b 1\n      in\n        {\n          uid = id,\n          counters = model.counters \x2b\x2b [{id = id, counter = Counter.initModel}]\n        }\n    Remove -\x3e\n      model\n    Modify id counterMsg -\x3e\n      model\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e msg model =\n  \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e msg \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e\n    \x3cspan class=\x22hljs-type\x22\x3eInsert\x3c\/span\x3e -\x26gt;\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e\n        id = model.uid \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e\n        {\n          uid = id,\n          counters = model.counters \x2b\x2b [{id = id, counter = \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.initModel}]\n        }\n    \x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e -\x26gt;\n      model\n    \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e id counterMsg -\x26gt;\n      model\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里我们直接生成了一个新的model，\x3ccode\x3e\x2b\x2b\x3c\/code\x3e是Elm中的拼接操作符，可以用来拼接\x3ccode\x3eList a\x3c\/code\x3e, \x3ccode\x3eString\x3c\/code\x3e等类型\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e其实\x3ccode\x3e\x2b\x2b\x3c\/code\x3e也是函数，和一般函数的\x3ccode\x3efunc a b\x3c\/code\x3e不同，它的调用方式\x3ccode\x3ea func b\x3c\/code\x3e，这种被称作\x3ccode\x3e中缀函数\x3c\/code\x3e，常用的操作符如\x3ccode\x3e\x2b\x3c\/code\x3e、\x3ccode\x3e-\x3c\/code\x3e都是如此\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch5\x3e删除\x3c\/h5\x3e\n\x3cp\x3e删除的逻辑就简单很多了，直接去掉counters数组中的最后一个即可\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Remove -\x3e\n      {counters | counters = List.drop 1 model.counters}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e -\x26gt;\n      {counters | counters = \x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e.drop \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e model.counters}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3e修改\x3c\/h5\x3e\n\x3cp\x3e修改的逻辑是最复杂的，基本的思路是map整个counters，如果counter的id和目标一致，则调用\x3ccode\x3eCounter\x3c\/code\x3e模块暴露出的\x3ccode\x3eupdate\x3c\/code\x3e函数更新，否则原样返回：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  Modify id counterMsg -\x3e\n      let \n        counterMapper = updateCounter id counterMsg\n      in\n        {model | counters = List.map counterMapper model.counters}\n      \nupdateCounter : Int -\x3e Counter.Msg -\x3e IndexedCounter -\x3e IndexedCounter\nupdateCounter id counterMsg indexedCounter =\n  if id == indexedCounter.id \n  then {indexedCounter | counter = Counter.update counterMsg indexedCounter.counter}\n  else indexedCounter\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e  \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e id counterMsg -\x26gt;\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e \n        counterMapper = updateCounter id counterMsg\n      \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e\n        {model | counters = \x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e.map counterMapper model.counters}\n      \n\x3cspan class=\x22hljs-title\x22\x3eupdateCounter\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eupdateCounter\x3c\/span\x3e id counterMsg indexedCounter =\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e id == indexedCounter.id \n  \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e {indexedCounter | counter = \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.update counterMsg indexedCounter.counter}\n  \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e indexedCounter\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eList.map的第一个参数counterMapper是updateCounter函数被部分应用后返回的函数，它接收并返回IndexedCounter，这正是mapper函数需要做的。\x3c\/p\x3e\n\x3cp\x3e在updateCounter中我们使用了Counter.update来获取新的counter，写到这里你可能已经发现，在Model \/ Msg \/ update中，我们都使用了Counter模块的对应部分，这就是Elm最大的特点：无处不在的组合，接下来在View中你也会看到这一点\x3c\/p\x3e\n\x3cp\x3e在继续之前，我们可以先回顾一下目前为止的完整代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Counter\n\ntype alias IndexedCounter = {id: Int, counter: Counter.Model}\ntype alias Model = {uid: Int, counters: List IndexedCounter}\n\ntype Msg = Insert | Remove | Modify id Counter.Msg\n\nupdate : Msg -\x3e Model -\x3e Model\nupdate msg model =\n  case msg of\n    Insert -\x3e\n      let\n        id = model.uid \x2b 1\n      in\n        {\n          uid = id,\n          counters = {id = id, counter = Counter.initModel} :: model.counters\n        }\n    Remove -\x3e\n      {model | counters = List.drop 1 model.counters}\n    Modify id counterMsg -\x3e\n      let \n        counterMapper = updateCounter id counterMsg\n      in\n        {model | counters = List.map counterMapper model.counters}\n        \nupdateCounter : Int -\x3e Counter.Msg -\x3e IndexedCounter -\x3e IndexedCounter\nupdateCounter id counterMsg indexedCounter =\n  if id == indexedCounter.id \n  then {indexedCounter | counter = Counter.update counterMsg indexedCounter.counter}\n  else indexedCounter\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Counter\n\n\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e = {id: \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e, counter: \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e}\n\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ealias\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e = {uid: \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e, counters: \x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e}\n\n\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eInsert\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e id \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eupdate\x3c\/span\x3e msg model =\n  \x3cspan class=\x22hljs-keyword\x22\x3ecase\x3c\/span\x3e msg \x3cspan class=\x22hljs-keyword\x22\x3eof\x3c\/span\x3e\n    \x3cspan class=\x22hljs-type\x22\x3eInsert\x3c\/span\x3e -\x26gt;\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e\n        id = model.uid \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n      \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e\n        {\n          uid = id,\n          counters = {id = id, counter = \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.initModel} :: model.counters\n        }\n    \x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e -\x26gt;\n      {model | counters = \x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e.drop \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e model.counters}\n    \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e id counterMsg -\x26gt;\n      \x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e \n        counterMapper = updateCounter id counterMsg\n      \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e\n        {model | counters = \x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e.map counterMapper model.counters}\n        \n\x3cspan class=\x22hljs-title\x22\x3eupdateCounter\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eInt\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eupdateCounter\x3c\/span\x3e id counterMsg indexedCounter =\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e id == indexedCounter.id \n  \x3cspan class=\x22hljs-keyword\x22\x3ethen\x3c\/span\x3e {indexedCounter | counter = \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.update counterMsg indexedCounter.counter}\n  \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e indexedCounter\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch4\x3eView\x3c\/h4\x3e\n\x3cp\x3e最后要做的事情很简单，就是把数据和行为映射到视图上：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22view : Model -\x3e Html Msg\nview model =\n  div []\n    [ button [onClick Insert] [text \x26quot;Insert\x26quot;]\n    , button [onClick Remove] [text \x26quot;Remove\x26quot;]\n    , div [] (List.map showCounter model.counters)\n    ]\n\nshowCounter : IndexedCounter -\x3e Html Msg\nshowCounter indexedCounter = \n  Counter.view indexedCounter.counter\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eview\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eHtml\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eview\x3c\/span\x3e model =\n  div []\n    [ button [onClick \x3cspan class=\x22hljs-type\x22\x3eInsert\x3c\/span\x3e] [text \x3cspan class=\x22hljs-string\x22\x3e\x22Insert\x22\x3c\/span\x3e]\n    , button [onClick \x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e] [text \x3cspan class=\x22hljs-string\x22\x3e\x22Remove\x22\x3c\/span\x3e]\n    , div [] (\x3cspan class=\x22hljs-type\x22\x3eList\x3c\/span\x3e.map showCounter model.counters)\n    ]\n\n\x3cspan class=\x22hljs-title\x22\x3eshowCounter\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eHtml\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eshowCounter\x3c\/span\x3e indexedCounter = \n  \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.view indexedCounter.counter\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然而以上代码是不工作的！如果一个view函数的返回类型定义为\x3ccode\x3eHtml Msg\x3c\/code\x3e，那它所有的节点都必须满足该类型。\x3ccode\x3eCounter.view\x3c\/code\x3e函数的返回类型是\x3ccode\x3eHtml Counter.Msg\x3c\/code\x3e，而我们需要的却是\x3ccode\x3eHtml Msg\x3c\/code\x3e（此处的Msg为当前CounterList模块的Msg）。\x3c\/p\x3e\n\x3cp\x3e换个角度看，在两个button的onClick事件中，我们会产生Msg类型的消息值：\x3ccode\x3eInsert\x3c\/code\x3e和\x3ccode\x3eRemove\x3c\/code\x3e。而负责修改Counter的\x3ccode\x3eModify\x3c\/code\x3e却没有地方能产生，这显然是有问题的。\x3c\/p\x3e\n\x3cp\x3e既然\x3ccode\x3eCounter.view\x3c\/code\x3e返回的类型\x3ccode\x3eHtml Counter.Msg\x3c\/code\x3e和我们要的\x3ccode\x3eHtml Msg\x3c\/code\x3e不匹配，就得想办法做转换，此处我们将要用到\x3ccode\x3eHtml.App\x3c\/code\x3e模块的\x3ccode\x3eApp.map\x3c\/code\x3e函数：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22showCounter : IndexedCounter -\x3e Html Msg\nshowCounter ({id, counter} as indexedCounter) = \n  App.map (\\counterMsg -\x3e Modify id counterMsg) (Counter.view counter)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-title\x22\x3eshowCounter\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eIndexedCounter\x3c\/span\x3e -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eHtml\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e\n\x3cspan class=\x22hljs-title\x22\x3eshowCounter\x3c\/span\x3e ({id, counter} \x3cspan class=\x22hljs-keyword\x22\x3eas\x3c\/span\x3e indexedCounter) = \n  \x3cspan class=\x22hljs-type\x22\x3eApp\x3c\/span\x3e.map (\\counterMsg -\x26gt; \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e id counterMsg) (\x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.view counter)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3e\\counterMsg -\x26gt; Modify id counterMsg\x3c\/code\x3e是Elm中的匿名函数，在Elm中，匿名函数使用\x3ccode\x3e\\\x3c\/code\x3e开头紧接着参数，并在\x3ccode\x3e-\x26gt;\x3c\/code\x3e后书写返回值表达式，形如\x3ccode\x3e\\a -\x26gt; b\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3eApp.map的类型签名为\x3ccode\x3e(a -\x26gt; msg) -\x26gt; Html a -\x26gt; Html msg\x3c\/code\x3e，第一个参数是针对msg的转换函数，借助它我们将\x3ccode\x3eHtml Counter.Msg\x3c\/code\x3e类型的视图转换成了\x3ccode\x3eHtml Msg\x3c\/code\x3e类型。还记得Modify的定义吗？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22type Msg = Insert | Remove | Modify id Counter.Msg\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3etype\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e = \x3cspan class=\x22hljs-type\x22\x3eInsert\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eRemove\x3c\/span\x3e | \x3cspan class=\x22hljs-type\x22\x3eModify\x3c\/span\x3e id \x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e.\x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e使用\x3ccode\x3eModify\x3c\/code\x3e构造值所需要的：id和Counter.Msg，在showCounter里全都满足。这并不是巧合，而是Elm架构上的精妙之处，还请读者自行思考体会。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e上述代码还使用了Elm中的解构，即\x3ccode\x3e{id, counter} as indexedCounter\x3c\/code\x3e，和ES 6中的\x3ccode\x3econst {a, b} = {a: 1, b: 2}\x3c\/code\x3e类似，不再赘述。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch4\x3e运行\x3c\/h4\x3e\n\x3cp\x3e至此，CounterList模块就基本宣告完成，为了使用它，我们还需要定义模块的导出，和Counter.elm一样，在最顶部添加：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22module CounterList exposing (Msg, Model, initModel, update, view)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e CounterList \x3cspan class=\x22hljs-keyword\x22\x3eexposing\x3c\/span\x3e (\x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e, \x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e, initModel, update, view)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后修改Main.elm：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22import Html.App exposing (beginnerProgram)\nimport CounterList\n\nmain = beginnerProgram {\n  model = CounterList.initModel,\n  view = CounterList.view,\n  update = CounterList.update}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Html.App \x3cspan class=\x22hljs-keyword\x22\x3eexposing\x3c\/span\x3e (beginnerProgram)\n\x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e CounterList\n\n\x3cspan class=\x22hljs-title\x22\x3emain\x3c\/span\x3e = beginnerProgram {\n  model = \x3cspan class=\x22hljs-type\x22\x3eCounterList\x3c\/span\x3e.initModel,\n  view = \x3cspan class=\x22hljs-type\x22\x3eCounterList\x3c\/span\x3e.view,\n  update = \x3cspan class=\x22hljs-type\x22\x3eCounterList\x3c\/span\x3e.update}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e运行看看吧！\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e编译失败也不要紧，试着借助Elm编译器的错误提示去修改问题\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e以上的完整代码，请参考\x3ca href=\x22https:\/\/github.com\/kpaxqin\/elm-in-practice\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub传送门\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e小结\x3c\/h2\x3e\n\x3cp\x3e也许你已经注意到了，无论是Counter.elm还是CounterList.elm，组件的导出都是\x3cstrong\x3e碎片化的\x3c\/strong\x3e：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22--Counter.elm\nmodule Counter exposing (Model, Msg, initModel, update, view)\n\n\n--CounterList.elm\nmodule CounterList exposing (Model, Msg, initModel, update, view)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e--Counter.elm\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e Counter \x3cspan class=\x22hljs-keyword\x22\x3eexposing\x3c\/span\x3e (\x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e, \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e, initModel, update, view)\n\n\n\x3cspan class=\x22hljs-comment\x22\x3e--CounterList.elm\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3emodule\x3c\/span\x3e CounterList \x3cspan class=\x22hljs-keyword\x22\x3eexposing\x3c\/span\x3e (\x3cspan class=\x22hljs-type\x22\x3eModel\x3c\/span\x3e, \x3cspan class=\x22hljs-type\x22\x3eMsg\x3c\/span\x3e, initModel, update, view)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而这些碎片都符合\x3ca href=\x22http:\/\/guide.elm-lang.org\/architecture\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eElm Architecture\x3c\/a\x3e的标准。\x3c\/p\x3e\n\x3cp\x3e这和平常我们接触到的组件方案有所不同，多数的架构把组件看作一个\x3cstrong\x3e闭合的\x3c\/strong\x3e整体：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cCounterList\x3e\n  \x3cCounter id={1} \/\x3e\n  \x3cCounter id={2} \/\x3e\n\x3c\/CounterList\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22elm hljs\x22\x3e\x3ccode class=\x22elm\x22\x3e\x26lt;\x3cspan class=\x22hljs-type\x22\x3eCounterList\x3c\/span\x3e\x26gt;\n  \x26lt;\x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e id={\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e} \/\x26gt;\n  \x26lt;\x3cspan class=\x22hljs-type\x22\x3eCounter\x3c\/span\x3e id={\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e} \/\x26gt;\n\x26lt;\/\x3cspan class=\x22hljs-type\x22\x3eCounterList\x3c\/span\x3e\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e然后在闭合的基础上，再定义开放的接口，比如添加回调。这个方案的风险之处在于：\x3cstrong\x3e闭合和开放的边界\x3c\/strong\x3e非常难以界定，最初定义的开放接口不能满足需要，在维护期中改得千疮百孔是常有的事。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eRedux要求组件为尽量\x3cstrong\x3e不具备行为\x3c\/strong\x3e的纯视图，可以看作是对闭合边界的一种限定\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e一个具备完整功能性的组件至少由\x3ccode\x3e视图\x3c\/code\x3e、\x3ccode\x3e数据\x3c\/code\x3e、\x3ccode\x3e行为\x3c\/code\x3e三部分组成，如果我们将它们\x3cstrong\x3e全部\x3c\/strong\x3e封装到闭合模块中，简单场合下的复用会非常直观，React版的\x3ca href=\x22https:\/\/jsfiddle.net\/Kpaxqin\/wh8hb8wr\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCounterList\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22Kpaxqin\/wh8hb8wr\/\x22 data-typeid=\x220\x22\x3e点击预览\x3c\/button\x3e就是例子，它的Counter是完全闭合的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class Counter extends React.Component {\n    constructor(props) {\n      super(props);\n    this.state = {\n        value: 10\n    }\n  }\n  onDecrement() {\n      this.setState({\n        value: this.state.value - 1\n    })\n  }\n  onIncrement() {\n      this.setState({\n        value: this.state.value \x2b 1\n    })\n  }\n    render() {\n      const {value} = this.state;\n      return (\n        \x3cdiv\x3e\n          \x3cbutton onClick={this.onIncrement.bind(this)}\x3e\x2b\x3c\/button\x3e\n        {value}\n        \x3cbutton onClick={this.onDecrement.bind(this)}\x3e-\x3c\/button\x3e\n      \x3c\/div\x3e\n    )\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eCounter\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3econstructor\x3c\/span\x3e(props) {\n      \x3cspan class=\x22hljs-keyword\x22\x3esuper\x3c\/span\x3e(props);\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state = {\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: \x3cspan class=\x22hljs-number\x22\x3e10\x3c\/span\x3e\n    }\n  }\n  onDecrement() {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state.value - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n    })\n  }\n  onIncrement() {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n        \x3cspan class=\x22hljs-attr\x22\x3evalue\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state.value \x2b \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n    })\n  }\n    render() {\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e {value} = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n        \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n          \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.onIncrement.bind(this)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x2b\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        {value}\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eonClick\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{this.onDecrement.bind(this)}\x3c\/span\x3e\x26gt;\x3c\/span\x3e-\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebutton\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    )\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这使得在渲染Counter列表时，代码只需要短短一句：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22this.state.list.map(i=\x3e \x3cCounter key={i}\/\x3e)\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22 style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state.list.map(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3ei\x3c\/span\x3e=\x26gt;\x3c\/span\x3e \x26lt;Counter key={i}\/\x26gt;)\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e而Elm绕了一大圈，把组件拆得七零八落，收益在哪呢？\x3c\/p\x3e\n\x3cp\x3e下面请看思考题：\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e设CounterList中有固定的三个子Counter：A, B, C。它们正常工作，就像我们在本章实现的一样。为了简化问题，我们暂时移除且不考虑添加和删除Counter的功能。\x3c\/p\x3e\n\x3cp\x3e突然，你家产品经理想出了提升KPI的绝妙办法：在操作A的加减时，应该改变B的值，操作B时改变C，操作C时改变A。 \x3c\/p\x3e\n\x3cp\x3e请思考：在不对产品经理造成人身伤害的前提下，如何用React闭合组件、Redux、Elm分别实现该需求。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>Elm入门实践（三）——进阶篇</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005808614">https://segmentfault.com/a/1190000005808614</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/nyu8ibbrjr/" target="_blank">https://alili.tech/archive/nyu8ibbrjr/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>