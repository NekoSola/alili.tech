<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="如何优雅高效地插入百度广告"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>如何优雅高效地插入百度广告 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/76h9lwyelua/",
				"appid": "1613049289050283", 
				"title": "如何优雅高效地插入百度广告 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-11T02:30:49"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/cjf5ci97qm8/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/274f0w2nnjk/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f&text=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f&text=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f&title=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f&is_video=false&description=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f&title=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f&title=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f&title=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f76h9lwyelua%2f&title=%e5%a6%82%e4%bd%95%e4%bc%98%e9%9b%85%e9%ab%98%e6%95%88%e5%9c%b0%e6%8f%92%e5%85%a5%e7%99%be%e5%ba%a6%e5%b9%bf%e5%91%8a"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">如何优雅高效地插入百度广告</h1><div class="meta"><div class="postdate"><time datetime="2019-02-11" itemprop="datePublished">2019-02-11</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e什么是百度广告\x3c\/h2\x3e\n\x3cp\x3e最近跟百度广告打了会交道，如果您正在或者即将和百度广告打交道，那太好了，本文一定会让您不虚此行。百度广告，即百度联盟广告，在 \x3ca href=\x22http:\/\/union.baidu.com\/product\/prod-cpro.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e这里\x3c\/a\x3e 进行注册后，经过 \x3ca href=\x22http:\/\/nativead.baidu.com:8080\/native_ad\/mobile-native-txt-img.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e一些配置\x3c\/a\x3e，便可以生成一段 js，将该 js 插入到 HTML 页面中，便能出现百度的广告。\x3c\/p\x3e\n\x3cp\x3e恩，百度广告您一定见过，随便截张图：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006776683\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006776683\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e随便给一段生成的百度广告代码感受下:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n   var cpro_id = \x26quot;u2557752\x26quot;;\n\x3c\/script\x3e\n\x3cscript src=\x26quot;http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x26quot; type=\x26quot;text\/javascript\x26quot;\x3e\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n   \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cpro_id = \x3cspan class=\x22hljs-string\x22\x3e\x22u2557752\x22\x3c\/span\x3e;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e以上代码如何能够展现广告？\x3cstrong\x3e最重要的原因是 cm.js 中将广告内容用 document.write 方法输出。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e一般场景\x3c\/h2\x3e\n\x3cp\x3e一般场景，也是最简单的使用，需要广告出现在哪个位置，就把该段 js 放在哪个位置。非常容易理解，因为广告的生成用的是 document.write，所以执行到该段 js 时，会同步输出广告内容。\x3c\/p\x3e\n\x3cp\x3e使用方式大概这样：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3chtml\x3e\n\x3cbody\x3e\n\x3c!-- DOM 元素 --\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n   var cpro_id = \x26quot;u2557752\x26quot;;\n\x3c\/script\x3e\n\x3cscript src=\x26quot;http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x26quot; type=\x26quot;text\/javascript\x26quot;\x3e\x3c\/script\x3e\n\x3c!-- DOM 元素 --\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n    var cpro_id = \x26quot;u2557760\x26quot;;\n\x3c\/script\x3e\n\x3cscript src=\x26quot;http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x26quot; type=\x26quot;text\/javascript\x26quot;\x3e\x3c\/script\x3e\n\x3c!-- DOM 元素 --\x3e\n\x3c\/body\x3e\n\x3c\/html\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- DOM 元素 --\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n   \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cpro_id = \x3cspan class=\x22hljs-string\x22\x3e\x22u2557752\x22\x3c\/span\x3e;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- DOM 元素 --\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cpro_id = \x3cspan class=\x22hljs-string\x22\x3e\x22u2557760\x22\x3c\/span\x3e;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!-- DOM 元素 --\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e异步加载\x3c\/h2\x3e\n\x3cp\x3e以上的一般场景下，如果有性能瓶颈，很显然是因为\x3cstrong\x3e百度广告图片加载的问题\x3c\/strong\x3e，js 的加载并不是首要原因（js还有缓存）。出于好奇，还是首先对 cm.js 试试能否异步加载。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\n\x3cscript\x3e\n  function scriptDomElement(u) {\n    var s = document.createElement(\x27script\x27)\n      , h = document.getElementsByTagName(\x27head\x27)[0];\n\n    s.src = u;\n    s.async = true;\n\n    h \x26amp;\x26amp; h.insertBefore(s, h.firstChild);\n  }\n\n  var cpro_id = \x26quot;u2557760\x26quot;;\n  \n  scriptDomElement(\x26quot;http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x26quot;);\n\x3c\/script\x3e\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3escriptDomElement\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eu\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e s = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e)\n      , h = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByTagName(\x3cspan class=\x22hljs-string\x22\x3e\x27head\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\n    s.src = u;\n    s.async = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\n    h \x26amp;\x26amp; h.insertBefore(s, h.firstChild);\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cpro_id = \x3cspan class=\x22hljs-string\x22\x3e\x22u2557760\x22\x3c\/span\x3e;\n  \n  scriptDomElement(\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x22\x3c\/span\x3e);\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e控制台有个 warning，但是广告也出来了：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000004978357\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000004978357\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e之前我们说到百度广告是用 document.write 同步输出到页面上的，很显然，并不能异步加载有 document.write 方法的 js 文件（到底是重写页面呢，还是重写页面呢），所以会有该 warning。但是，为什么会有广告呢？\x3c\/p\x3e\n\x3cp\x3e这是因为百度有一套 \x22备胎\x22 方案。当 cm.js 内部判断该 js 是被异步加载的时候，随即执行这套备胎方案：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22createBackupWrapper: function(t) {\n    try {\n        var e = document.getElementsByTagName(\x26quot;script\x26quot;)\n          , i = e[e.length - 1];\n        if (i) {\n            var n = i.parentNode;\n            if (n) {\n                var o = document.createElement(\x26quot;div\x26quot;);\n                return o.id = t.containerId,\n                n.insertBefore(o, i),\n                !0\n            }\n        }\n    } catch (r) {}\n    return !1\n    },\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3ecreateBackupWrapper: \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3et\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e e = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByTagName(\x3cspan class=\x22hljs-string\x22\x3e\x22script\x22\x3c\/span\x3e)\n          , i = e[e.length - \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e];\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (i) {\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e n = i.parentNode;\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (n) {\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e o = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22div\x22\x3c\/span\x3e);\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e o.id = t.containerId,\n                n.insertBefore(o, i),\n                !\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\n            }\n        }\n    } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (r) {}\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e !\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e\n    },\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e代码写的很清楚，就是把广告元素插入到最后一个 script 标签的前面。为了保证广告所在的位置即是我们希望的位置，\x3cstrong\x3e很显然最后一个 script 元素必须就是 cm.js\x3c\/strong\x3e。\x3c\/p\x3e\n\x3cp\x3e这样理解的话，我们似乎可以得出这样一个结论：当广告位置在页面最底部时（并且只有一处广告位），我们可以对这段广告的 js 进行如上的异步加载。但是 js 异步加载了，广告所需要的图片还得请求，标签页上的小圈圈还是一直在转，所以我觉得对 cm.js 文件进行异步加载，并没有什么卵用。\x3c\/p\x3e\n\x3cp\x3e事实上，cm.js 内部就提供了异步加载的方案 -\x26gt; \x3ca href=\x22http:\/\/yingxiao.baidu.com\/support\/adm\/detail_8860.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e广告位异步加载代码\x3c\/a\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv id=\x26quot;PAGE_AD_1\x26quot;\x3e\x3c\/div\x3e\nHELLO WORLD\n\x3cdiv id=\x26quot;PAGE_AD_2\x26quot;\x3e\x3c\/div\x3e\n\n\x3c!--广告位代码放在页面最后--\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot; src=\x26quot;http:\/\/cbjs.baidu.com\/js\/m.js\x26quot;\x3e\x3c\/script\x3e\n\n\x3c!--异步加载开始--\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n\nBAIDU_CLB_fillSlotAsync(\x27u2557752\x27,\x27PAGE_AD_1\x27);\/\/12345是广告编号,PAGE_AD_1是您要投放广告的位置\n\nBAIDU_CLB_fillSlotAsync(\x27u2557760\x27,\x27PAGE_AD_2\x27);\n\n\x3c\/script\x3e\n\x3c!--异步加载结束 --\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22PAGE_AD_1\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\nHELLO WORLD\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22PAGE_AD_2\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!--广告位代码放在页面最后--\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cbjs.baidu.com\/js\/m.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!--异步加载开始--\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n\nBAIDU_CLB_fillSlotAsync(\x3cspan class=\x22hljs-string\x22\x3e\x27u2557752\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27PAGE_AD_1\x27\x3c\/span\x3e);\x3cspan class=\x22hljs-comment\x22\x3e\/\/12345是广告编号,PAGE_AD_1是您要投放广告的位置\x3c\/span\x3e\n\nBAIDU_CLB_fillSlotAsync(\x3cspan class=\x22hljs-string\x22\x3e\x27u2557760\x27\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x27PAGE_AD_2\x27\x3c\/span\x3e);\n\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\x26lt;!--异步加载结束 --\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样不仅 cm.js 只需加载一次，而且调用也方便多了。（好吧，之前的异步测试算是无用功）\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e延迟加载\x3c\/h2\x3e\n\x3cp\x3e单纯的异步加载对于页面整体的加载速度似乎并没有什么提升（广告图片略多），是否可以用 setTimeout 进行延迟的异步加载？ok，我们对之前的代码进行一点改造，用一个定时器延迟执行 scriptDomElement 函数。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\n\x3cscript\x3e\n  function scriptDomElement(u) {\n    var s = document.createElement(\x27script\x27)\n      , h = document.getElementsByTagName(\x27head\x27)[0];\n\n    s.src = u;\n    s.async = true;\n\n    h \x26amp;\x26amp; h.insertBefore(s, h.firstChild);\n  }\n\n  var cpro_id = \x26quot;u2557760\x26quot;;\n  \n  setTimeout(function() {\n      scriptDomElement(\x26quot;http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x26quot;);\n  }, 2000);\n\x3c\/script\x3e\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3escriptDomElement\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eu\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e s = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e)\n      , h = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByTagName(\x3cspan class=\x22hljs-string\x22\x3e\x27head\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\n    s.src = u;\n    s.async = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\n    h \x26amp;\x26amp; h.insertBefore(s, h.firstChild);\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cpro_id = \x3cspan class=\x22hljs-string\x22\x3e\x22u2557760\x22\x3c\/span\x3e;\n  \n  setTimeout(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n      scriptDomElement(\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x22\x3c\/span\x3e);\n  }, \x3cspan class=\x22hljs-number\x22\x3e2000\x3c\/span\x3e);\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e前面说了，异步加载仅适用于 cm.js 作为最后一个 script 标签的情况，也就是广告在页面最底部的情况。what\x27s more，经过这样的处理，大多数情况下是可以看到广告的，但是小部分情况广告无法展现，究其原因，楼主觉得是 cm.js 内部对该 js 是否是异步加载无法精确判断。\x3c\/p\x3e\n\x3cp\x3e\x3cdel\x3e所以楼主觉得，如果可以接受某些机器下无法展现百度广告，这个方法还是可以一试的。\x3c\/del\x3e\x3c\/p\x3e\n\x3cp\x3e恩，其实我们完全可以用 cm.js 提供的 BAIDU_CLB_fillSlotAsync 方法和 setTimeout 进行配合。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e重写 document.write\x3c\/h2\x3e\n\x3cp\x3e（\x3cstrong\x3e强势插入硬广一枚：楼主 \x3ca href=\x22https:\/\/github.com\/hanzichi\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eGithub\x3c\/a\x3e 求关注~\x3c\/strong\x3e）\x3c\/p\x3e\n\x3cp\x3e非常简单，写个简单的 DEMO（重写完后记得改回来，DEMO 中没改回来）：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\nHello world!\n\x3cdiv id=\x27ad\x27\x3e\n\x3c\/div\x3e\n\x3cscript\x3e\n  \/\/ 重写 document.write\n  document.write = function( text ){\n    document.getElementById(\x27ad\x27).innerHTML = text;\n  };\n\n  function scriptDomElement(u) {\n    var s = document.createElement(\x27script\x27)\n      , h = document.getElementsByTagName(\x27head\x27)[0];\n\n    s.src = u;\n    s.async = true;\n\n    h \x26amp;\x26amp; h.insertBefore(s, h.firstChild);\n  }\n\n  var cpro_id = \x26quot;u2557760\x26quot;;\n  scriptDomElement(\x26quot;http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x26quot;);\n\x3c\/script\x3e\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\nHello world!\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x27ad\x27\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 重写 document.write\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.write = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e text \x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27ad\x27\x3c\/span\x3e).innerHTML = text;\n  };\n\n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3escriptDomElement\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eu\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e s = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e)\n      , h = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByTagName(\x3cspan class=\x22hljs-string\x22\x3e\x27head\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\n    s.src = u;\n    s.async = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\n    h \x26amp;\x26amp; h.insertBefore(s, h.firstChild);\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cpro_id = \x3cspan class=\x22hljs-string\x22\x3e\x22u2557760\x22\x3c\/span\x3e;\n  scriptDomElement(\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x22\x3c\/span\x3e);\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如何能做到延迟加载？我们可以采用 \x3ca href=\x22http:\/\/www.cnblogs.com\/zichi\/p\/5252629.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBigRender\x3c\/a\x3e 的思路，将广告代码放在 textarea 标签中，当 textarea 出现在视野中时，取出广告代码执行。参考雨夜带刀的代码：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv\x3e\n\x3ctextarea style=\x26quot;display:none\x26quot;\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot; src=\x26quot;http:\/\/gg.5173.com\/adpolestar\/5173\/\n;ap=2EBE5681_1BA3_4663_FA3F_E73D2B83FBDC;ct=js;pu=5173;\/?\x26quot;\x3e\x3c\/script\x3e\n\x3c\/textarea\x3e\n\x3c\/div\x3e\n延迟加载script并重写document.write，下面是代码实现：\n\nvar loadScript = function( elem ){\n    var url = elem.value.match( \/src=\x26quot;([\\s\\S]*?)\x26quot;\/i )[1],\n        parent = elem.parentNode,\n        \/\/ 缓存原生的document.write\n        docWrite = document.write,    \n        \/\/ 创建一个新script来加载\n        script = document.createElement( \x27script\x27 ), \n        head = document.head || \n            document.getElementsByTagName( \x27head\x27 )[0] || \n            document.documentElement;\n    \n    \/\/ 重写document.write\n    document.write = function( text ){\n        parent.innerHTML = text;\n    };\n\n    script.type = \x27text\/javascript\x27;\n    script.src = url;\n    \n    script.onerror = \n    script.onload = \n    script.onreadystatechange = function( e ){\n        e = e || window.event;\n        if( !script.readyState || \n        \/loaded|complete\/.test(script.readyState) ||\n        e === \x27error\x27\n        ){\n\n            \/\/ 恢复原生的document.write\n            document.write = docWrite;\n            head.removeChild( script );\n            \n            \/\/ 卸载事件和断开DOM的引用\n            \/\/ 尽量避免内存泄漏\n            head =             \n            parent = \n            elem =\n            script = \n            script.onerror = \n            script.onload = \n            script.onreadystatechange = null;\n\n        }\n    }\n    \n    \/\/ 加载script\n    head.insertBefore( script, head.firstChild );\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x26lt;div\x26gt;\n\x26lt;textarea style=\x3cspan class=\x22hljs-string\x22\x3e\x22display:none\x22\x3c\/span\x3e\x26gt;\n\x26lt;script type=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e src=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/gg.5173.com\/adpolestar\/5173\/\n;ap=2EBE5681_1BA3_4663_FA3F_E73D2B83FBDC;ct=js;pu=5173;\/?\x22\x3c\/span\x3e\x26gt;\x26lt;\/script\x26gt;\n\x26lt;\/textarea\x26gt;\n\x26lt;\/div\x26gt;\n延迟加载script并重写document.write，下面是代码实现：\n\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e loadScript = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e( elem )\x3c\/span\x3e\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e url = elem.value.match( \/src=\x3cspan class=\x22hljs-string\x22\x3e\x22([\\s\\S]*?)\x22\x3c\/span\x3e\/i )[\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e],\n        \x3cspan class=\x22hljs-keyword\x22\x3eparent\x3c\/span\x3e = elem.parentNode,\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 缓存原生的document.write\x3c\/span\x3e\n        docWrite = document.write,    \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 创建一个新script来加载\x3c\/span\x3e\n        script = document.createElement( \x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e ), \n        head = document.head || \n            document.getElementsByTagName( \x3cspan class=\x22hljs-string\x22\x3e\x27head\x27\x3c\/span\x3e )[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e] || \n            document.documentElement;\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 重写document.write\x3c\/span\x3e\n    document.write = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e( text )\x3c\/span\x3e\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eparent\x3c\/span\x3e.innerHTML = text;\n    };\n\n    script.type = \x3cspan class=\x22hljs-string\x22\x3e\x27text\/javascript\x27\x3c\/span\x3e;\n    script.src = url;\n    \n    script.onerror = \n    script.onload = \n    script.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e( e )\x3c\/span\x3e\x3c\/span\x3e{\n        e = e || window.event;\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e( !script.readyState || \n        \/loaded|complete\/.test(script.readyState) ||\n        e === \x3cspan class=\x22hljs-string\x22\x3e\x27error\x27\x3c\/span\x3e\n        ){\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 恢复原生的document.write\x3c\/span\x3e\n            document.write = docWrite;\n            head.removeChild( script );\n            \n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 卸载事件和断开DOM的引用\x3c\/span\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 尽量避免内存泄漏\x3c\/span\x3e\n            head =             \n            \x3cspan class=\x22hljs-keyword\x22\x3eparent\x3c\/span\x3e = \n            elem =\n            script = \n            script.onerror = \n            script.onload = \n            script.onreadystatechange = \x3cspan class=\x22hljs-keyword\x22\x3enull\x3c\/span\x3e;\n\n        }\n    }\n    \n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 加载script\x3c\/span\x3e\n    head.insertBefore( script, head.firstChild );\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果有多个广告片段，因为 document.write 是全局方法，\x3cstrong\x3e所以不得不维护个脚本队列\x3c\/strong\x3e，一个一个执行，又退化成了同步执行脚本。如果异步并发执行的话，很可能广告的位置会出现对调现象。当然，有些百度广告并不会十分在乎顺序，比如下面要说的新闻信息流。\x3c\/p\x3e\n\x3cp\x3e其实我觉得如果要延迟加载某些特定位置的广告区域，可以用 BAIDU_CLB_fillSlotAsync 方法，将该方法所在的代码塞入 textarea 中。 有一点需要注意的是，BAIDU_CLB_fillSlotAsync 必须指定广告位置的 DOM id。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e插入到新闻信息流\x3c\/h2\x3e\n\x3cp\x3e将百度广告插入到新闻信息流，这是很普遍的做法。\x3c\/p\x3e\n\x3cp\x3e比如网易：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000004978362\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000004978362\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e那么如何将广告插入到新闻信息流当中去呢？我们还是可以用重写 document.write 的方法。\x3c\/p\x3e\n\x3cp\x3e举个简单的例子：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\n\x3cul\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3c\/li\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3c\/li\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3c\/li\x3e\n  \x3cli class=\x26quot;bdad\x26quot;\x3e\x3c\/li\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cscript\x3e\n  \/\/ 重写 document.write\n  document.write = function( text ){\n    document.getElementsByClassName(\x27bdad\x27)[0].innerHTML = text;\n  };\n  \n  function scriptDomElement(u) {\n    var s = document.createElement(\x27script\x27)\n      , h = document.getElementsByTagName(\x27head\x27)[0];\n\n    s.src = u;\n    s.async = true;\n\n    h \x26amp;\x26amp; h.insertBefore(s, h.firstChild);\n  }\n\n  var cpro_id = \x26quot;u2557760\x26quot;;\n  scriptDomElement(\x26quot;http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x26quot;);\n\x3c\/script\x3e\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22bdad\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 重写 document.write\x3c\/span\x3e\n  \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.write = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e text \x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByClassName(\x3cspan class=\x22hljs-string\x22\x3e\x27bdad\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].innerHTML = text;\n  };\n  \n  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3escriptDomElement\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eu\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e s = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x27script\x27\x3c\/span\x3e)\n      , h = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementsByTagName(\x3cspan class=\x22hljs-string\x22\x3e\x27head\x27\x3c\/span\x3e)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e];\n\n    s.src = u;\n    s.async = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n\n    h \x26amp;\x26amp; h.insertBefore(s, h.firstChild);\n  }\n\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cpro_id = \x3cspan class=\x22hljs-string\x22\x3e\x22u2557760\x22\x3c\/span\x3e;\n  scriptDomElement(\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x22\x3c\/span\x3e);\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e重写一个系统的方法毕竟不是什么好事，\x3ca href=\x22http:\/\/3g.163.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e网易\x3c\/a\x3e、 \x3ca href=\x22http:\/\/toutiao.eastday.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e头条新闻\x3c\/a\x3e 采用的都是另一种方法，套一个 iframe，非常巧妙。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000004978366\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000004978366\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3eindex.htm 文件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cbody\x3e\n\x3cul\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3c\/li\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3c\/li\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3c\/li\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3ciframe src=\x26quot;ad.htm\x26quot;\x3e\x3c\/iframe\x3e\x3c\/li\x3e\n  \x3cli class=\x26quot;news\x26quot;\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3c\/body\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22ad.htm\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eiframe\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22news\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ead.htm 文件：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\n  var cpro_id = \x26quot;u2557760\x26quot;;\n\x3c\/script\x3e\n\x3cscript src=\x26quot;http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x26quot;\x3e\x3c\/script\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e cpro_id = \x3cspan class=\x22hljs-string\x22\x3e\x22u2557760\x22\x3c\/span\x3e;\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22http:\/\/cpro.baidustatic.com\/cpro\/ui\/cm.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当然，一些样式方面的细节还需要自己去把握，这里只提供一个思路。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e对于百度广告在不同环境中的投放，有不同的处理方式。主要有三种：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e利用 cm.js 中的 BAIDU_CLB_fillSlotAsync 方法（该方法需要广告位置的 DOM id）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e重写 document.write\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e新建 iframe，在该 iframe 中同步输出广告代码\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e仁者见仁智者见智吧。\x3c\/p\x3e\n\x3cp\x3eRead more：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/www.cnblogs.com\/hongcaomao\/archive\/2012\/03\/27\/javascript_loadad.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e重写document.write实现无阻塞加载js广告\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/stylechen.com\/rewrite-documentwrite.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e让document.write的广告无阻塞的加载\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>如何优雅高效地插入百度广告</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000004978341">https://segmentfault.com/a/1190000004978341</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/76h9lwyelua/" target="_blank">https://alili.tech/archive/76h9lwyelua/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>