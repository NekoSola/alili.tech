<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="[聊一聊系列]聊一聊前端模板与渲染那些事儿"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>[聊一聊系列]聊一聊前端模板与渲染那些事儿 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/937v0zte7nu/",
				"appid": "1613049289050283", 
				"title": "[聊一聊系列]聊一聊前端模板与渲染那些事儿 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-07T02:30:15"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/opv3ixk5fd/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/fli3bkvz4pr/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f&text=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f&text=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f&is_video=false&description=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2f937v0zte7nu%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8a%e5%89%8d%e7%ab%af%e6%a8%a1%e6%9d%bf%e4%b8%8e%e6%b8%b2%e6%9f%93%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">[聊一聊系列]聊一聊前端模板与渲染那些事儿</h1><div class="meta"><div class="postdate"><time datetime="2019-02-07" itemprop="datePublished">2019-02-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e欢迎大家收看聊一聊系列，这一套系列文章，可以帮助前端工程师们了解前端的方方面面（不仅仅是代码）：\x3cbr\x3e\x3ca href=\x22https:\/\/segmentfault.com\/blog\/frontenddriver\x22\x3ehttps:\/\/segmentfault.com\/blog...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e作为现代应用，ajax的大量使用，使得前端工程师们日常的开发少不了拼装模板，渲染模板。我们今天就来聊聊，拼装与渲染模板的那些事儿。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e如果喜欢本文请点击右侧的推荐哦，你的推荐会变为我继续更文的动力。\x3c\/strong\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e1 页面级的渲染\x3c\/h2\x3e\n\x3cp\x3e在刚有web的时候，前端与后端的交互，非常直白，浏览器端发出URL，后端返回一张拼好了的HTML串。浏览器对其进行渲染。html中可能会混有一些php(或者php中混有一些html)。在服务端将数据与模板进行拼装，生成要返回浏览器端的html串。\x3c\/p\x3e\n\x3cp\x3e这与我们现在做一个普通网页没什么区别。只不过现在，我们更常使用模板技术来解决前后端耦合的问题。\x3c\/p\x3e\n\x3cp\x3e前端使用模板引擎，在html中写一些标签，与数据与逻辑基本无关。后端在渲染的时候，解析这些标签，生成HTML串，如smarty。其实前端与后端的交互在服务端就已经有一次了。\x3c\/p\x3e\n\x3cp\x3e模板：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22front.tpl\n\n\x3cdiv\x3e\n    {%$a%}\n\x3c\/div\x3e\n\n后端：\n\n\/\/ 设置变量\n$smarty-\x3eassign(\x27a\x27, \x27give data\x27);\n\n\/\/ 展示模板\n$smarty-\x3edisplay(\x26quot;front.tpl\x26quot;);\n\n到前端时是渲染好的html串：\n\n\x3cdiv\x3e\n    give data\n\x3c\/div\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3efront.tpl\n\n\x26lt;div\x26gt;\n    {%$a%}\n\x26lt;\/div\x26gt;\n\n后端：\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 设置变量\x3c\/span\x3e\n$smarty-\x26gt;assign(\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27give data\x27\x3c\/span\x3e);\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 展示模板\x3c\/span\x3e\n$smarty-\x26gt;display(\x3cspan class=\x22hljs-string\x22\x3e\x22front.tpl\x22\x3c\/span\x3e);\n\n到前端时是渲染好的html串：\n\n\x26lt;div\x26gt;\n    give data\n\x26lt;\/div\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这种方式的特点是展示数据快，直接后端拼装好数据与模板，展现到用户面前。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e2 异步的请求与新增模板\x3c\/h2\x3e\n\x3cp\x3e新的时代，由ajax引领。(Asynchronous\x26nbsp;Javascript\x26nbsp;And\x26nbsp;XML)，这种技术的历史，我就不再赘述。ajax的用法也有多种。\x3c\/p\x3e\n\x3cp\x3eajax接受各种类型的返回。包括XML\/JSON\/String等。前端发起ajax请求，后端直接将数据返回。\x3c\/p\x3e\n\x3cp\x3e但是，读者们有没有想过，ajax回来的数据是干嘛用的呢？相信大部分人使用ajax拿回的数据是用来展示的。前端得把ajax拿回来的数据与模板进行拼装。这就面临了一个问题，当你的模板非常“华丽”的时候(也就是模板代码比较多的时候)。我们在前端写的拼字符串的逻辑，会非常的复杂。\x3c\/p\x3e\n\x3cp\x3e也有的人图省事，直接就在ajax的返回值中，传输拼装好的html字符串。这样可以直接把ajax拿到的html字符串，填充到页面上。\x3c\/p\x3e\n\x3cp\x3e下面实例说明一下两种方式：\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e2.1 ajax获取字符串直接渲染方式\x3c\/h3\x3e\n\x3cp\x3e如图2.1.1所示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22index.html\n\n\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n    \x3chead\x3e\n        \x3cmeta charset=\x26quot;utf-8\x26quot; \/\x3e\n    \x3c\/head\x3e\n    \x3cbody\x3e\n        \x3ch1\x3e下面是待填充区域：\x3c\/h1\x3e\n        \x3cdiv class=\x26quot;blankPlace\x26quot;\x3e\x3c\/div\x3e\n        \x3cscript\x3e\n            var xhr = new XMLHttpRequest();\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4 \x26amp;\x26amp; xhr.status \x3e= 200 \x26amp;\x26amp; xhr.status \x3c 300) {\n                    document.querySelector(\x27.blankPlace\x27).innerHTML = xhr.responseText;\n                }   \n            };  \n            xhr.open(\x27GET\x27, \x27.\/a.html\x27);\n            xhr.send(null);\n        \x3c\/script\x3e\n    \x3c\/body\x3e\n\x3c\/html\x3e\n\n========================================================================\na.html\n\n\x3ch2\x3e我是模板\x3c\/h2\x3e\n\x3cdiv\x3e这是请求回来的数据\x3c\/div\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3eindex.html\n\n\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22utf-8\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e下面是待填充区域：\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22blankPlace\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n            xhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (xhr.readyState === \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x26amp;\x26amp; xhr.status \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x26amp;\x26amp; xhr.status \x26lt; \x3cspan class=\x22hljs-number\x22\x3e300\x3c\/span\x3e) {\n                    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.blankPlace\x27\x3c\/span\x3e).innerHTML = xhr.responseText;\n                }   \n            };  \n            xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.\/a.html\x27\x3c\/span\x3e);\n            xhr.send(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e);\n        \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n========================================================================\na.html\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh2\x3c\/span\x3e\x26gt;\x3c\/span\x3e我是模板\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh2\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e这是请求回来的数据\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x26nbsp; \x26nbsp;\x26nbsp;\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyZht\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyZht\x22 alt=\x22171834_IGuj_1177792.png\x22 title=\x22171834_IGuj_1177792.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.1.1\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e2.2 ajax获取数据，前端进行拼装的方式\x3c\/h3\x3e\n\x3cp\x3e效果如图2.2.1所示：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n    \x3chead\x3e\n        \x3cmeta charset=\x26quot;utf-8\x26quot; \/\x3e\n    \x3c\/head\x3e\n    \x3cbody\x3e\n        \x3ch1\x3e下面是待填充区域：\x3c\/h1\x3e\n        \x3cdiv class=\x26quot;blankPlace\x26quot;\x3e\x3c\/div\x3e\n        \x3cscript\x3e\n            var xhr = new XMLHttpRequest();\n            xhr.onreadystatechange = function () {\n                if (xhr.readyState === 4 \x26amp;\x26amp; xhr.status \x3e= 200 \x26amp;\x26amp; xhr.status \x3c 300) {\n                    var res = JSON.parse(xhr.responseText);\n                    document.querySelector(\x27.blankPlace\x27).innerHTML = \x27\x27\n                        \x2b\x27\x3ch2\x3e\x27\x2b\n                           \x27我是模板\x27\x2b\n                        \x27\x3c\/h2\x3e\x27\x2b\n                        \x27\x3cdiv\x3e\x27\x2b\n                           res.data\x2b\n                        \x27\x3c\/div\x3e\x27;\n                }   \n            };  \n            xhr.open(\x27GET\x27, \x27.\/b.json\x27);\n            xhr.send(null);\n        \x3c\/script\x3e\n    \x3c\/body\x3e\n\x3c\/html\x3e\n\n================================================\n\nb.json\n\n{\x26quot;data\x26quot;: \x26quot;这是请求回来的数据\x26quot;}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22utf-8\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e下面是待填充区域：\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eh1\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22blankPlace\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e xhr = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n            xhr.onreadystatechange = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (xhr.readyState === \x3cspan class=\x22hljs-number\x22\x3e4\x3c\/span\x3e \x26amp;\x26amp; xhr.status \x26gt;= \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e \x26amp;\x26amp; xhr.status \x26lt; \x3cspan class=\x22hljs-number\x22\x3e300\x3c\/span\x3e) {\n                    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e res = \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.parse(xhr.responseText);\n                    \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.querySelector(\x3cspan class=\x22hljs-string\x22\x3e\x27.blankPlace\x27\x3c\/span\x3e).innerHTML = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n                        \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;h2\x26gt;\x27\x3c\/span\x3e\x2b\n                           \x3cspan class=\x22hljs-string\x22\x3e\x27我是模板\x27\x3c\/span\x3e\x2b\n                        \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/h2\x26gt;\x27\x3c\/span\x3e\x2b\n                        \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div\x26gt;\x27\x3c\/span\x3e\x2b\n                           res.data\x2b\n                        \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/div\x26gt;\x27\x3c\/span\x3e;\n                }   \n            };  \n            xhr.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27.\/b.json\x27\x3c\/span\x3e);\n            xhr.send(\x3cspan class=\x22hljs-literal\x22\x3enull\x3c\/span\x3e);\n        \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n================================================\n\nb.json\n\n{\x22data\x22: \x22这是请求回来的数据\x22}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyZhv\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyZhv\x22 alt=\x22172537_JrgD_1177792.png\x22 title=\x22172537_JrgD_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图 2.2.1\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e2.3 两种方式的权衡\x26nbsp;\x3c\/h3\x3e\n\x3cp\x3e那么，如何权衡两种方式呢？\x3c\/p\x3e\n\x3cp\x3e笔者单从自己的思维考虑，得出以下结论。如果这种模板的拼装会发生多次。是一个非常频繁的行为，且模板基本一致，只是数据变动的话，最好是一开始采用客户端拼装的方法。因为，同样的模板没有必要被传到客户端好几次。这样，我们可以剩下传输同样模板的流量，请求更快。\x3c\/p\x3e\n\x3cp\x3e类似于新闻流这种网站比较适合这种方式，如今日头条，如图2.3.1所示：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyZhz\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyZhz\x22 alt=\x22173508_Jb0C_1177792.png\x22 title=\x22173508_Jb0C_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.3.1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyZhD\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyZhD\x22 alt=\x22173613_MQUA_1177792.png\x22 title=\x22173613_MQUA_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.3.2\x3c\/p\x3e\n\x3cp\x3e笔者在DOM上面打了断点后，找到了其拼装模板，确是在客户端所做。\x3c\/p\x3e\n\x3cp\x3e不过，这种做法也有问题，就是用户同步刷新的时候，需要等页面渲染完，再发一个请求，去请求第一屏的数据，才能开始渲染。这个过程相当于发了两次请求，等待的时候还是有所感知的，如图2.3.3所示。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyZhE\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyZhE\x22 alt=\x22174016_s2Du_1177792.png\x22 title=\x22174016_s2Du_1177792.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.3.3\x3c\/p\x3e\n\x3cp\x3e所以这种方式也是有些不尽人意的地方的。经过查看，网易新闻的web版，今日头条的web版，天天快报的web版均是采用这种方式。\x3c\/p\x3e\n\x3cp\x3e第二种方式，同步的时候，就将一段渲染好的HTML，直接输出到页面，而在异步的时候，请求的也是这段HTML，直接将请求回的HTML往页面上一塞就完成了。这样就可以达到同步页面的时候，直接输出，用户就不会看到等待中的小菊花了。\x3c\/p\x3e\n\x3cp\x3e百度首页就采取了这种方式。新闻直出，无需等待如图2.3.4\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyZhH\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyZhH\x22 alt=\x22174928_0Skn_1177792.png\x22 title=\x22174928_0Skn_1177792.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.3.4\x3c\/p\x3e\n\x3cp\x3e但是每次请求新闻的时候，也会去请求HTML片段，如图2.3.5所示\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyZhN\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyZhN\x22 alt=\x22175152_j366_1177792.png\x22 title=\x22175152_j366_1177792.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.3.5\x3c\/p\x3e\n\x3cp\x3e这种方式虽然首屏较快，但是，还是有优化空间的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e2.4 混合方式\x3c\/h3\x3e\n\x3cp\x3e看过了上述两种方式，聪明的你肯定会想：如果前端的js里写一份模板，后端的html(jsp\/asp\/smarty)中也写一份模板呢？这样，同步的时候，直接用后端HTML(jsp\/asp\/smarty)中的模板。异步拉取数据的时候，每次使用js中的模板进行拼装 。同步也能保证首屏的速度，异步也能保证传输量的限制与速度。可是这样，也会面临问题，那就是，你的模板需要维护两份。如果那天产品和你说，我要改一下页面的结构。你不得不改动HTML的时候。js中与jsp\/asp\/smarty中的模板都需要同样的更改两次。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e2.5 前端的模板引擎\x3c\/h3\x3e\n\x3cp\x3e如果说，后端可以将html的拼装转变为使用引擎的话，前端为什么不可以呢？这里我先给大家写一个非常简单的模板解析函数，效果如图2.5.1\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n    \x3chead\x3e\n        \x3cmeta charset=\x26quot;utf-8\x26quot; \/\x3e\n    \x3c\/head\x3e\n    \x3cbody\x3e\n        \x3cdiv id=\x26quot;content1\x26quot;\x3e\x3c\/div\x3e\n        \x3cdiv id=\x26quot;content2\x26quot;\x3e\x3c\/div\x3e\n        \x3cscript\x3e\n            \/\/ 这是我们的模板，怎么样，比直接写html字符串拼装看起来清爽多了吧？抱歉，markdown不能并列吧\x2b号写在前面，所以我就写在了后面\n            var template = \x27\x27\n            \x2b\x27\x3cdiv\x3e\x27\x2b\n               \x27{%=a%}\x27\x2b\n               \x27{%if (a===1){%}\x27\x2b\n                   \x27\x3cspan\x3e\x27\x2b\n                       \x27a是1\x27\x2b\n                   \x27\x3c\/span\x3e\x27\x2b\n               \x27{%}%}\x27\x2b\n            \x27\x3c\/div\x3e\x27;\n            \/\/ 能解析输出与if条件语句的函数\n            function TEMPLATEparser(template, variables) {\n                \/\/ 语法替换\n                var funcStr = template\n                .replace(\/\\{\\%\\=(\\w\x2b)\\%\\}\/, function (code, variable) {\n                    return \x27\x26quot;; str \x2b= \x26quot;\x27 \x2b variable \x2b \x27\x26quot;; str \x2b= \x26quot;\x27;\n                })\n                .replace(\/\\{\\%(if.*?)\\%\\}(.*?)\\{\\%(\\})\\%\\}\/, function (code, judge, content, end) {\n                    return \x27\x26quot;;\x27 \x2b judge \x2b \x27str\x2b=\x26quot;\x27 \x2b content \x2b \x27\x26quot;;\x27 \x2b end \x2b \x27str \x2b= \x26quot;\x27;\n                });\n                \/\/ 返回拼装函数\n                return new Function(variables, \x27var str = \x26quot;\x26quot;; str \x2b= \x26quot;\x27 \x2b funcStr \x2b \x27\x26quot;;return str;\x27);\n            }\n\n            \/\/ 实验使用模板引擎去解析并传入变量生成模板\n            var outHTML = TEMPLATEparser(template, [\x27a\x27])(1);\n            document.getElementById(\x27content1\x27).innerHTML = outHTML;\n            outHTML = TEMPLATEparser(template, [\x27a\x27])(2);\n            document.getElementById(\x27content2\x27).innerHTML = outHTML;\n        \x3c\/script\x3e\n    \x3c\/body\x3e\n\x3c\/html\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22utf-8\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content1\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content2\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这是我们的模板，怎么样，比直接写html字符串拼装看起来清爽多了吧？抱歉，markdown不能并列吧\x2b号写在前面，所以我就写在了后面\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e template = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n            \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div\x26gt;\x27\x3c\/span\x3e\x2b\n               \x3cspan class=\x22hljs-string\x22\x3e\x27{%=a%}\x27\x3c\/span\x3e\x2b\n               \x3cspan class=\x22hljs-string\x22\x3e\x27{%if (a===1){%}\x27\x3c\/span\x3e\x2b\n                   \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;span\x26gt;\x27\x3c\/span\x3e\x2b\n                       \x3cspan class=\x22hljs-string\x22\x3e\x27a是1\x27\x3c\/span\x3e\x2b\n                   \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/span\x26gt;\x27\x3c\/span\x3e\x2b\n               \x3cspan class=\x22hljs-string\x22\x3e\x27{%}%}\x27\x3c\/span\x3e\x2b\n            \x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;\/div\x26gt;\x27\x3c\/span\x3e;\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 能解析输出与if条件语句的函数\x3c\/span\x3e\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eTEMPLATEparser\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etemplate, variables\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 语法替换\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e funcStr = template\n                .replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\{\\%\\=(\\w\x2b)\\%\\}\/\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ecode, variable\x3c\/span\x3e) \x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\x22; str \x2b= \x22\x27\x3c\/span\x3e \x2b variable \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x22; str \x2b= \x22\x27\x3c\/span\x3e;\n                })\n                .replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\{\\%(if.*?)\\%\\}(.*?)\\{\\%(\\})\\%\\}\/\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ecode, judge, content, end\x3c\/span\x3e) \x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\x22;\x27\x3c\/span\x3e \x2b judge \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27str\x2b=\x22\x27\x3c\/span\x3e \x2b content \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x22;\x27\x3c\/span\x3e \x2b end \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27str \x2b= \x22\x27\x3c\/span\x3e;\n                });\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回拼装函数\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eFunction\x3c\/span\x3e(variables, \x3cspan class=\x22hljs-string\x22\x3e\x27var str = \x22\x22; str \x2b= \x22\x27\x3c\/span\x3e \x2b funcStr \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x22;return str;\x27\x3c\/span\x3e);\n            }\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 实验使用模板引擎去解析并传入变量生成模板\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e outHTML = TEMPLATEparser(template, [\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e])(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content1\x27\x3c\/span\x3e).innerHTML = outHTML;\n            outHTML = TEMPLATEparser(template, [\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e])(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content2\x27\x3c\/span\x3e).innerHTML = outHTML;\n        \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVyZh3\x22 src=\x22https:\/\/static.alili.tech\/img\/bVyZh3\x22 alt=\x22184530_Qv1G_1177792.png\x22 title=\x22184530_Qv1G_1177792.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.5.1\x3c\/p\x3e\n\x3cp\x3e这样就制作了一个简单的前端模板，有兴趣的读着可以看看我写的smartyMonkey前端模板引擎：\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/houyu01\/smartyMonkey\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/houyu01\/sm...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e2.6\x26nbsp;前后端同构\x3c\/h3\x3e\n\x3cp\x3e刚刚说过了前端模板，后端模板，前端与后端都需要模板引擎。比如，我们的在后端的模板是这样写的：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 接下来是伪代码\n\x3c!DOCTYPE html\x3e\n\x3chtml\x3e\n    \x3chead\x3e\n        \x3cmeta charset=\x26quot;utf-8\x26quot; \/\x3e\n    \x3c\/head\x3e\n    \x3cbody\x3e\n        \/\/ 前端需要模板去渲染\n        \x3ctextarea id=\x26quot;temp\x26quot;\x3einclude(\x27.\/template.html\x27)\x3c\/textarea\x3e\n        \x3cdiv id=\x26quot;content1\x26quot;\x3e\n            \/\/ 后端渲染模板\n            include(\x27.\/template.html\x27);\n        \x3c\/div\x3e\n        \x3cdiv id=\x26quot;content2\x26quot;\x3e\x3c\/div\x3e\n        \x3cscript\x3e\n            \/\/ 这是我们的模板，怎么样，比直接写html字符串拼装看起来清爽多了吧？\n            var template = document.getElementById(\x27temp\x27).value;\n            \/\/ 能解析输出与if条件语句的函数\n            function TEMPLATEparser(template, variables) {\n                \/\/ 语法替换\n                var funcStr = template\n                .replace(\/\\{\\%\\=(\\w\x2b)\\%\\}\/, function (code, variable) {\n                    return \x27\x26quot;; str \x2b= \x26quot;\x27 \x2b variable \x2b \x27\x26quot;; str \x2b= \x26quot;\x27;\n                })\n                .replace(\/\\{\\%(if.*?)\\%\\}(.*?)\\{\\%(\\})\\%\\}\/, function (code, judge, content, end) {\n                    return \x27\x26quot;;\x27 \x2b judge \x2b \x27str\x2b=\x26quot;\x27 \x2b content \x2b \x27\x26quot;;\x27 \x2b end \x2b \x27str \x2b= \x26quot;\x27;\n                });\n                \/\/ 返回拼装函数\n                return new Function(variables, \x27var str = \x26quot;\x26quot;; str \x2b= \x26quot;\x27 \x2b funcStr \x2b \x27\x26quot;;return str;\x27);\n            }\n\n            \/\/ 实验使用模板引擎去解析并传入变量生成模板\n            var outHTML = TEMPLATEparser(template, [\x27a\x27])(1);\n            document.getElementById(\x27content1\x27).innerHTML = outHTML;\n            outHTML = TEMPLATEparser(template, [\x27a\x27])(2);\n            document.getElementById(\x27content2\x27).innerHTML = outHTML;\n        \x3c\/script\x3e\n    \x3c\/body\x3e\n\x3c\/html\x3e\n\n============================\ntemplate.html\n\n\x3cdiv\x3e\n  {%=a%}\n  {%if (a===1){%}\n      \x3cspan\x3e\n          a是1\n      \x3c\/span\x3e\n  {%}%} \n\x3c\/div\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs django\x22\x3e\x3ccode\x3e\x3cspan class=\x22xml\x22\x3e\/\/ 接下来是伪代码\n\x3cspan class=\x22hljs-meta\x22\x3e\x26lt;!DOCTYPE html\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3emeta\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3echarset\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22utf-8\x22\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehead\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \/\/ 前端需要模板去渲染\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3etextarea\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22temp\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3einclude(\x27.\/template.html\x27)\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3etextarea\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content1\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n            \/\/ 后端渲染模板\n            include(\x27.\/template.html\x27);\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22content2\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 这是我们的模板，怎么样，比直接写html字符串拼装看起来清爽多了吧？\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e template = \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27temp\x27\x3c\/span\x3e).value;\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 能解析输出与if条件语句的函数\x3c\/span\x3e\n            \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eTEMPLATEparser\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3etemplate, variables\x3c\/span\x3e) \x3c\/span\x3e{\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 语法替换\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e funcStr = template\n                .replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\{\\%\\=(\\w\x2b)\\%\\}\/\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ecode, variable\x3c\/span\x3e) \x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\x22; str \x2b= \x22\x27\x3c\/span\x3e \x2b variable \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x22; str \x2b= \x22\x27\x3c\/span\x3e;\n                })\n                .replace(\x3cspan class=\x22hljs-regexp\x22\x3e\/\\{\\%(if.*?)\\%\\}(.*?)\\{\\%(\\})\\%\\}\/\x3c\/span\x3e, \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3ecode, judge, content, end\x3c\/span\x3e) \x3c\/span\x3e{\n                    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27\x22;\x27\x3c\/span\x3e \x2b judge \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27str\x2b=\x22\x27\x3c\/span\x3e \x2b content \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x22;\x27\x3c\/span\x3e \x2b end \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27str \x2b= \x22\x27\x3c\/span\x3e;\n                });\n                \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 返回拼装函数\x3c\/span\x3e\n                \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eFunction\x3c\/span\x3e(variables, \x3cspan class=\x22hljs-string\x22\x3e\x27var str = \x22\x22; str \x2b= \x22\x27\x3c\/span\x3e \x2b funcStr \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27\x22;return str;\x27\x3c\/span\x3e);\n            }\n\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 实验使用模板引擎去解析并传入变量生成模板\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e outHTML = TEMPLATEparser(template, [\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e])(\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content1\x27\x3c\/span\x3e).innerHTML = outHTML;\n            outHTML = TEMPLATEparser(template, [\x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e])(\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e);\n            \x3cspan class=\x22hljs-built_in\x22\x3edocument\x3c\/span\x3e.getElementById(\x3cspan class=\x22hljs-string\x22\x3e\x27content2\x27\x3c\/span\x3e).innerHTML = outHTML;\n        \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ebody\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ehtml\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\n============================\ntemplate.html\n\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3c\/span\x3e\x3cspan class=\x22hljs-template-tag\x22\x3e{%=\x3cspan class=\x22hljs-name\x22\x3ea\x3c\/span\x3e%}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\n  \x3c\/span\x3e\x3cspan class=\x22hljs-template-tag\x22\x3e{%\x3cspan class=\x22hljs-name\x22\x3e\x3cspan class=\x22hljs-name\x22\x3eif\x3c\/span\x3e\x3c\/span\x3e (a===1){%}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n          a是1\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n  \x3c\/span\x3e\x3cspan class=\x22hljs-template-tag\x22\x3e{%}%}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e \n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e前端解析模板的引擎的语法，与后端j解析模板引擎语法一致。这样就达到了一份HTML前后端一起使用的效果。一改俱改，一板两用。其实这样也不算极致的完美，因为聪明的读者会发现，在页面加载的时候，我们多传了一份模板给到前端，如果用户不触发重新渲染的话，可能我们传到前端的模板就算白传了，造成了浪费。聪明的读者们可以考虑一下，如何把这份也给省下去。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader8\x22\x3e3 模板的更新\x3c\/h2\x3e\n\x3cp\x3e有的时候，我们需要整片DOM进行更新，比如：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cdiv class=\x26quot;我需要被更新\x26quot; data-att=\x26quot;我需要被更新\x26quot;\x3e\n    \x3cspan\x3e我需要被更新\x3c\/span\x3e\n    \x3cdiv class=\x26quot;我需要被更新\x26quot;\x3e\x3c\/div\x3e\n\x3c\/div\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs applescript\x22\x3e\x3ccode\x3e\x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22我需要被更新\x22\x3c\/span\x3e data-att=\x3cspan class=\x22hljs-string\x22\x3e\x22我需要被更新\x22\x3c\/span\x3e\x26gt;\n    \x26lt;span\x26gt;我需要被更新\x26lt;\/span\x26gt;\n    \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eclass\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22我需要被更新\x22\x3c\/span\x3e\x26gt;\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n\x26lt;\/\x3cspan class=\x22hljs-keyword\x22\x3ediv\x3c\/span\x3e\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这些html中的节点，需要在某次行为之后，一起被更新。那么我们的js可能会变成这样：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\n    \/\/ 数据更新\n    $.ajax().done(function (data) {\n        $(\x27#wrapper\x27).class(data.xxx);\n        $(\x27#wrapper\x27).attr(\x27data-attr\x27, data.xxx);\n        $(\x27#wrapper span\x27).html(data.xxx);\n        $(\x27#wrapper div\x27).class(data.xxx);\n    });\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22javascript\x22\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 数据更新\x3c\/span\x3e\n    $.ajax().done(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e) \x3c\/span\x3e{\n        $(\x3cspan class=\x22hljs-string\x22\x3e\x27#wrapper\x27\x3c\/span\x3e).class(data.xxx);\n        $(\x3cspan class=\x22hljs-string\x22\x3e\x27#wrapper\x27\x3c\/span\x3e).attr(\x3cspan class=\x22hljs-string\x22\x3e\x27data-attr\x27\x3c\/span\x3e, data.xxx);\n        $(\x3cspan class=\x22hljs-string\x22\x3e\x27#wrapper span\x27\x3c\/span\x3e).html(data.xxx);\n        $(\x3cspan class=\x22hljs-string\x22\x3e\x27#wrapper div\x27\x3c\/span\x3e).class(data.xxx);\n    });\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样的维护，成本极大，还不如直接把整个html重新刷新一遍。这就遇到了我们的js拼装模板了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\n    \/\/ 模板\n    var template = \x27\x27\n    \x2b\x27\x3cdiv class=\x26quot;{%=newclass%}\x26quot; data-attr=\x26quot;{%=newattr%}\x26quot;\x3e\x27\x2b\n        \x27\x3cspan\x3e{%=newcontent%}\x3c\/span\x3e\x27\x2b\n        \x27\x3cdiv class={%=newinnerclass%}\x3e\x3c\/div\x3e\x27\x2b\n    \x27\x3c\/div\x3e\x27;\n    \n\n    \/\/ 数据更新\n    $.ajax().done(function (data) {\n        \/\/ 每次数据更新，直接把模板全刷一遍\n        $(\x27#wrapper\x27)[0].outerHTMl = TEMPLATEparser(template)(data);\n    });\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs django\x22\x3e\x3ccode\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/ 模板\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e template = \x3cspan class=\x22hljs-string\x22\x3e\x27\x27\x3c\/span\x3e\n    \x2b\x3cspan class=\x22hljs-string\x22\x3e\x27\x26lt;div class=\x22\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-template-tag\x22\x3e{%=\x3cspan class=\x22hljs-name\x22\x3enewclass\x3c\/span\x3e%}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22actionscript\x22\x3e\x3cspan class=\x22hljs-string\x22\x3e\x22 data-attr=\x22\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-template-tag\x22\x3e{%=\x3cspan class=\x22hljs-name\x22\x3enewattr\x3c\/span\x3e%}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22handlebars\x22\x3e\x3cspan class=\x22xml\x22\x3e\x22\x26gt;\x27\x2b\n        \x27\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-template-tag\x22\x3e{%=\x3cspan class=\x22hljs-name\x22\x3enewcontent\x3c\/span\x3e%}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22handlebars\x22\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3espan\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x27\x2b\n        \x27\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eclass\x3c\/span\x3e=\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-template-tag\x22\x3e{%=\x3cspan class=\x22hljs-name\x22\x3enewinnerclass\x3c\/span\x3e%}\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22handlebars\x22\x3e\x3cspan class=\x22xml\x22\x3e\x26gt;\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x27\x2b\n    \x27\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x27;\n    \n\n    \/\/ 数据更新\n    $.ajax().done(function (data) {\n        \/\/ 每次数据更新，直接把模板全刷一遍\n        $(\x27#wrapper\x27)[0].outerHTMl = TEMPLATEparser(template)(data);\n    });\n\x3c\/span\x3e\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e但是，直接刷HTML的成本太高。这样浏览器不得不整颗html子树全部重新构建一下，这种方法的性能又不如上一种方法好。\x3c\/p\x3e\n\x3cp\x3e好在react给了我们一种新的思路，它用最少的开销帮我们处理模板的更新，却又不用我们维护更新时繁琐的步骤。有兴趣的读者可以了解一下react-web的diff算法及其应用。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000000606216\x22\x3ehttps:\/\/segmentfault.com\/a\/11...\x3c\/a\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e4 课后思考\x3c\/h2\x3e\n\x3cp\x3e好了，关于前端常见的模板的拼装与更新，我们就讲到这里，同学们有没有考虑过，自己的项目中，如果有异步请求并渲染的逻辑的时候，采用前端拿数据拼装、前端拿拼装好的模板、混合使用哪种更好呢？\x3c\/p\x3e\n\x3cp\x3e文中提及到的例子，均在github上可以找到：\x3ca href=\x22https:\/\/github.com\/houyu01\/templatesample\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/houyu01\/te...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e如果有想一起开发smartyMonkey的同学，请私信我，一起开发力量更大\x3cdel\x3e~\x3c\/del\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e接下来的一篇文章，我将会和读者们一起聊聊前端存储那些事儿，不要走开，请关注我.....\x3c\/strong\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005927232\x22\x3e聊一聊前端存储那些事儿\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>[聊一聊系列]聊一聊前端模板与渲染那些事儿</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005916423">https://segmentfault.com/a/1190000005916423</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/937v0zte7nu/" target="_blank">https://alili.tech/archive/937v0zte7nu/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>