<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="基于Decorator的组件扩展实践"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>基于Decorator的组件扩展实践 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/k0mjtzzz3oe/",
				"appid": "1613049289050283", 
				"title": "基于Decorator的组件扩展实践 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-05T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/a7t4ykgm3s/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/l5affmzgeye/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f&text=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f&text=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f&title=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f&is_video=false&description=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f&title=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f&title=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f&title=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fk0mjtzzz3oe%2f&title=%e5%9f%ba%e4%ba%8eDecorator%e7%9a%84%e7%bb%84%e4%bb%b6%e6%89%a9%e5%b1%95%e5%ae%9e%e8%b7%b5"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">基于Decorator的组件扩展实践</h1><div class="meta"><div class="postdate"><time datetime="2019-02-05" itemprop="datePublished">2019-02-05</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e在前端业务开发中，组件化已经成为我们的共识。沉淀和复用组件，是提高开发效率的利器。但在组件复用的过程中，我们往往会遇到这样的问题，组件相似，却在结构或交互上有些许差别，需要对组件进行改造方可满足需求。这个问题之前在 \x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/21386862\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact实践 - Component Generator\x3c\/a\x3e 就有所提及。\x3c\/p\x3e\n\x3cp\x3e之初，我们提出了组件\x3cstrong\x3e配置式\x3c\/strong\x3e。在业务统一的情况下，仅仅修改组件用于配置的props就可以满足业务需求。但随着业务发生变化导致组件形态发生变化时，我们就必须不断增加配置去应对变化，便会出现配置泛滥，而在扩展过程中又必须保证组件向下兼容，只增不减，使组件可维护性的降低。\x3c\/p\x3e\n\x3cp\x3e最近的项目开发中，\x3ca href=\x22\/u\/jasonhuang\x22\x3e@JasonHuang\x3c\/a\x3e 提出了组件\x3cstrong\x3e组合式\x3c\/strong\x3e开发思想，有效地解决了配置式所存在的一些问题。下面我将详细阐述其思想与具体实现。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e组件再分离\x3c\/h2\x3e\n\x3cp\x3e对于组件的 view 层，我们期望组件是没有冗余的，组件与组件间 view 重叠的部分应当被抽离出来，形成颗粒度更细的组件，使组件组合产生更多的可能。\x3c\/p\x3e\n\x3cp\x3e这种 view 细化的组合式思想早已在我们团队可视化库 \x3ca href=\x22http:\/\/recharts.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eRecharts\x3c\/a\x3e 中有所体现。Recharts 避免了复杂的图表配置，而将图表进行有效拆分，通过声明式的标签进行组合，从而使图表更具扩展性。\x3c\/p\x3e\n\x3cp\x3e同样，我们在组件上也希望秉承这种思想，先来看一下在现有业务比较典型的三个公共组件:\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVBVCA\x22 src=\x22https:\/\/static.alili.tech\/img\/bVBVCA\x22 alt=\x22组件图\x22 title=\x22组件图\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e这三个组件无论在 UI 还是逻辑上均存在一定共性。在配置式中，我们会将这三个组件通过一个组件的配置变换来实现，但无疑会提高单个组件内部逻辑的复杂性。\x3c\/p\x3e\n\x3cp\x3e再做一次分离！它们可由 SelectInput、SearchInput 与 List 三个颗粒度更细的组件来组合。而对于颗粒度最细的组件，我们希望它是纯粹的，木偶式的组件。\x3c\/p\x3e\n\x3cp\x3e例如 SelectInput 组件，组件状态完全依赖传入的 props，包括 selectedItem (显示用户所选项)、isActive (当前下拉状态)、onClickHeader (反馈下拉状态)以及placeholder (下拉框提示)。我们来看一下它的简要实现:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22class SelectInput extends Component {\n  static displayName = \x27SelectInput\x27;\n  \n  render() {\n    const { selectedItem, isActive, onClickHeader, placeholder } = this.props;\n    const { text } = selectedItem || {};\n    return (\n      \x3cdiv onClick={onClickHeader}\x3e\n        \x3cInput \n          type=\x26quot;text\x26quot;\n          disabled\n          value={text}\n          placeholder={placeholder}\n        \/\x3e\n        \x3cIcon className={isActive} name=\x26quot;angle-down\x26quot; \/\x3e\n      \x3c\/div\x3e\n    );\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eSelectInput\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3estatic\x3c\/span\x3e displayName = \x3cspan class=\x22hljs-string\x22\x3e\x27SelectInput\x27\x3c\/span\x3e;\n  \n  render() {\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { selectedItem, isActive, onClickHeader, placeholder } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props;\n    \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { text } = selectedItem || {};\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n      \x26lt;div onClick={onClickHeader}\x26gt;\n        \x26lt;Input \n          type=\x22text\x22\n          disabled\n          value={text}\n          placeholder={placeholder}\n        \/\x26gt;\n        \x26lt;Icon className={isActive} name=\x22angle-down\x22 \/\x26gt;\n      \x26lt;\/div\x26gt;\n    );\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e当组件被再次分离后，我们可以根据业务中的组件形态对其进行任意组合，形成统一层，摆脱在原有组件上扩展的模式，有效提高组件的灵活性。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e逻辑再抽象\x3c\/h2\x3e\n\x3cp\x3e那么有了 view 细化再重组的公共组件后，是不是就可以愉快地开发了?\x3c\/p\x3e\n\x3cp\x3e是的，但组件层面的抽象不应该只停留在 view 层面，组件中的相同交互逻辑和业务逻辑也应该进行抽象。\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/21379350\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReactEurope 2016 小记 - 上\x3c\/a\x3e 中提到复用高阶函数的思想，编写 Higher-Order Components (高阶组件)来为基础组件增加新的功能。\x3c\/p\x3e\n\x3cp\x3eHigher-Order Components = Decorators \x2b Components。在我们的组件中，也正是贯穿着这样函数式的思想，来完成组件逻辑上的抽象，例如:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ 完成SearchInput与List的交互\nconst SearchDecorator = Wrapper =\x3e {\n  class WrapperComponent extends Component {\n    handleSearch(keyword) {\n      this.setState({\n        data: this.props.data,\n        keyword,\n      });\n      this.props.onSearch(keyword);\n    }\n\n    render() {\n      const { data, keyword } = this.state;\n      return (\n        \x3cWrapper\n          {...this.props}\n          data={data}\n          keyword={keyword}\n          onSearch={this.handleSearch.bind(this)}\n        \/\x3e\n      );\n    }\n  }\n  \n  return WrapperComponent;\n};\n\n\/\/ 完成List数据请求\nconst AsyncSelectDecorator = Wrapper =\x3e {\n  class WrapperComponent extends Component {\n    componentDidMount() {\n      const { url } = this.props;\n      \n      fetch(url)\n      .then(response =\x3e response.json())\n      .then(data =\x3e {\n        this.setState({\n          data,\n        });\n      });\n    }\n\n    render() {\n      const { data } = this.state;\n      return (\n        \x3cWrapper\n          {...this.props}\n          data={data}\n        \/\x3e\n      );\n    }\n  }\n\n  return WrapperComponent;\n}\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ 完成SearchInput与List的交互\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e SearchDecorator = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eWrapper\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n  \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eWrapperComponent\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n    handleSearch(keyword) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.setState({\n        \x3cspan class=\x22hljs-attr\x22\x3edata\x3c\/span\x3e: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.data,\n        keyword,\n      });\n      \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.props.onSearch(keyword);\n    }\n\n    render() {\n      \x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e { data, keyword } = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.state;\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n        \x26lt;Wrapper\n          {...this.props}\n          data={data}\n          keyword={keyword}\n          onSearch={this.handleSearch.bind(this)}\n        \/\x26gt;\n      );\n    }\n  }\n  \n  return WrapperComponent;\n};\n\n\/\/ 完成List数据请求\nconst AsyncSelectDecorator = Wrapper =\x26gt; {\n  class WrapperComponent extends Component {\n    componentDidMount() {\n      const { url } = this.props;\n      \n      fetch(url)\n      .then(response =\x26gt; response.json())\n      .then(data =\x26gt; {\n        this.setState({\n          data,\n        });\n      });\n    }\n\n    render() {\n      const { data } = this.state;\n      return (\n        \x26lt;Wrapper\n          {...this.props}\n          data={data}\n        \/\x26gt;\n      );\n    }\n  }\n\n  return WrapperComponent;\n}\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e拥有 Decorator 之后，我们就能赋予组件能力了，例如合成 Search 组件:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22@SearchDecorator\nclass Search extends Component {\n  render() {\n    return (\n      \x3cSelector\n        {...this.props}\n      \x3e\n        \x3cSearchInput \/\x3e\n        \x3cList \/\x3e\n      \x3c\/Selector\x3e\n    );\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e@SearchDecorator\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eSearch\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  render() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n      \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eSelector\x3c\/span\x3e\n        {\x3cspan class=\x22hljs-attr\x22\x3e...this.props\x3c\/span\x3e}\n      \x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eSearchInput\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eList\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eSelector\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    );\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那么当我们将逻辑抽象成为多个 Decorator 时，又该如何去组合呢？你是否还记得 \x3ca href=\x22https:\/\/zhuanlan.zhihu.com\/p\/20361937\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eReact Mixin 的前世今生\x3c\/a\x3e 中提到的方法？没错，就是compose！这里建议读者 review 这篇文章，顺便回顾一下Mixin与高阶组件的不同点。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/ SelectedItemDecorator为List与SelectInput的交互，读者可以自行尝试实现\nconst FinalSelector = compose(AsyncSelectDecorator, SearchDecorator, SelectedItemDecorator)(Selector);\n\nclass SearchSelect extends Component {\n  render() {\n    return (\n      \x3cFinalSelector\n        {...this.props}\n      \x3e\n        \x3cSelectInput \/\x3e\n        \x3cSearchInput \/\x3e\n        \x3cList \/\x3e\n      \x3c\/FinalSelector\x3e\n    );\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/ SelectedItemDecorator为List与SelectInput的交互，读者可以自行尝试实现\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e FinalSelector = compose(AsyncSelectDecorator, SearchDecorator, SelectedItemDecorator)(Selector);\n\n\x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eSearchSelect\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eComponent\x3c\/span\x3e \x3c\/span\x3e{\n  render() {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n      \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eFinalSelector\x3c\/span\x3e\n        {\x3cspan class=\x22hljs-attr\x22\x3e...this.props\x3c\/span\x3e}\n      \x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eSelectInput\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eSearchInput\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eList\x3c\/span\x3e \/\x26gt;\x3c\/span\x3e\n      \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eFinalSelector\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    );\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e小结\x3c\/h2\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVBVC5\x22 src=\x22https:\/\/static.alili.tech\/img\/bVBVC5\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e在配置式组件内部，组件与组件间以及组件与业务间是紧密关联的，而对于开发人员而言需要完成的仅仅是配置的工作。而组合式意图打破这种关联，寻求单元化，通过颗粒度更细的基础组件与抽象组件共有交互与业务逻辑的 Decorator，使组件更灵活，更易扩展，也使开发者能够完成对于基础组件的自由支配。\x3c\/p\x3e\n\x3cp\x3e虽然组合式确实能解决配置式所存在的一些问题，但多层 Decorator 带来的多层包裹，会对组件理解和调试造成一定困难，也\x22不能\x22使用外部公有的方法。同时组合式所基于的函数式编程的思想能否被整个团队所接受，也是我们需要考量的问题。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>基于Decorator的组件扩展实践</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000006617381">https://segmentfault.com/a/1190000006617381</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/k0mjtzzz3oe/" target="_blank">https://alili.tech/archive/k0mjtzzz3oe/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>