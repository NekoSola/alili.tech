<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="理解 CORS (Cross-Origin Resource Sharing)"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>理解 CORS (Cross-Origin Resource Sharing) | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qj800atjw7c/",
				"appid": "1613049289050283", 
				"title": "理解 CORS (Cross-Origin Resource Sharing) | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-10T02:30:42"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/aym5ewewisv/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/z3ybp9uxlrh/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f&text=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f&text=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f&title=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f&is_video=false&description=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f&title=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f&title=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f&title=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqj800atjw7c%2f&title=%e7%90%86%e8%a7%a3%20CORS%20%28Cross-Origin%20Resource%20Sharing%29"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">理解 CORS (Cross-Origin Resource Sharing)</h1><div class="meta"><div class="postdate"><time datetime="2019-02-10" itemprop="datePublished">2019-02-10</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e存在即是合理\x3c\/h2\x3e\n\x3cblockquote\x3e\x3cp\x3e首先理解一下「跨站HTTP请求」\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e跨站HTTP(Cross-Site HTTP Reuqest)请求，是指发起请求的资源所在域不同于该请求所指向资源所在域的HTTP请求。\x3cbr\x3e比如说，域名A(\x3ccode\x3ehttp:\/\/domaina.example\x3c\/code\x3e)的某 Web 应用程序中通过\x3ccode\x3e\x26lt;img\x26gt;\x3c\/code\x3e标签引入了域名B(\x3ccode\x3ehttp:\/\/domainb.foo\x3c\/code\x3e)站点的某图片资源(\x3ccode\x3ehttp:\/\/domainb.foo\/image.jpg\x3c\/code\x3e)，域名A的那 Web 应用就会导致浏览器发起一个跨站 HTTP 请求。\x3cbr\x3e在现在的Web开发中，使用跨站HTTP请求加载各类资源(包括CSS、图片、JavaScript脚本以及其他类资源)，已经成为了一种普遍且流行的方式。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e出于安全考虑，浏览器会限制脚本中发起的跨站请求\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e比如，使用 XMLHttpRequest 对象发起 HTTP 请求就必须遵守同源策略。 具体而言，Web 应用程序能且只能使用 XMLHttpRequest 对象向其加载的源域名发起 HTTP 请求，而不能向任何其它域名发起请求。\x3cbr\x3e要注意的是，跨域并非浏览器限制了发起跨站请求，而是跨站请求可以正常发起，但是返回结果被浏览器拦截了。最好的例子是CSRF跨站攻击原理，请求是发送到了后端服务器无论是否跨域。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e理解同源策略\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.w3.org\/TR\/cors\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCross-Site Sharing Standard\x3c\/a\x3e 是W3C推荐的一种机制，让Web应用服务器能支持跨站访问控制，从而使得安全地进行跨站数据传输成为可能。下面截取其中「\x3ca href=\x22https:\/\/www.w3.org\/TR\/cors\/#syntax\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSyntax\x3c\/a\x3e」章节，来说明一下请求与响应的规范。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eFor Response\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch5\x3eAccess-Control-Allow-Origin Response Header\x3c\/h5\x3e\n\x3cp\x3e该请求头表示所请求的资源是否接受来自指定origin(根据 Origin Request Header)的请求.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Origin: \x3corigin\x3e | *\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gherkin\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Allow-Origin: \x3cspan class=\x22hljs-variable\x22\x3e\x26lt;origin\x26gt;\x3c\/span\x3e |\x3cspan class=\x22hljs-string\x22\x3e *\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e举个栗子,允许来自 \x3ca href=\x22http:\/\/baidu.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/baidu.com\x3c\/a\x3e 的请求,你可以这样指定:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Origin: http:\/\/baidu.com\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/baidu.com\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3eAccess-Control-Allow-Credentials Response Heade\x3c\/h5\x3e\n\x3cp\x3e告知客户端,当请求的credientials属性是true的时候,响应是否可以被得到.当它作为预请求的响应的一部分时,它用来告知实际的请求是否使用了credentials.注意,简单的GET请求不会预检,所以如果一个请求是为了得到一个带有credentials的资源,而响应里又没有Access-Control-Allow-Credentials头信息,那么说明这个响应被忽略了.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Credentials: true | false\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-Allow-Credentials: \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e | \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3eAccess-Control-Expose-Headers Response Header\x3c\/h5\x3e\n\x3cp\x3e设置浏览器允许访问的服务器响应请求的头信息的白名单:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Expose-Headers: X-A-Custom-Header, X-B-Custom-Header\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gauss\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Expose-Headers: X-A-Custom-\x3cspan class=\x22hljs-built_in\x22\x3eHeader\x3c\/span\x3e, X-B-Custom-\x3cspan class=\x22hljs-built_in\x22\x3eHeader\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样，浏览器就可以得到服务器响应请求的头信息中的\x3ccode\x3e X-A-Custom-Header\x3c\/code\x3e、\x3ccode\x3e X-B-Custom-Header\x3c\/code\x3e\x3c\/p\x3e\n\x3ch5\x3eAccess-Control-Max-Age Response Header\x3c\/h5\x3e\n\x3cp\x3e这个头告诉我们这次预请求的结果的有效期是多久：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Max-Age: \x3cdelta-seconds\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-Max-Age: \x26lt;\x3cspan class=\x22hljs-keyword\x22\x3edelta\x3c\/span\x3e-seconds\x26gt;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3ccode\x3edelta-seconds\x3c\/code\x3e 参数表示,允许这个预请求的参数缓存的秒数,在此期间,不用发出另一条预检请求.\x3c\/p\x3e\n\x3ch5\x3eAccess-Control-Allow-Methods Response Header\x3c\/h5\x3e\n\x3cp\x3e指明资源可以被请求的方式有哪些(一个或者多个). 这个响应头信息在客户端发出预检请求的时候会被返回.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Methods: \x3cmethod\x3e[, \x3cmethod\x3e]*\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Allow-Methods: \x26lt;\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3emethod\x3c\/span\x3e\x26gt;[, \x26lt;\x3cspan class=\x22hljs-title\x22\x3emethod\x3c\/span\x3e\x26gt;]*\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3eAccess-Control-Allow-Headers Response Header\x3c\/h5\x3e\n\x3cp\x3e也是在响应预检请求的时候使用.用来指明在实际的请求中,可以使用哪些自定义HTTP请求头.比如\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Headers: X-Custom-Header\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-Allow-Headers: X-Custom-Header\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这样在实际的请求里,请求头信息里就可以有这么一条:\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22X-Custom-Header: hello world\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs gauss\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eX-Custom-\x3cspan class=\x22hljs-built_in\x22\x3eHeader\x3c\/span\x3e: hello world\x3c\/code\x3e\x3c\/pre\x3e\n\x3cblockquote\x3e\x3cp\x3eFor Request\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3ch5\x3eOrigin Request Header\x3c\/h5\x3e\n\x3cp\x3e表明发送请求或者预请求的域\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Origin: \x3corigin\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs dts\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-symbol\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e\x26lt;origin\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e参数\x3ccode\x3eorigin\x3c\/code\x3e是一个URI,告诉服务器端,请求来自哪里.它不包含任何路径信息,只是服务器名.\x3c\/p\x3e\n\x3ch5\x3eAccess-Control-Request-Method Request Header\x3c\/h5\x3e\n\x3cp\x3e在发出预检请求时带有这个头信息,告诉服务器在实际请求时会使用的请求方式\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Request-Method: \x3cmethod\x3e\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Request-\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eMethod\x3c\/span\x3e:\x3c\/span\x3e \x26lt;\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3emethod\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch5\x3eAccess-Control-Request-Headers\x3c\/h5\x3e\n\x3cp\x3e在发出预检请求时带有这个头信息,告诉服务器在实际请求时会携带的自定义头信息.如有多个,可以用逗号分开.\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Request-Headers: \x3cfield-name\x3e[, \x3cfield-name\x3e]*\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs fortran\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eAccess\x3c\/span\x3e-Control-Request-Headers: \x26lt;field-\x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e\x26gt;[, \x26lt;field-\x3cspan class=\x22hljs-keyword\x22\x3ename\x3c\/span\x3e\x26gt;]*\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e举三个栗子\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e一个简单的请求\x3c\/h3\x3e\n\x3cp\x3e比如说，假如站点 \x3ccode\x3ehttp:\/\/foo.example\x3c\/code\x3e 的网页应用想要访问 \x3ccode\x3ehttp:\/\/bar.other\x3c\/code\x3e 的资源。以下的 JavaScript 代码应该会在 foo.example 上执行：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var invocation = new XMLHttpRequest();\nvar url = \x27http:\/\/bar.other\/resources\/public-data\/\x27;\n   \nfunction callOtherDomain() {\n  if(invocation) {    \n    invocation.open(\x27GET\x27, url, true);\n    invocation.onreadystatechange = handler;\n    invocation.send(); \n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e invocation = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/bar.other\/resources\/public-data\/\x27\x3c\/span\x3e;\n   \n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecallOtherDomain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(invocation) {    \n    invocation.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n    invocation.onreadystatechange = handler;\n    invocation.send(); \n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e让我们看看，在这个场景中，浏览器会发送什么的请求到服务器，而服务器又会返回什么给浏览器：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22GET \/resources\/public-data\/ HTTP\/1.1\nHost: bar.other\nUser-Agent: Mozilla\/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko\/20081130 Minefield\/3.1b3pre\nAccept: text\/html,application\/xhtml\x2bxml,application\/xml;q=0.9,*\/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nConnection: keep-alive\nReferer: http:\/\/foo.example\/examples\/access-control\/simpleXSInvocation.html\nOrigin: http:\/\/foo.example\n\n\nHTTP\/1.1 200 OK\nDate: Mon, 01 Dec 2008 00:23:53 GMT\nServer: Apache\/2.0.61 \nAccess-Control-Allow-Origin: *\nKeep-Alive: timeout=2, max=100\nConnection: Keep-Alive\nTransfer-Encoding: chunked\nContent-Type: application\/xml\n\n[XML Data]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs http\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eGET\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\/resources\/public-data\/\x3c\/span\x3e HTTP\/1.1\n\x3cspan class=\x22hljs-attribute\x22\x3eHost\x3c\/span\x3e: bar.other\n\x3cspan class=\x22hljs-attribute\x22\x3eUser-Agent\x3c\/span\x3e: Mozilla\/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko\/20081130 Minefield\/3.1b3pre\n\x3cspan class=\x22hljs-attribute\x22\x3eAccept\x3c\/span\x3e: text\/html,application\/xhtml\x2bxml,application\/xml;q=0.9,*\/*;q=0.8\n\x3cspan class=\x22hljs-attribute\x22\x3eAccept-Language\x3c\/span\x3e: en-us,en;q=0.5\n\x3cspan class=\x22hljs-attribute\x22\x3eAccept-Encoding\x3c\/span\x3e: gzip,deflate\n\x3cspan class=\x22hljs-attribute\x22\x3eAccept-Charset\x3c\/span\x3e: ISO-8859-1,utf-8;q=0.7,*;q=0.7\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: keep-alive\n\x3cspan class=\x22hljs-attribute\x22\x3eReferer\x3c\/span\x3e: http:\/\/foo.example\/examples\/access-control\/simpleXSInvocation.html\n\x3cspan class=\x22hljs-attribute\x22\x3eOrigin\x3c\/span\x3e: http:\/\/foo.example\n\n\x3cspan class=\x22http\x22\x3e\nHTTP\/1.1 \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-attribute\x22\x3eDate\x3c\/span\x3e: Mon, 01 Dec 2008 00:23:53 GMT\n\x3cspan class=\x22hljs-attribute\x22\x3eServer\x3c\/span\x3e: Apache\/2.0.61 \n\x3cspan class=\x22hljs-attribute\x22\x3eAccess-Control-Allow-Origin\x3c\/span\x3e: *\n\x3cspan class=\x22hljs-attribute\x22\x3eKeep-Alive\x3c\/span\x3e: timeout=2, max=100\n\x3cspan class=\x22hljs-attribute\x22\x3eConnection\x3c\/span\x3e: Keep-Alive\n\x3cspan class=\x22hljs-attribute\x22\x3eTransfer-Encoding\x3c\/span\x3e: chunked\n\x3cspan class=\x22hljs-attribute\x22\x3eContent-Type\x3c\/span\x3e: application\/xml\n\n\x3cspan class=\x22crmsh\x22\x3e[\x3cspan class=\x22hljs-keyword\x22\x3eXML\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eData\x3c\/span\x3e]\x3c\/span\x3e\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e第 1~10 行是 浏览器 发出的请求头。注意看第10行的请求头 Origin，它表明了该请求来自于 \x3ccode\x3ehttp:\/\/foo.exmaple\x3c\/code\x3e。\x3c\/p\x3e\n\x3cp\x3e第 13~22 行则是 \x3ccode\x3ehttp:\/\/bar.other\x3c\/code\x3e 服务器的响应。如第16行所示，服务器返回了响应头 Access-Control-Allow-Origin: *，这表明服务器接受来自任何站点的跨站请求。如果服务器端仅允许来自 \x3ccode\x3ehttp:\/\/foo.example\x3c\/code\x3e 的跨站请求，它可以返回：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Origin: http:\/\/foo.example\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e现在，除了 \x3ccode\x3ehttp:\/\/foo.example\x3c\/code\x3e，其它站点就不能跨站访问 \x3ccode\x3ehttp:\/\/bar.other\x3c\/code\x3e 的资源了。\x3c\/p\x3e\n\x3cp\x3e如上，通过使用 Origin 和 Access-Control-Allow-Origin 就可以完成最简单的跨站请求。不过 Access-Control-Allow-Origin 需要为 * 或者包含由 Origin 指明的站点。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e预请求 Prefilght\x3c\/h3\x3e\n\x3cp\x3e不同于上面讨论的简单请求，“预请求”要求必须先发送一个 OPTIONS 请求给目的站点，来查明这个跨站请求对于目的站点是不是安全可接受的。这样做，是因为跨站请求可能会对目的站点的数据造成破坏。 当请求具备以下条件，就会被当成预请求处理：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e请求以 GET, HEAD 或者 POST 以外的方法发起请求。或者，使用 POST，但请求数据为 application\/x-www-form-urlencoded, multipart\/form-data 或者 text\/plain 以外的数据类型。比如说，用 POST 发送数据类型为 application\/xml 或者 text\/xml 的 XML 数据的请求。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e使用自定义请求头（比如添加诸如 X-PINGOTHER\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e如示例：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var invocation = new XMLHttpRequest();\nvar url = \x27http:\/\/bar.other\/resources\/post-here\/\x27;\nvar body = \x27{C}{C}{C}{C}{C}{C}{C}{C}{C}{C}Arun\x27;\n    \nfunction callOtherDomain(){\n  if(invocation)\n    {\n      invocation.open(\x27POST\x27, url, true);\n      invocation.setRequestHeader(\x27X-PINGOTHER\x27, \x27pingpong\x27);\n      invocation.setRequestHeader(\x27Content-Type\x27, \x27application\/xml\x27);\n      invocation.onreadystatechange = handler;\n      invocation.send(body); \n    }\n\n......\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e invocation = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/bar.other\/resources\/post-here\/\x27\x3c\/span\x3e;\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e body = \x3cspan class=\x22hljs-string\x22\x3e\x27{C}{C}{C}{C}{C}{C}{C}{C}{C}{C}Arun\x27\x3c\/span\x3e;\n    \n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecallOtherDomain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(invocation)\n    {\n      invocation.open(\x3cspan class=\x22hljs-string\x22\x3e\x27POST\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n      invocation.setRequestHeader(\x3cspan class=\x22hljs-string\x22\x3e\x27X-PINGOTHER\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27pingpong\x27\x3c\/span\x3e);\n      invocation.setRequestHeader(\x3cspan class=\x22hljs-string\x22\x3e\x27Content-Type\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27application\/xml\x27\x3c\/span\x3e);\n      invocation.onreadystatechange = handler;\n      invocation.send(body); \n    }\n\n......\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如上，以 XMLHttpRequest 创建了一个 POST 请求，为该请求添加了一个自定义请求头(X-PINGOTHER: pingpong)，并指定数据类型为 application\/xml。所以，该请求是一个“预请求”形式的跨站请求。\x3c\/p\x3e\n\x3cp\x3e让我们看看服务器与浏览器之间具体的交互过程：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22OPTIONS \/resources\/post-here\/ HTTP\/1.1\nHost: bar.other\nUser-Agent: Mozilla\/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko\/20081130 Minefield\/3.1b3pre\nAccept: text\/html,application\/xhtml\x2bxml,application\/xml;q=0.9,*\/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nConnection: keep-alive\nOrigin: http:\/\/foo.example\nAccess-Control-Request-Method: POST\nAccess-Control-Request-Headers: X-PINGOTHER\n\n\nHTTP\/1.1 200 OK\nDate: Mon, 01 Dec 2008 01:15:39 GMT\nServer: Apache\/2.0.61 (Unix)\nAccess-Control-Allow-Origin: http:\/\/foo.example\nAccess-Control-Allow-Methods: POST, GET, OPTIONS\nAccess-Control-Allow-Headers: X-PINGOTHER\nAccess-Control-Max-Age: 1728000\nVary: Accept-Encoding, Origin\nContent-Encoding: gzip\nContent-Length: 0\nKeep-Alive: timeout=2, max=100\nConnection: Keep-Alive\nContent-Type: text\/plain\n\nPOST \/resources\/post-here\/ HTTP\/1.1\nHost: bar.other\nUser-Agent: Mozilla\/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko\/20081130 Minefield\/3.1b3pre\nAccept: text\/html,application\/xhtml\x2bxml,application\/xml;q=0.9,*\/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nConnection: keep-alive\nX-PINGOTHER: pingpong\nContent-Type: text\/xml; charset=UTF-8\nReferer: http:\/\/foo.example\/examples\/preflightInvocation.html\nContent-Length: 55\nOrigin: http:\/\/foo.example\nPragma: no-cache\nCache-Control: no-cache\n\nArun\n\n\nHTTP\/1.1 200 OK\nDate: Mon, 01 Dec 2008 01:15:40 GMT\nServer: Apache\/2.0.61 (Unix)\nAccess-Control-Allow-Origin: http:\/\/foo.example\nVary: Accept-Encoding, Origin\nContent-Encoding: gzip\nContent-Length: 235\nKeep-Alive: timeout=2, max=99\nConnection: Keep-Alive\nContent-Type: text\/plain\n\n[Some GZIP\x27d payload]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3eOPTIONS \x3cspan class=\x22hljs-regexp\x22\x3e\/resources\/\x3c\/span\x3epost-here\x3cspan class=\x22hljs-regexp\x22\x3e\/ HTTP\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eHost:\x3c\/span\x3e bar.other\nUser-\x3cspan class=\x22hljs-string\x22\x3eAgent:\x3c\/span\x3e Mozilla\x3cspan class=\x22hljs-regexp\x22\x3e\/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e20081130\x3c\/span\x3e Minefield\/\x3cspan class=\x22hljs-number\x22\x3e3.1\x3c\/span\x3eb3pre\n\x3cspan class=\x22hljs-string\x22\x3eAccept:\x3c\/span\x3e text\x3cspan class=\x22hljs-regexp\x22\x3e\/html,application\/\x3c\/span\x3exhtml\x2bxml,application\x3cspan class=\x22hljs-regexp\x22\x3e\/xml;q=0.9,*\/\x3c\/span\x3e*;q=\x3cspan class=\x22hljs-number\x22\x3e0.8\x3c\/span\x3e\nAccept-\x3cspan class=\x22hljs-string\x22\x3eLanguage:\x3c\/span\x3e en-us,en;q=\x3cspan class=\x22hljs-number\x22\x3e0.5\x3c\/span\x3e\nAccept-\x3cspan class=\x22hljs-string\x22\x3eEncoding:\x3c\/span\x3e gzip,deflate\nAccept-\x3cspan class=\x22hljs-string\x22\x3eCharset:\x3c\/span\x3e ISO\x3cspan class=\x22hljs-number\x22\x3e-8859\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e,utf\x3cspan class=\x22hljs-number\x22\x3e-8\x3c\/span\x3e;q=\x3cspan class=\x22hljs-number\x22\x3e0.7\x3c\/span\x3e,*;q=\x3cspan class=\x22hljs-number\x22\x3e0.7\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eConnection:\x3c\/span\x3e keep-alive\n\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\x3c\/span\x3e\nAccess-Control-Request-\x3cspan class=\x22hljs-string\x22\x3eMethod:\x3c\/span\x3e POST\nAccess-Control-Request-\x3cspan class=\x22hljs-string\x22\x3eHeaders:\x3c\/span\x3e X-PINGOTHER\n\n\nHTTP\/\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-string\x22\x3eDate:\x3c\/span\x3e Mon, \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e Dec \x3cspan class=\x22hljs-number\x22\x3e2008\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e39\x3c\/span\x3e GMT\n\x3cspan class=\x22hljs-string\x22\x3eServer:\x3c\/span\x3e Apache\/\x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.61\x3c\/span\x3e (Unix)\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\x3c\/span\x3e\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eMethods:\x3c\/span\x3e POST, GET, OPTIONS\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eHeaders:\x3c\/span\x3e X-PINGOTHER\nAccess-Control-Max-\x3cspan class=\x22hljs-string\x22\x3eAge:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1728000\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eVary:\x3c\/span\x3e Accept-Encoding, Origin\nContent-\x3cspan class=\x22hljs-string\x22\x3eEncoding:\x3c\/span\x3e gzip\nContent-\x3cspan class=\x22hljs-string\x22\x3eLength:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e\nKeep-\x3cspan class=\x22hljs-string\x22\x3eAlive:\x3c\/span\x3e timeout=\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, max=\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eConnection:\x3c\/span\x3e Keep-Alive\nContent-\x3cspan class=\x22hljs-string\x22\x3eType:\x3c\/span\x3e text\/plain\n\nPOST \x3cspan class=\x22hljs-regexp\x22\x3e\/resources\/\x3c\/span\x3epost-here\x3cspan class=\x22hljs-regexp\x22\x3e\/ HTTP\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eHost:\x3c\/span\x3e bar.other\nUser-\x3cspan class=\x22hljs-string\x22\x3eAgent:\x3c\/span\x3e Mozilla\x3cspan class=\x22hljs-regexp\x22\x3e\/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e20081130\x3c\/span\x3e Minefield\/\x3cspan class=\x22hljs-number\x22\x3e3.1\x3c\/span\x3eb3pre\n\x3cspan class=\x22hljs-string\x22\x3eAccept:\x3c\/span\x3e text\x3cspan class=\x22hljs-regexp\x22\x3e\/html,application\/\x3c\/span\x3exhtml\x2bxml,application\x3cspan class=\x22hljs-regexp\x22\x3e\/xml;q=0.9,*\/\x3c\/span\x3e*;q=\x3cspan class=\x22hljs-number\x22\x3e0.8\x3c\/span\x3e\nAccept-\x3cspan class=\x22hljs-string\x22\x3eLanguage:\x3c\/span\x3e en-us,en;q=\x3cspan class=\x22hljs-number\x22\x3e0.5\x3c\/span\x3e\nAccept-\x3cspan class=\x22hljs-string\x22\x3eEncoding:\x3c\/span\x3e gzip,deflate\nAccept-\x3cspan class=\x22hljs-string\x22\x3eCharset:\x3c\/span\x3e ISO\x3cspan class=\x22hljs-number\x22\x3e-8859\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e,utf\x3cspan class=\x22hljs-number\x22\x3e-8\x3c\/span\x3e;q=\x3cspan class=\x22hljs-number\x22\x3e0.7\x3c\/span\x3e,*;q=\x3cspan class=\x22hljs-number\x22\x3e0.7\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eConnection:\x3c\/span\x3e keep-alive\nX-\x3cspan class=\x22hljs-string\x22\x3ePINGOTHER:\x3c\/span\x3e pingpong\nContent-\x3cspan class=\x22hljs-string\x22\x3eType:\x3c\/span\x3e text\/xml; charset=UTF\x3cspan class=\x22hljs-number\x22\x3e-8\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eReferer:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\/examples\/preflightInvocation.html\x3c\/span\x3e\nContent-\x3cspan class=\x22hljs-string\x22\x3eLength:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e55\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3ePragma:\x3c\/span\x3e no-cache\nCache-\x3cspan class=\x22hljs-string\x22\x3eControl:\x3c\/span\x3e no-cache\n\nArun\n\n\nHTTP\/\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-string\x22\x3eDate:\x3c\/span\x3e Mon, \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e Dec \x3cspan class=\x22hljs-number\x22\x3e2008\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e15\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e40\x3c\/span\x3e GMT\n\x3cspan class=\x22hljs-string\x22\x3eServer:\x3c\/span\x3e Apache\/\x3cspan class=\x22hljs-number\x22\x3e2.0\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.61\x3c\/span\x3e (Unix)\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eVary:\x3c\/span\x3e Accept-Encoding, Origin\nContent-\x3cspan class=\x22hljs-string\x22\x3eEncoding:\x3c\/span\x3e gzip\nContent-\x3cspan class=\x22hljs-string\x22\x3eLength:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e235\x3c\/span\x3e\nKeep-\x3cspan class=\x22hljs-string\x22\x3eAlive:\x3c\/span\x3e timeout=\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, max=\x3cspan class=\x22hljs-number\x22\x3e99\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eConnection:\x3c\/span\x3e Keep-Alive\nContent-\x3cspan class=\x22hljs-string\x22\x3eType:\x3c\/span\x3e text\/plain\n\n[Some GZIP\x3cspan class=\x22hljs-string\x22\x3e\x27d payload]\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e第1至12行，使用一个 OPTIONS 发送了一个“预请求”。浏览器 根据请求参数，决定需要发送一个“预请求”，来探明服务器端是否接受后续真正的请求。 OPTIONS 是 HTTP\/1.1 里的方法，用来获取更多服务器端的信息，是一个不应该对服务器数据造成影响的方法。 随同 OPTIONS 请求，以下两个请求头一起被发送：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Request-Method: POST\nAccess-Control-Request-Headers: X-PINGOTHER\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs oxygene\x22\x3e\x3ccode\x3eAccess-Control-Request-\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eMethod\x3c\/span\x3e:\x3c\/span\x3e POST\nAccess-Control-Request-Headers: X-PINGOTHER\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e请求头Access-Control-Request-Method可以提醒服务器跨站请求将使用POST方法，而请求头Access-Control-Request-Headers则告知服务器该跨站请求将携带一个自定义请求头X-PINGOTHER。这样，服务器就可以决定，在当前情况下，是否接受该跨站请求访问。\x3c\/p\x3e\n\x3cp\x3e第15至27行是服务器的响应。该响应表明，服务器接受了客服端的跨站请求。具体可以看看第18至21行：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Access-Control-Allow-Origin: http:\/\/foo.example\nAccess-Control-Allow-Methods: POST, GET, OPTIONS\nAccess-Control-Allow-Headers: X-PINGOTHER\nAccess-Control-Max-Age: 1728000\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3eAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\x3c\/span\x3e\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eMethods:\x3c\/span\x3e POST, GET, OPTIONS\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eHeaders:\x3c\/span\x3e X-PINGOTHER\nAccess-Control-Max-\x3cspan class=\x22hljs-string\x22\x3eAge:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1728000\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e响应头Access-Control-Allow-Methods表明服务器可以接受POST, GET和 OPTIONS的请求方法。请注意，这个响应头类似于HTTP\/1.1 Allow: response header，但仅限于访问控制的场景下。而响应头Access-Control-Allow-Headers则表示服务器接受自定义请求头X-PINGOTHER。就像Access-Control-Allow-Methods一样，Access-Control-Allow-Headers允许以逗号分隔，传递一个可接受的自定义请求头列表。最后，响应头Access-Control-Max-Age告诉浏览器，本次“预请求”的响应结果有效时间是多久。在上面的例子里，1728000秒代表着20天内，浏览器在处理针对该服务器的跨站请求，都可以无需再发送“预请求”，只需根据本次结果进行判断处理。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader5\x22\x3e附带凭证信息的请求\x3c\/h3\x3e\n\x3cp\x3eXMLHttpRequest和访问控制功能，最有趣的特性就是，发送凭证请求（HTTP Cookies和验证信息）的功能。一般而言，对于跨站请求，浏览器是不会发送凭证信息的。但如果将XMLHttpRequest的一个特殊标志位设置为true，浏览器就将允许该请求的发送。\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3ehttp:\/\/foo.example\x3c\/code\x3e站点的脚本向\x3ccode\x3ehttp:\/\/bar.other\x3c\/code\x3e站点发送一个GET请求，并设置了一个Cookies值。脚本代码如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var invocation = new XMLHttpRequest();\nvar url = \x27http:\/\/bar.other\/resources\/credentialed-content\/\x27;\n    \nfunction callOtherDomain(){\n  if(invocation) {\n    invocation.open(\x27GET\x27, url, true);\n    invocation.withCredentials = true;\n    invocation.onreadystatechange = handler;\n    invocation.send(); \n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e invocation = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e XMLHttpRequest();\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e = \x3cspan class=\x22hljs-string\x22\x3e\x27http:\/\/bar.other\/resources\/credentialed-content\/\x27\x3c\/span\x3e;\n    \n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecallOtherDomain\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(invocation) {\n    invocation.open(\x3cspan class=\x22hljs-string\x22\x3e\x27GET\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n    invocation.withCredentials = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n    invocation.onreadystatechange = handler;\n    invocation.send(); \n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如你所见，第七行代码将XMLHttpRequest的withCredentials标志设置为true，从而使得Cookies可以随着请求发送。因为这是一个简单的GET请求，所以浏览器不会发送一个“预请求”。但是，如果服务器端的响应中，如果没有返回Access-Control-Allow-Credentials: true的响应头，那么浏览器将不会把响应结果传递给发出请求的脚本程序，以保证信息的安全。\x3c\/p\x3e\n\x3cp\x3e客服端与服务器端交互示例如下：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22GET \/resources\/access-control-with-credentials\/ HTTP\/1.1\nHost: bar.other\nUser-Agent: Mozilla\/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko\/20081130 Minefield\/3.1b3pre\nAccept: text\/html,application\/xhtml\x2bxml,application\/xml;q=0.9,*\/*;q=0.8\nAccept-Language: en-us,en;q=0.5\nAccept-Encoding: gzip,deflate\nAccept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7\nConnection: keep-alive\nReferer: http:\/\/foo.example\/examples\/credential.html\nOrigin: http:\/\/foo.example\nCookie: pageAccess=2\n\n\nHTTP\/1.1 200 OK\nDate: Mon, 01 Dec 2008 01:34:52 GMT\nServer: Apache\/2.0.61 (Unix) PHP\/4.4.7 mod_ssl\/2.0.61 OpenSSL\/0.9.7e mod_fastcgi\/2.4.2 DAV\/2 SVN\/1.4.2\nX-Powered-By: PHP\/5.2.6\nAccess-Control-Allow-Origin: http:\/\/foo.example\nAccess-Control-Allow-Credentials: true\nCache-Control: no-cache\nPragma: no-cache\nSet-Cookie: pageAccess=3; expires=Wed, 31-Dec-2008 01:34:53 GMT\nVary: Accept-Encoding, Origin\nContent-Encoding: gzip\nContent-Length: 106\nKeep-Alive: timeout=2, max=100\nConnection: Keep-Alive\nContent-Type: text\/plain\n\n\n[text\/plain payload]\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs groovy\x22\x3e\x3ccode\x3eGET \x3cspan class=\x22hljs-regexp\x22\x3e\/resources\/\x3c\/span\x3eaccess-control-with-credentials\x3cspan class=\x22hljs-regexp\x22\x3e\/ HTTP\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eHost:\x3c\/span\x3e bar.other\nUser-\x3cspan class=\x22hljs-string\x22\x3eAgent:\x3c\/span\x3e Mozilla\x3cspan class=\x22hljs-regexp\x22\x3e\/5.0 (Macintosh; U; Intel Mac OS X 10.5; en-US; rv:1.9.1b3pre) Gecko\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e20081130\x3c\/span\x3e Minefield\/\x3cspan class=\x22hljs-number\x22\x3e3.1\x3c\/span\x3eb3pre\n\x3cspan class=\x22hljs-string\x22\x3eAccept:\x3c\/span\x3e text\x3cspan class=\x22hljs-regexp\x22\x3e\/html,application\/\x3c\/span\x3exhtml\x2bxml,application\x3cspan class=\x22hljs-regexp\x22\x3e\/xml;q=0.9,*\/\x3c\/span\x3e*;q=\x3cspan class=\x22hljs-number\x22\x3e0.8\x3c\/span\x3e\nAccept-\x3cspan class=\x22hljs-string\x22\x3eLanguage:\x3c\/span\x3e en-us,en;q=\x3cspan class=\x22hljs-number\x22\x3e0.5\x3c\/span\x3e\nAccept-\x3cspan class=\x22hljs-string\x22\x3eEncoding:\x3c\/span\x3e gzip,deflate\nAccept-\x3cspan class=\x22hljs-string\x22\x3eCharset:\x3c\/span\x3e ISO\x3cspan class=\x22hljs-number\x22\x3e-8859\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e,utf\x3cspan class=\x22hljs-number\x22\x3e-8\x3c\/span\x3e;q=\x3cspan class=\x22hljs-number\x22\x3e0.7\x3c\/span\x3e,*;q=\x3cspan class=\x22hljs-number\x22\x3e0.7\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eConnection:\x3c\/span\x3e keep-alive\n\x3cspan class=\x22hljs-string\x22\x3eReferer:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\/examples\/credential.html\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eCookie:\x3c\/span\x3e pageAccess=\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e\n\n\nHTTP\/\x3cspan class=\x22hljs-number\x22\x3e1.1\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e200\x3c\/span\x3e OK\n\x3cspan class=\x22hljs-string\x22\x3eDate:\x3c\/span\x3e Mon, \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e Dec \x3cspan class=\x22hljs-number\x22\x3e2008\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e34\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e52\x3c\/span\x3e GMT\n\x3cspan class=\x22hljs-string\x22\x3eServer:\x3c\/span\x3e Apache\x3cspan class=\x22hljs-regexp\x22\x3e\/2.0.61 (Unix) PHP\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e4.4\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.7\x3c\/span\x3e mod_ssl\x3cspan class=\x22hljs-regexp\x22\x3e\/2.0.61 OpenSSL\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e0.9\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.7\x3c\/span\x3ee mod_fastcgi\x3cspan class=\x22hljs-regexp\x22\x3e\/2.4.2 DAV\/\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e SVN\/\x3cspan class=\x22hljs-number\x22\x3e1.4\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.2\x3c\/span\x3e\nX-Powered-\x3cspan class=\x22hljs-string\x22\x3eBy:\x3c\/span\x3e PHP\/\x3cspan class=\x22hljs-number\x22\x3e5.2\x3c\/span\x3e\x3cspan class=\x22hljs-number\x22\x3e.6\x3c\/span\x3e\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eOrigin:\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3ehttp:\x3c\/span\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/foo.example\x3c\/span\x3e\nAccess-Control-Allow-\x3cspan class=\x22hljs-string\x22\x3eCredentials:\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\nCache-\x3cspan class=\x22hljs-string\x22\x3eControl:\x3c\/span\x3e no-cache\n\x3cspan class=\x22hljs-string\x22\x3ePragma:\x3c\/span\x3e no-cache\nSet-\x3cspan class=\x22hljs-string\x22\x3eCookie:\x3c\/span\x3e pageAccess=\x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e; expires=Wed, \x3cspan class=\x22hljs-number\x22\x3e31\x3c\/span\x3e-Dec\x3cspan class=\x22hljs-number\x22\x3e-2008\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e01\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e34\x3c\/span\x3e:\x3cspan class=\x22hljs-number\x22\x3e53\x3c\/span\x3e GMT\n\x3cspan class=\x22hljs-string\x22\x3eVary:\x3c\/span\x3e Accept-Encoding, Origin\nContent-\x3cspan class=\x22hljs-string\x22\x3eEncoding:\x3c\/span\x3e gzip\nContent-\x3cspan class=\x22hljs-string\x22\x3eLength:\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e106\x3c\/span\x3e\nKeep-\x3cspan class=\x22hljs-string\x22\x3eAlive:\x3c\/span\x3e timeout=\x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e, max=\x3cspan class=\x22hljs-number\x22\x3e100\x3c\/span\x3e\n\x3cspan class=\x22hljs-string\x22\x3eConnection:\x3c\/span\x3e Keep-Alive\nContent-\x3cspan class=\x22hljs-string\x22\x3eType:\x3c\/span\x3e text\/plain\n\n\n[text\/plain payload]\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e虽然第11行指定了要提交到\x3ccode\x3ehttp:\/\/bar.other\x3c\/code\x3e的内容的Cookie信息,但是如果bar.other的响应头里没有Access-Control-Allow-Credentials:true(第19行),则响应会被忽略. 特别注意: 给一个带有withCredentials的请求发送响应的时候,服务器端必须指定允许请求的域名,不能使用\x27\x3cem\x3e\x27.上面这个例子中,如果响应头是这样的:Access-Control-Allow-Origin: \x3c\/em\x3e ,则响应会失败. 在这个例子里,因为Access-Control-Allow-Origin的值是\x3ccode\x3ehttp:\/\/foo.example\x3c\/code\x3e这个指定的请求域名,所以客户端把带有凭证信息的内容被返回给了客户端. 另外注意第22行,更多的cookie信息也被创建了\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e参考\x3c\/h2\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/www.w3.org\/TR\/cors\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eCross-Origin Resource Sharing Standard\x3c\/a\x3e\x3cbr\x3e\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Web\/Security\/Same-origin_policy\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eSame-origin_policy\x3c\/a\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>理解 CORS (Cross-Origin Resource Sharing)</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005125790">https://segmentfault.com/a/1190000005125790</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qj800atjw7c/" target="_blank">https://alili.tech/archive/qj800atjw7c/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>