<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="[聊一聊系列]聊一聊HTTPS那些事儿"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>[聊一聊系列]聊一聊HTTPS那些事儿 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/rf33buccq57/",
				"appid": "1613049289050283", 
				"title": "[聊一聊系列]聊一聊HTTPS那些事儿 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-06T02:30:08"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/81yhc0ufm04/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/mtccujmdz8f/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f&text=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f&text=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f&is_video=false&description=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2frf33buccq57%2f&title=%5b%e8%81%8a%e4%b8%80%e8%81%8a%e7%b3%bb%e5%88%97%5d%e8%81%8a%e4%b8%80%e8%81%8aHTTPS%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">[聊一聊系列]聊一聊HTTPS那些事儿</h1><div class="meta"><div class="postdate"><time datetime="2019-02-06" itemprop="datePublished">2019-02-06</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e欢迎大家收看聊一聊系列，这一套系列文章，可以帮助前端工程师们了解前端的方方面面（不仅仅是代码）：\x3cbr\x3e\x3ca href=\x22https:\/\/segmentfault.com\/blog\/frontenddriver\x22\x3ehttps:\/\/segmentfault.com\/blog...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e相信很多前端同学们，都听说过https，现在很多大的站点（如天猫、百度等），均使用了https协议进行传输。但是https如何使用，做什么用的，往往并不十分了解。今天我们就来一起聊一聊HTTPS那些事儿，且不说底层实现(毕竟想深入学习的同学可以自行百度)，只来聊一聊我们如何使用这种方式来武装我们的网站~~也谈一谈实际应用时的一些问题。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e1. 什么是https\x3c\/h2\x3e\n\x3cp\x3ehttps是http的加密版本，是在http请求的基础上，采用ssl进行加密传输。\x3c\/p\x3e\n\x3cp\x3e咱们平时的http请求是明文传输，也就是说，如果经过电信运营商(电信、移动等，或者方正等)，传输过程中，信息是可以被截获的(网站的form表单、html等)。有些运营商甚至会劫持你的网站(稍后详细讲解).那么网页如果进行了加密，在客户端与服务端的传输过程中，咱们的https请求内容即使被截获了，也无法读取其内容，或者加入一些劫持者想要的效果。笔者认为，如果网站有涉及到一些私密信息，或者网站本身的流量比较大，可以产生一些经济价值的话，都尽量使用https进行传输。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e2. 做什么用呢？\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e2.1 加密数据\x3c\/h3\x3e\n\x3cp\x3e你的网站如果有登录这种东西的话建议尽量使用https做，这样可以保证用户名、密码不被截获。咱们平时使用的post请求中所带的用户名密码等，非常容易被获取到。这点正如你小时候写小纸条的时候，让同学传递显然不安全，谁知道纸条传到前排同学之前，会不会被老师拦截呢。很多大网站均已采用了https，比如，一号店网站的首页，虽然是http协议的(如图2.1.1)，但是登录的页面，使用的却是https协议(如图2.1.2，想必也是为了登录安全性)。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAat8\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAat8\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.1.1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAat9\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAat9\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.1.2\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader3\x22\x3e2.2 反劫持\x3c\/h3\x3e\n\x3cp\x3e劫持这种东西，最典型的例子，应该就是，有的时候手机上浏览网站的时候，会有小圆球提醒你流量已经用了百分之多少了。如果猜的没错的话，应该是移动运营商劫持了网页，并将流量提醒插在这些网页中的。这点也正如，你传了个小纸条给同学，中间说不准就被谁把原话给改掉了。\x3c\/p\x3e\n\x3cp\x3e别以为劫持只是在你的网页里面插一些小广告，既然连广告都插得了，插一些js把你的cookie传到自己服务器上，也不是什么难事儿。亦或者做个钓鱼网页，让用户输入用户名和密码，也是非常容易的。所以，劫持是一件非常恐怖的事情。我们使用了https进行加密的话，则可以在大部分情况下规避这种危害。https加密后，中间商们无法再随意向加过密的html内容中插入的自己的代码了。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader4\x22\x3e2.3 SEO\x3c\/h3\x3e\n\x3cp\x3e其实谷歌对于https的网站，搜索结果会给予更高的排名。国内的话，主要还是使用百度搜索引擎，但是百度搜索引擎目前只收录少部分的https网页，目前百度不主动抓取https页面。所以，如果是国内网站需要做seo的话，建议每张网页都提供http\/https两种版本的访问方式。或者主页面、需要被抓取的页面使用http方式，而登录等功能采用https方式(就像一号店，或者京东)，如我们在百度中搜索京东商城(如图2.3.1)，其实点击进入的是京东的http版本(如图2.3.2)。其实，京东是提供https访问的(如图2.3.3)，这里怀疑与seo有关。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAavJ\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAavJ\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.3.1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAavO\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAavO\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.3.2\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAav7\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAav7\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图2.3.3\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e3. 如何开启https\x3c\/h2\x3e\n\x3cp\x3e这里，我们使用nginx来简单的了解一下https的使用方式。\x3c\/p\x3e\n\x3cp\x3e由于我们是在本地实验，所以可以先使用一个本地生成的证书进行实验。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e3.1 生成私钥与证书\x3c\/h3\x3e\n\x3cp\x3e首先进入一个生成证书的目录下(自己随便建一个就好)，你需要执行一下命令(如果接下来，没有权限的话，\x3ccode\x3eserver.key: Permission denied\x3c\/code\x3e则加上sodu就好了)\x3c\/p\x3e\n\x3cp\x3e执行下面的命令，并按照提示，输入口令，接下来，凡是提示需要输入口令的地方，都需要输入这个口令：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22openssl genrsa -des3 -out server.key 1024\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs lsl\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eopenssl genrsa -des3 -out server.\x3cspan class=\x22hljs-type\x22\x3ekey\x3c\/span\x3e \x3cspan class=\x22hljs-number\x22\x3e1024\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22openssl req -new -key server.key -out server.csr\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs axapta\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eopenssl req -\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e -key \x3cspan class=\x22hljs-keyword\x22\x3eserver\x3c\/span\x3e.key -out \x3cspan class=\x22hljs-keyword\x22\x3eserver\x3c\/span\x3e.csr\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22openssl rsa -in server.key -out server.key.out\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eopenssl rsa -\x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e server\x3cspan class=\x22hljs-selector-class\x22\x3e.key\x3c\/span\x3e -out server\x3cspan class=\x22hljs-selector-class\x22\x3e.key\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.out\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e标记私钥与证书\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22openssl x509 -req -days 365 -in server.csr -signkey server.key.out -out server.crt\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3eopenssl x509 -req -days \x3cspan class=\x22hljs-number\x22\x3e365\x3c\/span\x3e -\x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e server\x3cspan class=\x22hljs-selector-class\x22\x3e.csr\x3c\/span\x3e -signkey server\x3cspan class=\x22hljs-selector-class\x22\x3e.key\x3c\/span\x3e\x3cspan class=\x22hljs-selector-class\x22\x3e.out\x3c\/span\x3e -out server.crt\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e3.2 配置nginx\x3c\/h3\x3e\n\x3cp\x3e如下所示，配置nginx，ssl_certificate的路径，写成刚刚生成证书的路径即可，ssl_certificate_key也写为刚刚生成私钥的路径即可，如图3.2.1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaHt\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaHt\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图3.2.1\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3e3.3 重启nginx，查看效果\x3c\/h3\x3e\n\x3cp\x3e访问\x3ca href=\x22https:\/\/localhost\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/localhost\x3c\/a\x3e时，可能会弹出这种警告(如图3.3.1)，或者这种警告(如图3.3.2)，直接继续就好，这是因为咱们的证书是自己手动生成的。接下来就能看到效果了(如图3.3.3)。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaHF\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaHF\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图3.3.1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaHY\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaHY\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图3.3.2\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaJt\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaJt\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图3.3.3\x3c\/p\x3e\n\x3cp\x3e如果想接下来不弹出这种警告，就要在浏览器中安装自己生成的证书了。浏览器安装证书，步骤如下，想了解的同学自行百度一下\x22chrome导入https证书\x22，把自己的证书crt文件导入即可。使用其他类型的server的同学，可以自己查一下，如何配置server的https服务。还有，需要做线上服务的同学，尽量使用证书机构颁发的证书，(现在有很多免费的证书)，这样不会给用户弹出一些奇怪的界面。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader9\x22\x3e4. 网站如何适配？\x3c\/h2\x3e\n\x3cp\x3e如果我们想要将自己的网站https化，那么其中的资源肯定是需要均为https协议传输的。否则，如果一个https的网站，使用了http的资源的话，那么这个资源被劫持，整个网站也相当于被劫持了。这就没有意义了。而且，很多http的资源在https的环境下，浏览器甚至都不让其加载。接下来我们就来盘点一下https的网站中引入的资源的一些问题。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e4.1 http资源无法加载\x3c\/h3\x3e\n\x3cp\x3e在https环境下，http协议的js\/css\/请求\/iframe等资源是根本加载不进来的(如图4.1.1)。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaKM\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaKM\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图4.1.1\x3c\/p\x3e\n\x3cp\x3e所以，如果想要使用这些资源的话，需要把访问这些资源的方式，转换为https，稍后会说道如何解决。我们称这种https页面中引用http资源的方式为\x22mix content\x22\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3e4.2 图片\/视频\/音频的特殊性\x3c\/h3\x3e\n\x3cp\x3e为什么要单独拿出这些资源说一下呢，在w3c的规范中，这些资源本应该也和其他静态资源一样---https的环境下，引用http的图片是会被阻止掉的。笔者在去年实践的时候，chrome等主流浏览器还是会阻止这些http资源的加载的。也就是说，https的页面引用http的图片的话，图会裂掉。\x3c\/p\x3e\n\x3cp\x3e可是，新版的chrome并没有按照规范去做。而是在https的环境下，依然可以加载并展示http的图片\/视频\/音频等资源(如图4.2.1)。这是因为，其实很多目前互联网上的很多网站，还是比较混乱的，为了保证整个互联网的用户体验，chrome等浏览器，对于这种加载还是进行了宽容对待。可是，就算是这样，也不代表我们应该再https的页面中加载http的资源，毕竟，这样会失去我们最初https加密的意义，安全的网页上加载了不安全的资源，整个网页还是不安全的。\x3cstrong\x3e所以笔者建议，即使加载http的图片资源可以展示，还是规范读者们不要这样做。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaNg\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaNg\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图4.2.1\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e4.3 如何解决混合资源加载问题\x3c\/h3\x3e\n\x3ch5\x3e1 动态判断与协议相对URL\x3c\/h5\x3e\n\x3cp\x3e比如京东商城，在访问\x3ca href=\x22http:\/\/www.jd.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.jd.com\x3c\/a\x3e的时候，css是使用http协议加载的，如图4.3.1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaMu\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaMu\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图4.3.1\x3c\/p\x3e\n\x3cp\x3e在使用\x3ca href=\x22https:\/\/www.jd.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.jd.com\x3c\/a\x3e的时候，静态资源均变成了相应域名的https地址，如图4.3.2\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaMF\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaMF\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图4.3.2\x3c\/p\x3e\n\x3cp\x3e笔者更建议的是，如果自己的静态服务器，两种协议均支持(即\x3ca href=\x22http:\/\/xxx.com\/a.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/xxx.com\/a.js\x3c\/a\x3e与\x3ca href=\x22https:\/\/xxx.com\/a.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/xxx.com\/a.js\x3c\/a\x3e均可支持访问)的话，则直接在引用资源的时候，去掉协议头，改为相对协议，如\/\/xxx.com\/a.js。这样，请求a.js这个资源的时候，浏览器会按照当前页面的协议，进行请求，这叫做-----\x22协议相对地址\x22\x3c\/p\x3e\n\x3cp\x3e比如京东商城中的一个js资源(如图4.3.3)，写的便是协议相对地址：\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAa3j\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAa3j\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图4.3.3\x3c\/p\x3e\n\x3cp\x3e再http的环境下，请求的便是以http为开头的此资源(如图4.3.4)。在https的环境下，请求的便是https为开头的此资源(如图4.3.5)\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAa3J\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAa3J\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图4.3.4\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAa38\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAa38\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图4.3.5\x3c\/p\x3e\n\x3ch5\x3e2 自己做个https代理\x3c\/h5\x3e\n\x3cp\x3e如果自己的资源服务，不支持https访问的话，我们可以采用代理的方式，来引入这些文件。最简单的方式就是使用nginx，将引入的静态文件均做个代理。也就是说，访问资源的时候，用的是咱们的代理地址，但是拿文件的时候，还是会去http的源地址去拿的。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader13\x22\x3e5. 速度影响\x3c\/h2\x3e\n\x3cp\x3e使用https对网站传输进行加密，虽然有很多好处，但是也有弊端，那就是\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader14\x22\x3e5.1 加密\/解密的过程是需要消耗时间的\x3c\/h3\x3e\n\x3cp\x3e毕竟需要对传输的数据进行加密\/解密，算法耗时是肯定有的。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader15\x22\x3e5.2 交换公钥\/私钥消耗时间\x3c\/h3\x3e\n\x3cp\x3ehttps传输在传输之前是需要再服务端与客户端交换公钥\/私钥的，这个过程也是非常耗时的。有统计称https的链接耗时是http的连接耗时的3倍。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader16\x22\x3e5.3 跳转消耗时间\x3c\/h3\x3e\n\x3cp\x3e这里还有一个影响速度的点，那就是用户在浏览器中输入网址的时候，是不会去自己输入https协议头的，如果你在浏览器中输入www.jd.com的话，默认浏览器访问的是\x3ca href=\x22http:\/\/www.jd.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.jd.com\x3c\/a\x3e的，如果我们想要用户访问https的网站的话，就要自己进行一次网页重定向，重定向也是比较耗时的操作。这都会对我们的网站速度造成影响。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader17\x22\x3e6. HSTS\x3c\/h2\x3e\n\x3cp\x3e在第5节中，我们提到了，如果用户在浏览器端，输入www.jd.com实际上，浏览器会默认将这个网址补全为\x3ca href=\x22http:\/\/www.jd.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.jd.com\x3c\/a\x3e而不是\x3ca href=\x22https:\/\/www.jd.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.jd.com\x3c\/a\x3e。于是乎，我们如果想让用户访问我们的https版本网站，还得将页面强行重定向(跳转)一下。这是一个比较耗时的操作。而且有些时候，还没等我们重定向网页呢，就被运营商给劫持了。于是，接下来也跳不了了。怎么办？能不能在用户输入www.jd.com的时候，直接就访问到\x3ca href=\x22https:\/\/www.jd.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/www.jd.com\x3c\/a\x3e呢？当然可以，我们需要介绍一下我们的新武器了-------HSTS。\x3c\/p\x3e\n\x3cp\x3e其实hsts的做法比较简单，只要在用户访问网站的时候，响应头中加入\x3ccode\x3eStrict-Transport-Security\x3c\/code\x3e这个头，浏览器接下来的访问就均会默认采用https的方式进行访问了。我们看到天猫在网站中加入了这个头部(如图6.1)，我们下次直接输入网址\x3ca href=\x22http:\/\/www.tmall.com\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.tmall.com\x3c\/a\x3e的时候，就可以看到，浏览器提前做了浏览器的内部跳转，如图6.2\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaRa\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaRa\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图6.1\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVAaRd\x22 src=\x22https:\/\/static.alili.tech\/img\/bVAaRd\x22 alt=\x22clipboard.png\x22 title=\x22clipboard.png\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3cbr\x3e图6.2\x3c\/p\x3e\n\x3cp\x3e建议使用https的站长们都加上这个头部，即提升了网站速度，又提高了网站的安全性。何乐而不为呢。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader18\x22\x3e7. 课后作业\x3c\/h2\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e本文中没有详细的描述https是如何加密解密的，同学们可以详细的去学习一下\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e回想一下自己的网站使用https是否适合呢？又是否已经使用了呢？\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e接下来的一篇文章，我将会和读者们一起\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000006672214\x22\x3e聊聊web前端安全那些事儿\x3c\/a\x3e，不要走开，请关注我.....\x3c\/p\x3e\n\x3cp\x3e\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000006672214\x22 target=\x22_blank\x22\x3ehttps:\/\/segmentfault.com\/a\/11...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e如果喜欢本文请点击下方的推荐哦，你的推荐会变为我继续更文的动力。\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e以上内容仅代表笔者个人观点，如有意见请通知笔者。\x3c\/strong\x3e\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>[聊一聊系列]聊一聊HTTPS那些事儿</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000006199237">https://segmentfault.com/a/1190000006199237</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/rf33buccq57/" target="_blank">https://alili.tech/archive/rf33buccq57/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>