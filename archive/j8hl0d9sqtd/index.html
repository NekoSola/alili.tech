<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="来！我们一起来从头开始构建自己的JavaScript模块化工具"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>来！我们一起来从头开始构建自己的JavaScript模块化工具 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/j8hl0d9sqtd/",
				"appid": "1613049289050283", 
				"title": "来！我们一起来从头开始构建自己的JavaScript模块化工具 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-09T02:30:59"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/lhvjjcerwbs/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/5shjve5m9xe/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f&text=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f&text=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f&title=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f&is_video=false&description=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f&title=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f&title=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f&title=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fj8hl0d9sqtd%2f&title=%e6%9d%a5%ef%bc%81%e6%88%91%e4%bb%ac%e4%b8%80%e8%b5%b7%e6%9d%a5%e4%bb%8e%e5%a4%b4%e5%bc%80%e5%a7%8b%e6%9e%84%e5%bb%ba%e8%87%aa%e5%b7%b1%e7%9a%84JavaScript%e6%a8%a1%e5%9d%97%e5%8c%96%e5%b7%a5%e5%85%b7"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">来！我们一起来从头开始构建自己的JavaScript模块化工具</h1><div class="meta"><div class="postdate"><time datetime="2019-02-09" itemprop="datePublished">2019-02-09</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch2 id=\x22articleHeader0\x22\x3e前言\x3c\/h2\x3e\n\x3cp\x3e希望编写程序能像玩积木一样，首先规划要产出怎样的作品，然后在积木堆中挑选合适的积木块，最后一组合就完工了。\x3c\/p\x3e\n\x3cp\x3e于是JavaScript需要类似这样模块化，每个模块都隐藏内部细节并且对外暴露接口，再处理好模块之间的依赖关系，就可以达到玩积木的效果了。\x3c\/p\x3e\n\x3cp\x3e虽然现有很多模块化框架／工具，但对于新手来说，为什么不自己撸一个简单的模块化工具呢？\x3c\/p\x3e\n\x3cp\x3e希望通过这个工具把自己觉得好用的代码以模块的方式组织起来，渐渐形成自己的JS库，之后可以勇敢地和HR说，自己的小项目用的是自己小JS库，^_^。我觉得，在这个封装的过程中，新手能学习到很多东西。\x3c\/p\x3e\n\x3cp\x3e新手嘛，多造轮子总是有好处的，=_=。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e从闭包到模块\x3c\/h2\x3e\n\x3cp\x3e以下是《你所不知道的JavaScript（上卷）》中对于闭包的说明。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e当函数可以记住并访问所在的词法作用域，即使函数是在当前词法作用域之外执行，这时就产生了闭包。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e其实，不管怎样，闭包正如其字面意思一样，既能提供一个相对封闭的空间，也能向外界暴露必要的接口。这不就正符合我们模块化的需求吗？\x3c\/p\x3e\n\x3cp\x3e在此，建议参考这篇文章，以加强您对闭包的理解：\x3ca href=\x22https:\/\/segmentfault.com\/a\/1190000005056334\x22\x3e《假如技术HR问您JavaScript的“闭包”，嘿嘿嘿，举这个例子就够了》\x3c\/a\x3e。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e最简单的模块\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var test = (function test(){\n    function run(){\n        console.log(\x26quot;run test\x26quot;);\n    }\n    return {\n        run: run\n    };\n})();\ntest.run();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e test = (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etest\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erun\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22run test\x22\x3c\/span\x3e);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3erun\x3c\/span\x3e: run\n    };\n})();\ntest.run();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e上面的代码有个叫test的函数作为模块创建器，每次调用它都可以创建一个新的模块。这里使用立即执行函数，立即创建了一个test模块。参考闭包的概念，外部可以调用test模块中的run函数，同时test模块又有自己独立的作用域。能达到一个积木块（模块）的要求。\x3c\/p\x3e\n\x3cp\x3e简单的模块这样写没有问题，但是模块间的依赖问题没有解决。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e最简单的模块管理工具\x3c\/h2\x3e\n\x3cp\x3e模块之间必然会存在依赖关系，而模块管理工具需要能够很好地管理模块间的依赖。下面我们模仿实现了AMD规范的工具requirejs，主要是模仿其define，get的API风格，自己写一个简单的版本。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/模块管理工具，MyModules\nvar MyModules = (function Manager() {\n    var modules = {};\n    function define(name, deps, impl) {\n        for (var i=0; i\x3cdeps.length; i\x2b\x2b){\n            \/\/将依赖的名字替换成已经注册了的模块\n            deps[i] = modules[deps[i]];\n        }\n        \/\/将依赖数组展开成参数传入模块的构建函数，生成新模块\n        modules[name] = impl.apply(impl, deps);\n    }\n    function get(name){\n        return modules[name];\n    }\n    return {\n        define: define,\n        get: get\n    }\n})();\n\/\/定义一个模块，data\nMyModules.define(\x26quot;data\x26quot;,[],function(){\n    var name = \x26quot;miku\x26quot;;\n    function getName(){\n        return name;\n    }\n    return {\n        getName:getName\n    }\n});\n\/\/定义一个模块，app\n\/\/该模块依赖data模块\nMyModules.define(\x26quot;app\x26quot;, [\x26quot;data\x26quot;], function(data){\n    function run(){\n        console.log(data.getName());\n    }\n    return {\n        run:run\n    }\n});\n\/\/取出app模块\nvar app = MyModules.get(\x26quot;app\x26quot;);\n\/\/调用app模块的run方法\napp.run();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-comment\x22\x3e\/\/模块管理工具，MyModules\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e MyModules = (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eManager\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e modules = {};\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edefine\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename, deps, impl\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i\x26lt;deps.length; i\x2b\x2b){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/将依赖的名字替换成已经注册了的模块\x3c\/span\x3e\n            deps[i] = modules[deps[i]];\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/将依赖数组展开成参数传入模块的构建函数，生成新模块\x3c\/span\x3e\n        modules[name] = impl.apply(impl, deps);\n    }\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eget\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e modules[name];\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3edefine\x3c\/span\x3e: define,\n        \x3cspan class=\x22hljs-attr\x22\x3eget\x3c\/span\x3e: get\n    }\n})();\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/定义一个模块，data\x3c\/span\x3e\nMyModules.define(\x3cspan class=\x22hljs-string\x22\x3e\x22data\x22\x3c\/span\x3e,[],\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e name = \x3cspan class=\x22hljs-string\x22\x3e\x22miku\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3egetName\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e name;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3egetName\x3c\/span\x3e:getName\n    }\n});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/定义一个模块，app\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/该模块依赖data模块\x3c\/span\x3e\nMyModules.define(\x3cspan class=\x22hljs-string\x22\x3e\x22app\x22\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x22data\x22\x3c\/span\x3e], \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)\x3c\/span\x3e{\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3erun\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(data.getName());\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3erun\x3c\/span\x3e:run\n    }\n});\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/取出app模块\x3c\/span\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e app = MyModules.get(\x3cspan class=\x22hljs-string\x22\x3e\x22app\x22\x3c\/span\x3e);\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/调用app模块的run方法\x3c\/span\x3e\napp.run();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以看出，利用MyModules可以很方便地定义使用模块，管理模块依赖。但是还存在一个问题，MyModules对于模块定义的顺序有要求。以上面的例子来说，就是app模块依赖data模块，那data模块必须在app模块之前被定义。这个限制让我们实际使用中不是很方便。接下来我们将改进它。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e改进模块管理工具\x3c\/h2\x3e\n\x3cp\x3e我们需要让模块管理工具不需要限制模块的定义顺序，这里我的做法是，使用一个rebuilds数组来保存未成功构建的模块。每次有新模块构建成功的时候就会重新尝试去构建整个rebuilds数组中的模块。具体看下面的代码。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22window.mm_modules = (function Manager() {\n    var debug = false;\n    var modules = {};\n    var rebuilds = [];\n    function copyArray (array){\n        var tempArray = [];\n        for(var i=0; i\x3carray.length; i\x2b\x2b){\n            tempArray.push(array[i]);\n        }\n        return tempArray;\n    }\n    function define(name, deps, impl) {\n        \/\/判断依赖构建是否成功\n        var depsDone = true;\n        \n        \/\/拷贝一份当前想要构建的模块，当构建失败时使用\n        var rebuildCopy = {\n            name : name,\n            deps : copyArray(deps),\n            impl : impl\n        };\n        \n        \/\/循环依赖数组，构建依赖\n        for (var i=0; i\x3cdeps.length; i\x2b\x2b){\n            \/\/将依赖的名字替换成已经注册了的模块\n            deps[i] = modules[deps[i]];\n            \/\/有依赖的模块未定义，所以这个模块构建失败\n            if(!deps[i]){\n                depsDone = false;\n                break;\n            }\n        }\n        \n        \/\/如果依赖构建成功，即模块构建成功\n        if(depsDone){\n            \/\/将依赖数组展开成参数传入模块的构建函数，生成新模块\n            modules[name] = impl.apply(impl, deps);\n            \/\/从rebuilds数组中移除\n            if(rebuilds[name]){\n               delete rebuilds[name];\n            }\n            \/\/循环rebuilds数组，尝试从新构建之前构建失败的模块\n            for (key in rebuilds){\n                var rebuild = rebuilds[key];\n                if(rebuild){\n                    \/\/递归调用\n                    define(rebuild.name, rebuild.deps, rebuild.impl);\n                }\n            }\n        }\n        \/\/模块构建失败，存入rebuilds数组中，等待下一次重新构建\n        else{\n            rebuilds[name] = rebuildCopy;\n        }\n        if(debug){\n            console.log(\x26quot;[mm_modules debug]need rebuild modules:\x26quot;, rebuilds);\n        }\n    }\n    function get(name){\n        return modules[name];\n    }\n    return {\n        define: define,\n        get: get\n    }\n})();\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-built_in\x22\x3ewindow\x3c\/span\x3e.mm_modules = (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eManager\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e debug = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e modules = {};\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e rebuilds = [];\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ecopyArray\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3earray\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e tempArray = [];\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i\x26lt;array.length; i\x2b\x2b){\n            tempArray.push(array[i]);\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e tempArray;\n    }\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3edefine\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename, deps, impl\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/判断依赖构建是否成功\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e depsDone = \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n        \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/拷贝一份当前想要构建的模块，当构建失败时使用\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e rebuildCopy = {\n            \x3cspan class=\x22hljs-attr\x22\x3ename\x3c\/span\x3e : name,\n            \x3cspan class=\x22hljs-attr\x22\x3edeps\x3c\/span\x3e : copyArray(deps),\n            \x3cspan class=\x22hljs-attr\x22\x3eimpl\x3c\/span\x3e : impl\n        };\n        \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/循环依赖数组，构建依赖\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i=\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e; i\x26lt;deps.length; i\x2b\x2b){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/将依赖的名字替换成已经注册了的模块\x3c\/span\x3e\n            deps[i] = modules[deps[i]];\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/有依赖的模块未定义，所以这个模块构建失败\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!deps[i]){\n                depsDone = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n                \x3cspan class=\x22hljs-keyword\x22\x3ebreak\x3c\/span\x3e;\n            }\n        }\n        \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/如果依赖构建成功，即模块构建成功\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(depsDone){\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/将依赖数组展开成参数传入模块的构建函数，生成新模块\x3c\/span\x3e\n            modules[name] = impl.apply(impl, deps);\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/从rebuilds数组中移除\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(rebuilds[name]){\n               \x3cspan class=\x22hljs-keyword\x22\x3edelete\x3c\/span\x3e rebuilds[name];\n            }\n            \x3cspan class=\x22hljs-comment\x22\x3e\/\/循环rebuilds数组，尝试从新构建之前构建失败的模块\x3c\/span\x3e\n            \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (key \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e rebuilds){\n                \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e rebuild = rebuilds[key];\n                \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(rebuild){\n                    \x3cspan class=\x22hljs-comment\x22\x3e\/\/递归调用\x3c\/span\x3e\n                    define(rebuild.name, rebuild.deps, rebuild.impl);\n                }\n            }\n        }\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/模块构建失败，存入rebuilds数组中，等待下一次重新构建\x3c\/span\x3e\n        \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e{\n            rebuilds[name] = rebuildCopy;\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(debug){\n            \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-string\x22\x3e\x22[mm_modules debug]need rebuild modules:\x22\x3c\/span\x3e, rebuilds);\n        }\n    }\n    \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eget\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3ename\x3c\/span\x3e)\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e modules[name];\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-attr\x22\x3edefine\x3c\/span\x3e: define,\n        \x3cspan class=\x22hljs-attr\x22\x3eget\x3c\/span\x3e: get\n    }\n})();\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e改进后的模块管理工具，能够自动地处理模块依赖，而不需要限制定义顺序了。\x3cbr\x3e那，能不能更进一步呢？试着想一下，我们日常会怎么使用？单文件单模块，然后把这些文件放在不同文件夹里组织好。于是，我就想到使用gulp这样的工具辅助我们。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3egulp辅助\x3c\/h2\x3e\n\x3cp\x3e请参考下面的目录结构。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22├── dist\n│\x26nbsp;\x26nbsp; ├── index.html\n│\x26nbsp;\x26nbsp; └── js\n│\x26nbsp;\x26nbsp;     └── mm-modules-build.js\n├── gulpfile.js\n├── mm-modules\n│\x26nbsp;\x26nbsp; ├── queryObject.js\n│\x26nbsp;\x26nbsp; ├── request.js\n│\x26nbsp;\x26nbsp; ├── template.js\n│\x26nbsp;\x26nbsp; ├── test.js\n│\x26nbsp;\x26nbsp; └── util.js\n├── mm-modules.js\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs stylus\x22\x3e\x3ccode\x3e├── dist\n│\x26nbsp;\x26nbsp; ├── index\x3cspan class=\x22hljs-selector-class\x22\x3e.html\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; └── js\n│\x26nbsp;\x26nbsp;     └── mm-modules-build\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n├── gulpfile\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n├── mm-modules\n│\x26nbsp;\x26nbsp; ├── queryObject\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; ├── request\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; ├── template\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; ├── test\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n│\x26nbsp;\x26nbsp; └── util\x3cspan class=\x22hljs-selector-class\x22\x3e.js\x3c\/span\x3e\n├── mm-modules.js\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e可以在mm-modules下随意地定义模块，如util模块内有各种工具函数，template模块则包含了artTemplate模版引擎。之后利用gulp将mm-modules.js（模块管理工具）与mm-modules下所有的模块文件打包成mm-modules-build.js。项目中只要引入mm-modules-build.js即可。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e结尾\x3c\/h2\x3e\n\x3cp\x3e到此，我们自己构建了一个很实用的JavaScript模块化工具，项目的源码在这里：\x3ca href=\x22https:\/\/github.com\/MIKUScallion\/mm-modules\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/github.com\/MIKUScallion\/mm-modules\x3c\/a\x3e，喜欢的话，给个✨。\x3c\/p\x3e\n\x3cp\x3e再回顾一下前言的话。\x3c\/p\x3e\n\x3cblockquote\x3e\n\x3cp\x3e希望通过这个工具把自己觉得好用的代码以模块的方式组织起来，渐渐形成自己的JS库，之后可以勇敢地和HR说，自己的小项目用的是自己小JS库，^_^。我觉得，在这个封装的过程中，新手能学习到很多东西。\x3c\/p\x3e\n\x3cp\x3e新手嘛，多造轮子总是有好处的，=_=。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader7\x22\x3e参考\x3c\/h2\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e《你所不知道的JavaScript（上卷）》\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>来！我们一起来从头开始构建自己的JavaScript模块化工具</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005621376">https://segmentfault.com/a/1190000005621376</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/j8hl0d9sqtd/" target="_blank">https://alili.tech/archive/j8hl0d9sqtd/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>