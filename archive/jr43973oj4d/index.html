<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="【译】渐进式 Web App 的离线存储"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>【译】渐进式 Web App 的离线存储 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/jr43973oj4d/",
				"appid": "1613049289050283", 
				"title": "【译】渐进式 Web App 的离线存储 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-05T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/eyvn9ahzwtc/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/r4i0ifpfql8/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f&text=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f&text=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f&title=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f&is_video=false&description=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f&title=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f&title=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f&title=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fjr43973oj4d%2f&title=%e3%80%90%e8%af%91%e3%80%91%e6%b8%90%e8%bf%9b%e5%bc%8f%20Web%20App%20%e7%9a%84%e7%a6%bb%e7%ba%bf%e5%ad%98%e5%82%a8"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">【译】渐进式 Web App 的离线存储</h1><div class="meta"><div class="postdate"><time datetime="2019-02-05" itemprop="datePublished">2019-02-05</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e拖拖拉拉好久，终于把个人博客整出来了。鸣谢 @pinggod。\x3c\/p\x3e\n\x3cp\x3e厚着脸安利一下，地址是 \x3ca href=\x22http:\/\/www.wemlion.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.wemlion.com\/\x3c\/a\x3e。欢迎访问，欢迎收藏。\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3e本文转载自：\x3ca href=\x22http:\/\/www.zcfy.cc\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e众成翻译\x3c\/a\x3e\x3cbr\x3e译者：\x3ca href=\x22http:\/\/www.zcfy.cc\/@wemlin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e文蔺\x3c\/a\x3e\x3cbr\x3e链接：\x3ca href=\x22http:\/\/www.zcfy.cc\/article\/1067\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.zcfy.cc\/article\/1067\x3c\/a\x3e\x3cbr\x3e原文：\x3ca href=\x22https:\/\/medium.com\/@addyosmani\/offline-storage-for-progressive-web-apps-70d52695513c\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/medium.com\/@addyosmani\/offline-storage-for-progressive-web-apps-70d52695513c\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006760620\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006760620\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cp\x3e2016 很可能成为\x3cstrong\x3e网络弹性\x3c\/strong\x3e（network resilience）元年。\x3c\/p\x3e\n\x3cp\x3e网络连接很可能\x3cstrong\x3e不靠谱\x3c\/strong\x3e（flakey），或者根本就连不上，这也是为什么在 \x3ca href=\x22https:\/\/developers.google.com\/web\/progressive-web-apps\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e渐进式 Web App\x3c\/a\x3e（译者注：Progressive Web App，以下简称 \x3ccode\x3ePWA\x3c\/code\x3e） 中，支持离线和性能可靠都很重要。本文总结了关于 PWA \x3cstrong\x3e离线数据存储\x3c\/strong\x3e的一些创意。想想那些提供\x3cem\x3e有意义的\x3c\/em\x3e离线体验所需要的 JSON 数据、图片以及其他的静态数据。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e离线存储数据的建议：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e对 \x3cstrong\x3eURL寻址资源\x3c\/strong\x3e(URL addressable resources)，使用 \x3ca href=\x22https:\/\/davidwalsh.name\/cache\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e\x3cstrong\x3eCache API\x3c\/strong\x3e\x3c\/a\x3e（这是 \x3ca href=\x22https:\/\/developers.google.com\/web\/fundamentals\/primers\/service-worker\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eService Worker\x3c\/a\x3e 的一部分）。对其他数据，使用 \x3cstrong\x3eIndexedDB\x3c\/strong\x3e（给它包装上 \x3ca href=\x22http:\/\/www.html5rocks.com\/en\/tutorials\/es6\/promises\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePromises\x3c\/a\x3e）。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e常见问题解答：\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3eIDB 和 Cache API 两者的 API 都是异步的（IDB 基于事件，Cache API 基于 Promise）。它们都可以在 \x3ca href=\x22https:\/\/nolanlawson.github.io\/html5workertest\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWeb Worker、Window 以及 Service Worker\x3c\/a\x3e 三种环境下工作。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eIDB \x3ca href=\x22http:\/\/caniuse.com\/#feat=indexeddb\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e到处\x3c\/a\x3e都支持（译者注：原文如此，作者的意思请自行揣摩）。 Service Workers  和 Cache API 只在 Chrome、Firefox、Opera 中\x3ca href=\x22https:\/\/jakearchibald.github.io\/isserviceworkerready\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e支持\x3c\/a\x3e， Edge 中尚在开发。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eIDB 不支持 Promise，但有一些\x3cem\x3e强大的\x3c\/em\x3e库提供了 Promise 包装。\x3cem\x3e后面会给出建议。\x3c\/em\x3e这些库会尽可能抹平 API 之间的强制复杂性（事务处理，schema 版本控制）。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e原生的 IDB Promise 以及 \x3ca href=\x22https:\/\/github.com\/WICG\/indexed-db-observers\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eobserver\x3c\/a\x3e 已得到\x3ca href=\x22https:\/\/github.com\/inexorabletash\/indexeddb-promises\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e提议\x3c\/a\x3e。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e有多大的存储量？Chrome 和 Opera 中，是按\x3cstrong\x3e域\x3c\/strong\x3e计算存储的（而不是按 API 计算）。在到达\x3ca href=\x22http:\/\/www.html5rocks.com\/en\/tutorials\/offline\/quota-research\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e储量限制\x3c\/a\x3e之前，两种存储机制都会一直进行存储。通过 \x3ca href=\x22https:\/\/www.w3.org\/TR\/quota-api\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eQuota Management API\x3c\/a\x3e 可以检查用量（译者注：这个 API 还在提案阶段）。Firefox 则没有对存储量做出限制，只是在 50 MB 之后会弹出提醒。移动版 Safari 最多可以存 50 MB；桌面版 Safari没有限制（满5 MB 之后有提醒）；IE 10\x2b 最多能存 250 MB，超过 10 MB 之后弹出提醒。以上数据来源于 PouchDB 对 IDB 存储行为的\x3ca href=\x22https:\/\/pouchdb.com\/faq.html#data_limits\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e跟踪\x3c\/a\x3e。朝着未来的方向看，如果应用需要更多持久化存储，请看正在进行中的 \x3ca href=\x22https:\/\/storage.spec.whatwg.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDurable Storage\x3c\/a\x3e。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eSafari 在最新的 Tech Previews 中\x3ca href=\x22https:\/\/gist.github.com\/nolanlawson\/08eb857c6b17a30c1b26\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e修复了许多长期存在的 IDB bug\x3c\/a\x3e\x3cbutton class=\x22btn btn-xs btn-default ml10 preview\x22 data-url=\x22nolanlawson\/08eb857c6b17a30c1b26\x22 data-typeid=\x221\x22\x3e点击预览\x3c\/button\x3e。即便如此，Safari 10 的 IDB 并未完全通过 PouchDB 的测试套件，已经有人碰到了稳定性问题。在更多研究完成之前，可能会遇到各种不同的情况。请\x3cem\x3e务必\x3c\/em\x3e测试并提交 bug，让 webkit 的同学和相关支持库的作者们看看。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eURL寻址资源通常是指可以那些通过 URL 访问的静态资源。对 PWA 而言，你可以通过 Cache API 缓存那些组成你的应用 shell 的静态文件（JS\/CSS\/HTML），并通过 IndexedDB 向离线页面填充数据。对此没有硬性规定，PWA 仅靠 Cache API 就能玩得转。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/developers.google.com\/web\/tools\/chrome-devtools\/iterate\/manage-data\/local-storage\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eChrome\x3c\/a\x3e (Application tab)、Opera、\x3ca href=\x22https:\/\/developer.mozilla.org\/en-US\/docs\/Tools\/Storage_Inspector\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFirefox\x3c\/a\x3e (Storage Inspector)、Safari (Storage tab) 都已经支持 IndexedDB 调试。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e值得一看的 IndexedDB 库\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/mozilla.github.io\/localForage\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3elocalForage\x3c\/a\x3e： 约 8 KB，Promise，对传统浏览器支持良好\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.npmjs.com\/package\/idb-keyval\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eidb-keyval\x3c\/a\x3e：小于 500 字节，Promise，提供 key-value 支持\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.npmjs.com\/package\/idb\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eidb\x3c\/a\x3e：约 1.7 KB，Promise, 可迭代、索引\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/dexie.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDexie\x3c\/a\x3e：约 16 KB, Promises，复杂查询、辅助索引\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/pouchdb.com\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePouchDB\x3c\/a\x3e：约 45 KB ，支持\x3ca href=\x22https:\/\/pouchdb.com\/2016\/06\/06\/introducing-pouchdb-custom-builds.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e定制版本\x3c\/a\x3e，同步的（？）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/google\/lovefield\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eLovefield\x3c\/a\x3e：相关的内容\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/lokijs.org\/#\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eLokiJS\x3c\/a\x3e：内存中的\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/yathit\/ydn-db\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eydn-db\x3c\/a\x3e：类似 dexie，可以使用 WebSQL\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e值得一看的 Service Worker 库\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/GoogleChrome\/sw-toolbox\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3esw-toolbox\x3c\/a\x3e：动态或运行时请求的离线缓存\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/GoogleChrome\/sw-precache\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3esw-precache\x3c\/a\x3e：静态资源或应用 shell 的离线预缓存\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3eWebpack 用户可以直接使用上面的，或者可以看看 \x3ca href=\x22https:\/\/github.com\/NekR\/offline-plugin\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eoffline-plugin\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader0\x22\x3e其他存储机制\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eWeb Storage\x3c\/strong\x3e (e.g LocalStorage) 是同步的，不支持 Web Worker，且有大小限制（只能存储字符串）。尽管之前异步 LocalStorage 的\x3ca href=\x22https:\/\/github.com\/slightlyoff\/async-local-storage\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e想法\x3c\/a\x3e已有人提出来，但目前的焦点还是 \x3ca href=\x22https:\/\/w3c.github.io\/IndexedDB\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eIndexedDB 2.0\x3c\/a\x3e。我个人就愿意使用 IDB 加上一个工具库。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eCookies\x3c\/strong\x3e 自有其用途，但却是同步的，不支持 Web Worker，还有大小限制。在之前的项目中我使用了 \x3ca href=\x22https:\/\/github.com\/js-cookie\/js-cookie\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ejs-cookie\x3c\/a\x3e（gzip 后约 800 字节） 处理 cookie。目前已经有人勾勒出 \x3ca href=\x22https:\/\/github.com\/WICG\/async-cookies-api\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAsync Cookies API\x3c\/a\x3e 的支持了，有一个可用的 polyfill。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eWebSQL\x3c\/strong\x3e 是异步的（基于回调函数），但它同样不支持 Web Worker。Firefox 和 Edge 也不支持它。如果某一天它完全消失，我不会觉得惊讶的。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eFile System API\x3c\/strong\x3e 也是异步的（基于回调函数），在 Web Worker 和 window 中可以工作（虽然使用的是同步 API）。不幸的是，除 Chrome 之外它并无更多兴趣，而且是运行在沙盒中的（这意味着我们无法获取原生的文件访问权）。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3cstrong\x3eFile API\x3c\/strong\x3e 正在由 \x3ca href=\x22https:\/\/wicg.github.io\/entries-api\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFile and Directory Entries API\x3c\/a\x3e 和 \x3ca href=\x22https:\/\/w3c.github.io\/FileAPI\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFile API\x3c\/a\x3e 规范完善。Github 上有一个 \x3ca href=\x22https:\/\/github.com\/mailru\/FileAPI\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFile API 库\x3c\/a\x3e；关于保存文件，作为权宜之计，我一直在使用 \x3ca href=\x22https:\/\/github.com\/eligrey\/FileSaver.js\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFileSaver.js\x3c\/a\x3e。\x3ca href=\x22https:\/\/github.com\/WICG\/writable-files\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e可写文件\x3c\/a\x3e的提案最终可能会为我们提供本地文件无缝交互的标准解决方案。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader1\x22\x3e离线存储的现在与将来\x3c\/h3\x3e\n\x3cp\x3e如果对离线缓存感兴趣，下面这些成果值得关注。我个人对 IndexedDB 原生的 Promise 支持非常感兴趣。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/remote\/1460000006640459\x22 src=\x22https:\/\/static.alili.tech\/img\/remote\/1460000006640459\x22 alt=\x22\x22 title=\x22\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/storage.spec.whatwg.org\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDurable Storage\x3c\/a\x3e: 将存储与浏览器的清除策略隔开\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/w3c.github.io\/IndexedDB\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eIndexed Database API 2.0\x3c\/a\x3e: 先进的 key-value 数据管理\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/inexorabletash\/indexeddb-promises\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ePromisified IndexedDB\x3c\/a\x3e: 原生支持 Promise 的 IndexedDB 版本\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/WICG\/indexed-db-observers\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eIndexedDB Observers\x3c\/a\x3e: 原生的 IndexedDB observer 支持\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/bsittler\/async-cookies-api\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eAsync Cookies API\x3c\/a\x3e: 异步的 cookie API\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/www.w3.org\/TR\/quota-api\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eQuota Management API\x3c\/a\x3e: 检查应用、域的存储占用量\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/WICG\/writable-files\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ewritable-files\x3c\/a\x3e: 允许网站与本地文件之间进一步的无缝交互\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/github.com\/drufball\/directory-download\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eDirectory downloads\x3c\/a\x3e: 支持直接下载文件夹（非 .zip 文件）\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/wicg.github.io\/entries-api\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFile and Directory Entries API\x3c\/a\x3e: 支持文件和目录的拖拽上传\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e资源\x3c\/h3\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22http:\/\/nolanlawson.github.io\/database-comparison\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eBrowser Database Comparison\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/docs.google.com\/presentation\/d\/11CJnf77N45qPFAhASwnfRNeEMJfR-E_x05v1Z6Rh5HA\/edit\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eState of offline storage APIs\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/nolanlawson.com\/2015\/09\/29\/indexeddb-websql-localstorage-what-blocks-the-dom\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eIndexedDB, WebSQL, LocalStorage — what blocks the DOM?\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/nolanlawson.com\/2016\/02\/08\/how-to-think-about-databases\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eHow to think about databases (Pokedex research)\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ca href=\x22https:\/\/nolanlawson.github.io\/html5workertest\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eWhich APIs are supported in Web Workers and Service Workers?\x3c\/a\x3e\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e离线存储并没有那么神奇，对潜在 API 的理解有助于你最大程度地利用现有的资源。无论你想直接使用这些 API，还是使用对它们进行抽象库文件，花一些时间来熟悉你的选择。\x3c\/p\x3e\n\x3cp\x3e希望本文对你的 PWA 离线体验有所帮助。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>【译】渐进式 Web App 的离线存储</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000006640450">https://segmentfault.com/a/1190000006640450</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/jr43973oj4d/" target="_blank">https://alili.tech/archive/jr43973oj4d/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>