<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="【源码解析】Vue.js的监听实现"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>【源码解析】Vue.js的监听实现 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/d3etpoa3vli/",
				"appid": "1613049289050283", 
				"title": "【源码解析】Vue.js的监听实现 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-10T02:30:42"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/tzdcntkt56m/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/zvznwwryj8/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f&text=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f&text=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f&title=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f&is_video=false&description=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f&title=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f&title=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f&title=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fd3etpoa3vli%2f&title=%e3%80%90%e6%ba%90%e7%a0%81%e8%a7%a3%e6%9e%90%e3%80%91Vue.js%e7%9a%84%e7%9b%91%e5%90%ac%e5%ae%9e%e7%8e%b0"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">【源码解析】Vue.js的监听实现</h1><div class="meta"><div class="postdate"><time datetime="2019-02-10" itemprop="datePublished">2019-02-10</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3e本文地址： \x3ca href=\x22http:\/\/www.iamaddy.net\/2016\/11\/vue-js-monitor-realize\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/www.iamaddy.net\/2016\/1...\x3c\/a\x3e\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e一说到监听，当然就离不了设计模式中鼎鼎大名的观察者模式。举个例子，你家后院着火了，可一定要等到烟雾很大火光很亮你才能发现啊，可是当你安装了一个火灾预警器，当发生火灾就立马能够通知到你了。这就是一个典型的观察者模式。当然也还有一些其他变种，比如发布\/订阅（publish\/subscribe）模式。\x3c\/p\x3e\n\x3cp\x3e我们知道如果要将数据和视图关联起来，在数据变更的时候，同步视图，同理视图变更，数据也发生变化。vue.js是怎么实现这个的呢？下面我们来揭开它的神秘面纱。\x3cbr\x3edemo：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript src=\x26quot;..\/vue.js\x26quot;\x3e \x3c\/script\x3e\n\x3cdiv id=\x26quot;app\x26quot;\x3e\n \x3cp\x3e\n      \x22{{\x22 message \x22}}\x22\n    \x3c\/p\x3e\n    \x3cinput v-model=\x26quot;message\x26quot;\x3e\n\x3c\/div\x3e\n\x3cscript type=\x26quot;text\/javascript\x26quot;\x3e\nnew Vue({\n  el: \x27#app\x27,\n  data: {\n    message: \x27Hello Vue.js!\x27\n  }\n});\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs django\x22\x3e\x3ccode\x3e\x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3esrc\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22..\/vue.js\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22undefined\x22\x3e \x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3eid\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22app\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n      \x3c\/span\x3e\x3cspan class=\x22hljs-template-variable\x22\x3e\x22{{\x22 message \x22}}\x22\x3c\/span\x3e\x3cspan class=\x22xml\x22\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ep\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n    \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3einput\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ev-model\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22message\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3etype\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e\x22text\/javascript\x22\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3cspan class=\x22actionscript\x22\x3e\n\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Vue({\n  el: \x3cspan class=\x22hljs-string\x22\x3e\x27#app\x27\x3c\/span\x3e,\n  data: {\n    message: \x3cspan class=\x22hljs-string\x22\x3e\x27Hello Vue.js!\x27\x3c\/span\x3e\n  }\n});\n\x3c\/span\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3escript\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22set: function reactiveSetter(newVal) {\n  var value = getter ? getter.call(obj) : val;\n  if (newVal === value) {\n    return;\n  }\n  if (setter) {\n    setter.call(obj, newVal);\n  } else {\n    val = newVal;\n  }\n  childOb = observe(newVal);\n  dep.notify();\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs haxe\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e: \x3cspan class=\x22hljs-type\x22\x3efunction reactiveSetter\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e value = getter ? getter.call(obj) : \x3cspan class=\x22hljs-type\x22\x3eval\x3c\/span\x3e;\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e === value) {\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e;\n  }\n  \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (setter) {\n    setter.call(obj, \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e);\n  } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n    val = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e;\n  }\n  childOb = observe(\x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e\x3cspan class=\x22hljs-type\x22\x3eVal\x3c\/span\x3e);\n  dep.notify();\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这段代码出现在解析data属性的时候，即调用Object.defineProperty方法配置data的属性。一旦属性发生变化，就notify发送广播。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Dep.prototype.notify = function () {\n  \/\/ stablize the subscriber list first\n  var subs = toArray(this.subs);\n  for (var i = 0, l = subs.length; i \x3c l; i\x2b\x2b) {\n    subs[i].update();\n  }\n};\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3eDep.prototype.notify = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ stablize the subscriber list first\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e subs = toArray(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.subs);\n  \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, l = subs.length; i \x26lt; l; i\x2b\x2b) {\n    subs[i].update();\n  }\n};\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3enotify 最终是周知subscribe（订阅者）更新，那么上面的数据变更就是发布者。\x3cbr\x3esubscribe是Watcher这个类的实例化对象，在实例化的时候，会传入回调函数来执行update，vue弄了一个队列来执行watcher的更新函数，具体可参考源码。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22Watcher.prototype.run = function () {\n    ……\n    if (value !== this.value || (isObject(value) || this.deep) \x26amp;\x26amp; !this.shallow) {\n      ……\n      } else {\n        this.cb.call(this.vm, value, oldValue);\n      }\n    }\n    this.queued = this.shallow = false;\n  }\n };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3eWatcher.prototype.run = function () {\n    ……\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (value !== \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.value || (isObject(value) || \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.deep) \x26amp;\x26amp; !\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.shallow) {\n      ……\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.cb.call(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.vm, value, oldValue);\n      }\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.queued = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.shallow = \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n  }\n };\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在Directive（指令）class中实例化了Watcher，_update函数负责来更新\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var watcher = this._watcher = new Watcher(this.vm, this.expression, this._update, \/\/ callback\n      {\n        filters: this.filters,\n        twoWay: this.twoWay,\n        deep: this.deep,\n        preProcess: preProcess,\n        postProcess: postProcess,\n        scope: this._scope\n      });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e watcher = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._watcher = new Watcher(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.vm, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.expression, \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._update, \x3cspan class=\x22hljs-comment\x22\x3e\/\/ callback\x3c\/span\x3e\n      {\n        filters: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.filters,\n        twoWay: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.twoWay,\n        deep: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.deep,\n        preProcess: preProcess,\n        postProcess: postProcess,\n        scope: \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._scope\n      });\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e在解析模板的时候会解析Directive，然后绑定，实例化watcher，这样模板-data就关联在一起了。\x3cbr\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVvugw?w=1592\x26amp;h=512\x22 src=\x22https:\/\/static.alili.tech\/img\/bVvugw?w=1592\x26amp;h=512\x22 alt=\x22图片描述\x22 title=\x22图片描述\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch4\x3e观察者模式\x3c\/h4\x3e\n\x3cp\x3e林林总总的mvc或者mvvm框架基本也都是利用了观察者模式，这个也非常有用，尤其在复杂的系统之中。\x3c\/p\x3e\n\x3cp\x3e利用观察者模式，在典型的ajax应用中，回调的处理逻辑可以不跟请求耦合在一块，这样逻辑上也会更加清晰。如下是一个简单的发布\/订阅模式的实现\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var PubSub = {};\n(function (q) {\n    var topics = {}, subUid = -1;\n    q.publish = function (topic) {\n        if(!topics[topic]){\n            return false;\n        }\n\n        var subscribers = topics[topic],\n            len = subscribers ? subscribers.length : 0;\n\n        while(len--){\n            var args = Array.prototype.slice.call(arguments, 1);\n            args.unshift(topic);\n            subscribers[len].callback.apply(this, args);\n        }\n        return this;\n    };\n\n    q.subscribe = function (topic, callback) {\n        if(!topics[topic]){\n            topics[topic] = [];\n        }\n\n        var subuid = (\x2b\x2bsubUid).toString();\n\n        topics[topic].push({\n            token: subuid,\n            callback: callback\n        });\n\n        return subuid;\n    };\n\n    q.unsubscribe = function (subid) {\n        for(var k in topics){\n            if(topics[k]){\n                for(var i = 0, j = topics[k].length; i \x3c j; i\x2b\x2b){\n                    if(topics[k][i].token === subid){\n                        topics[k].splice(i, 1);\n                        return subid;\n                    }\n                }\n            }\n        }\n        return this;\n    };\n})(PubSub);\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e PubSub = {};\n(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3eq\x3c\/span\x3e) \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e topics = {}, subUid = \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e;\n    q.publish = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3etopic\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!topics[topic]){\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e subscribers = topics[topic],\n            len = subscribers ? subscribers.length : \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e(len--){\n            \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e args = \x3cspan class=\x22hljs-built_in\x22\x3eArray\x3c\/span\x3e.prototype.slice.call(\x3cspan class=\x22hljs-built_in\x22\x3earguments\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n            args.unshift(topic);\n            subscribers[len].callback.apply(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, args);\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n    };\n\n    q.subscribe = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3etopic, callback\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(!topics[topic]){\n            topics[topic] = [];\n        }\n\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e subuid = (\x2b\x2bsubUid).toString();\n\n        topics[topic].push({\n            \x3cspan class=\x22hljs-attr\x22\x3etoken\x3c\/span\x3e: subuid,\n            \x3cspan class=\x22hljs-attr\x22\x3ecallback\x3c\/span\x3e: callback\n        });\n\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e subuid;\n    };\n\n    q.unsubscribe = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3esubid\x3c\/span\x3e) \x3c\/span\x3e{\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e k \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e topics){\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(topics[k]){\n                \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e(\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, j = topics[k].length; i \x26lt; j; i\x2b\x2b){\n                    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e(topics[k][i].token === subid){\n                        topics[k].splice(i, \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n                        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e subid;\n                    }\n                }\n            }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e;\n    };\n})(PubSub);\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这就是一个简单的订阅发布系统，每注册一个订阅者，其实就是将其回调处理的callback保存在一个字典对象的数组中，字典对象的key值可以随意定义，只要与发布时的key对应起来就好。怎么使用呢？\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\x3cscript\x3e\nvar messageLogger = function(){\n        console.log(JSON.stringify(arguments));\n    };\n\nvar subscription = PubSub.subscribe(\x27\/newMessage\x27, messageLogger);\n\/\/ {\x26quot;0\x26quot;:\x26quot;\/newMessage\x26quot;,\x26quot;1\x26quot;:\x26quot;hello world\x26quot;}\nPubSub.publish(\x27\/newMessage\x27, \x27hello world\x27);\n\n\/\/ {\x26quot;0\x26quot;:\x26quot;\/newMessage\x26quot;,\x26quot;1\x26quot;:[\x26quot;test\x26quot;,\x26quot;a\x26quot;,\x26quot;b\x26quot;,\x26quot;c\x26quot;]}\nPubSub.publish(\x27\/newMessage\x27, [\x27test\x27, \x27a\x27, \x27b\x27, \x27c\x27]);\n\n\/\/ {\x26quot;0\x26quot;:\x26quot;\/newMessage\x26quot;,\x26quot;1\x26quot;:{\x26quot;sender\x26quot;:\x26quot;hello world\x26quot;,\x26quot;body\x26quot;:\x26quot;hey man\x26quot;\x22}}\x22\nPubSub.publish(\x27\/newMessage\x27, {\n    sender: \x27hello world\x27,\n    body: \x27hey man\x27\n});\n\nPubSub.unsubscribe(subscription);\n\nPubSub.publish(\x27\/newMessage\x27, [\x27test\x27, \x27a\x27, \x27b\x27, \x27c\x27], 1);\n\x3c\/script\x3e\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs xquery\x22\x3e\x3ccode\x3e\x26lt;script\x26gt;\nvar messageLogger = \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(){\n        console.log(JSON.stringify(arguments));\n    };\n\nvar subscription = PubSub.subscribe(\x3cspan class=\x22hljs-string\x22\x3e\x27\/newMessage\x27\x3c\/span\x3e, messageLogger);\n\/\/ {\x3cspan class=\x22hljs-string\x22\x3e\x220\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22\/newMessage\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x221\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22hello world\x22\x3c\/span\x3e}\nPubSub.publish(\x3cspan class=\x22hljs-string\x22\x3e\x27\/newMessage\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e);\n\n\/\/ {\x3cspan class=\x22hljs-string\x22\x3e\x220\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22\/newMessage\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x221\x22\x3c\/span\x3e:[\x3cspan class=\x22hljs-string\x22\x3e\x22test\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22a\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22b\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22c\x22\x3c\/span\x3e]}\nPubSub.publish(\x3cspan class=\x22hljs-string\x22\x3e\x27\/newMessage\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27b\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27c\x27\x3c\/span\x3e]);\n\n\/\/ {\x3cspan class=\x22hljs-string\x22\x3e\x220\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22\/newMessage\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x221\x22\x3c\/span\x3e:{\x3cspan class=\x22hljs-string\x22\x3e\x22sender\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22hello world\x22\x3c\/span\x3e,\x3cspan class=\x22hljs-string\x22\x3e\x22body\x22\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22hey man\x22\x3c\/span\x3e\x22}}\x22\nPubSub.publish(\x3cspan class=\x22hljs-string\x22\x3e\x27\/newMessage\x27\x3c\/span\x3e, {\n    sender: \x3cspan class=\x22hljs-string\x22\x3e\x27hello world\x27\x3c\/span\x3e,\n    body: \x3cspan class=\x22hljs-string\x22\x3e\x27hey man\x27\x3c\/span\x3e\n});\n\nPubSub.unsubscribe(subscription);\n\nPubSub.publish(\x3cspan class=\x22hljs-string\x22\x3e\x27\/newMessage\x27\x3c\/span\x3e, [\x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27a\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27b\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27c\x27\x3c\/span\x3e], \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e);\n\x26lt;\/script\x26gt;\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e最后一个将不会打印出来，因为已经取消订阅了。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>【源码解析】Vue.js的监听实现</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005082164">https://segmentfault.com/a/1190000005082164</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/d3etpoa3vli/" target="_blank">https://alili.tech/archive/d3etpoa3vli/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>