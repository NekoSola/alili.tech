<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="不懂函数式？用mobx来写react应用吧"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>不懂函数式？用mobx来写react应用吧 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/pdsumwysnrc/",
				"appid": "1613049289050283", 
				"title": "不懂函数式？用mobx来写react应用吧 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-06T02:30:09"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/3eewmzbohz/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/8gsbz203ze3/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f&text=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f&text=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f&title=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f&is_video=false&description=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f&title=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f&title=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f&title=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fpdsumwysnrc%2f&title=%e4%b8%8d%e6%87%82%e5%87%bd%e6%95%b0%e5%bc%8f%ef%bc%9f%e7%94%a8mobx%e6%9d%a5%e5%86%99react%e5%ba%94%e7%94%a8%e5%90%a7"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">不懂函数式？用mobx来写react应用吧</h1><div class="meta"><div class="postdate"><time datetime="2019-02-06" itemprop="datePublished">2019-02-06</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3ch1 id=\x22articleHeader0\x22\x3e目的\x3c\/h1\x3e\n\x3cp\x3e直接了当吧：其实这篇就是想安利大家一个新的状态管理库。如果你使用react，更熟悉面向对象，羡慕vue的简单直观，对redux感觉有些烦躁，真心安利你，体验下\x3ccode\x3emobx\x3c\/code\x3e.\x3c\/p\x3e\n\x3cp\x3e安利的同时，略带些内容。内容走起\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader1\x22\x3e内容\x3c\/h1\x3e\n\x3cp\x3e因为看到\x3ccode\x3eredux\x3c\/code\x3e的作者，在twitter推荐了\x3ccode\x3emobx\x3c\/code\x3e这个库:\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eunhappy with redux? try mobx\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e大神主动推荐自己成名作品的替代品？！！！\x3c\/p\x3e\n\x3cp\x3e于是立马尝试。不到一个下午的时间，基本上手，然后晚上回去想了想代码组织的问题，试用了起来。发现开发效率大幅提升，而且整个工程的脉络很清楚。\x3c\/p\x3e\n\x3cp\x3e然后回想起当初学redux，真感觉自己智商不够。看了一周文档，理念理解的七七八八，不知道如何写代码；然后因为源码不多，又看了一周redux的源码，还发现了个bug，提了pr，但是依旧不知道如何写代码。。最后只能硬着头皮无脑抄别人的代码，才大致明白了整个流程。\x3c\/p\x3e\n\x3cp\x3e所以从自身实际情况的对比，有段时间略傻x的变成了redux无脑黑，并在很多场合说过，谁用redux谁加班。。。现在想想too simple\x3c\/p\x3e\n\x3cp\x3e经过不断的讨论，觉得使用redux不爽，最大的原因是不熟悉函数式，而且js本身也没有在语法上为函数式提供什么便利。\x3c\/p\x3e\n\x3cp\x3eredux更像是定了一种规范，然后为了能把这种规范应用到工程中，提供了几个帮助函数。如果对函数式很熟悉，那么会非常认同这套并很舒服的使用起来。\x3c\/p\x3e\n\x3cp\x3e但是,熟悉函数式的工程师数量远比熟悉面向对象的少,我对函数式也就只了解个皮毛。。\x3c\/p\x3e\n\x3cp\x3e言归正传，来看看\x3ccode\x3emobx\x3c\/code\x3e吧.\x3c\/p\x3e\n\x3cp\x3e使用mobx的写react，大体上，步骤分为两步：\x3c\/p\x3e\n\x3col\x3e\x3cli\x3e\x3cp\x3e写模型的class\x3c\/p\x3e\x3c\/li\x3e\x3c\/ol\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    import $ from \x27jquery\x27 \/\/ just for ajax usage\n    import { observable } from \x27mobx\x27\n    \n    class Posts{\n        @observable list=[]\n        \n        \/\/这里为了演示，直接$.ajax。\n        \/\/但是这样的model，很难测试！！\n        fetchPosts(){\n            $.ajax({\n                url:\x27\/posts\x27\n            }).done((data)=\x3e{\n                this.list = data.postList\n            })\n        }\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e $ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27jquery\x27\x3c\/span\x3e \x3cspan class=\x22hljs-comment\x22\x3e\/\/ just for ajax usage\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { observable } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27mobx\x27\x3c\/span\x3e\n    \n    \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ePosts\x3c\/span\x3e\x3c\/span\x3e{\n        @observable list=[]\n        \n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/这里为了演示，直接$.ajax。\x3c\/span\x3e\n        \x3cspan class=\x22hljs-comment\x22\x3e\/\/但是这样的model，很难测试！！\x3c\/span\x3e\n        fetchPosts(){\n            $.ajax({\n                \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x27\/posts\x27\x3c\/span\x3e\n            }).done(\x3cspan class=\x22hljs-function\x22\x3e(\x3cspan class=\x22hljs-params\x22\x3edata\x3c\/span\x3e)=\x26gt;\x3c\/span\x3e{\n                \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.list = data.postList\n            })\n        }\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这个对于熟悉OOP的人，亲切的不行，写model类这事，有点经验的工程师，没写个上千个，也写个几百个吧。异步的处理，也很直白，请求，然后根据请求的数据，处理相应的属性。这段代码，如果不引入es6的语法，和以前jquery时代，写model没啥区别。\x3c\/p\x3e\n\x3cp\x3e这里多了个 \x3ccode\x3e@observable\x3c\/code\x3e。\x3ccode\x3edecorator\x3c\/code\x3e目前在es7里还没定稿，通过\x3ccode\x3ebabel 6\x3c\/code\x3e使用也需要通过引入一个plugin，这里使用，能可以提高可读性。当然不使用\x3ccode\x3edecorator\x3c\/code\x3e也可以，原理上，就是给\x3ccode\x3elist\x3c\/code\x3e包了个函数，这个函数会对\x3ccode\x3elist\x3c\/code\x3e进行处理，让对list的读写拥有了\x3ccode\x3epub\/sub\x3c\/code\x3e的功能。\x3c\/p\x3e\n\x3cp\x3e当然\x3ccode\x3emobx\x3c\/code\x3e提供的功能要比这多很多，根据官方描述\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eMobX is a battle tested library that makes state management simple and scalable by transparently applying functional reactive programming (TFRP)\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e大家注意两点 \x3ccode\x3ebattle tested\x3c\/code\x3e，\x3ccode\x3etransparently applying functional reactive programming\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e\x3ccode\x3emobx\x3c\/code\x3e做了大量的工作，能让你只关注操作对象属性即可，而背后的理念，就一句话\x3c\/p\x3e\n\x3cblockquote\x3e\x3cp\x3eAnything that can be derived from the application state, should be derived. Automatically.\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e应用的状态是本源，其他的部分，都应该从本源导出（derived）。比如上面的Posts类，本源就是 \x3ccode\x3e@observable list\x3c\/code\x3e.然后其他部分，依赖这个list去做一些事情，比如 \x3ccode\x3emobx\x3c\/code\x3e提供了\x3ccode\x3eautorun\x3c\/code\x3e函数\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\/\/写在 class Posts里\nautorun(()=\x3econsole.log(this.list.length))\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-regexp\x22\x3e\/\/\x3c\/span\x3e写在 \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ePosts\x3c\/span\x3e里\x3c\/span\x3e\nautorun(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e\x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.list.length))\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3eautorun里的匿名函数对list进行了取值，\x3ccode\x3emobx\x3c\/code\x3e知道，这个副作用函数，依赖list，所以list有变动，都会执行这个函数。这个函数的运行，是\x3ccode\x3elist\x3c\/code\x3e这个应用状态驱动的。如果应用还有其他状态，\x3ccode\x3emobx\x3c\/code\x3e不会触发这个函数，因为这个函数只依赖 \x3ccode\x3elist\x3c\/code\x3e.\x3c\/p\x3e\n\x3cp\x3e使用react后，ui的变化也是状态变化后，产生的副作用。所以很自然\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22autorun(()=\x3e redner(this.list))\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs coffeescript\x22\x3e\x3ccode\x3eautorun(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e redner(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.list))\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e那么状态的变化，就引起ui的变化，而且仅当\x3ccode\x3ethis.list\x3c\/code\x3e变化，才会引起ui的变化，其他应用状态的变化，不会产生影响，这也是\x3ccode\x3emobx\x3c\/code\x3e不需特别性能优化的原因，只有相关状态变动，才会影响ui。实际上，在只\x3ccode\x3erender需要render的组件\x3c\/code\x3e方面，官方出的\x3ccode\x3emobx-react\x3c\/code\x3e做了更多的工作。\x3c\/p\x3e\n\x3cp\x3e2.写react组件\x3c\/p\x3e\n\x3cp\x3e有了上面的\x3ccode\x3eclass Posts\x3c\/code\x3e，我们有个组件要展示\x3ccode\x3epost list\x3c\/code\x3e\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    import React from \x27react\x27\n    import { observer } from \x27mobx-react\x27\n    import Posts from \x27.\/Posts\x27\n    \n    @observer\n    class PostListComp extends React.component {\n        contructor() {\n            this.posts = new Posts();\n            this.posts.fetchPosts()\n        }\n        \n        render() {\n            return (\n                \x3cul\x3e\n                    {this.posts.list.map((post)=\x3e(\n                        \x3cli key={post.id}\x3epost.title\x3c\/li\x3e\n                    ))}\n                \x3c\/ul\x3e\n            )\n        }\n    }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22javascript\x22\x3e    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e React \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27react\x27\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e { observer } \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27mobx-react\x27\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Posts \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/Posts\x27\x3c\/span\x3e\n    \n    @observer\n    \x3cspan class=\x22hljs-class\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eclass\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ePostListComp\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eextends\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eReact\x3c\/span\x3e.\x3cspan class=\x22hljs-title\x22\x3ecomponent\x3c\/span\x3e \x3c\/span\x3e{\n        contructor() {\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.posts = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Posts();\n            \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.posts.fetchPosts()\n        }\n        \n        render() {\n            \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e (\n                \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    {this.posts.list.map((post)=\x26gt;(\n                        \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e \x3cspan class=\x22hljs-attr\x22\x3ekey\x3c\/span\x3e=\x3cspan class=\x22hljs-string\x22\x3e{post.id}\x3c\/span\x3e\x26gt;\x3c\/span\x3epost.title\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eli\x3c\/span\x3e\x26gt;\x3c\/span\x3e\n                    ))}\n                \x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3eul\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n            )\n        }\n    }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里\x3ccode\x3ePosts实例\x3c\/code\x3e不打算全局使用，所以赋值在 this.posts上。开始的时候，\x3ccode\x3ethis.posts.list\x3c\/code\x3e是[],这ok，ul里是空的，\x3ccode\x3efetchPosts\x3c\/code\x3e中异步请求结束，\x3ccode\x3ethis.posts.list\x3c\/code\x3e就有了从服务器取来的数据，这时mobx知道，这个react组件依赖于\x3ccode\x3ethis.post.list\x3c\/code\x3e，那渲染吧，就这样。\x3c\/p\x3e\n\x3cp\x3e这里的状态是\x3ccode\x3ePostListComp\x3c\/code\x3e组件自己new处理的，不和其他组件共享；如果想共享，可以放在两个组件的共同祖先那实例化，然后再各自传入，甚至根据业务，可以做成全局的单例。想想你处理对象的技巧，都能用在这里，如果你想用DI来管理这些对象，也可以，有文章介绍了mobx结合\x3ccode\x3eInversifyJS\x3c\/code\x3e使用的情况。\x3c\/p\x3e\n\x3cp\x3e如果\x3ccode\x3eposts\x3c\/code\x3e是父组件传给\x3ccode\x3ePostListComp\x3c\/code\x3e的，如果父组件的渲染不需要\x3ccode\x3eposts.list\x3c\/code\x3e,\x3ccode\x3eposts.list\x3c\/code\x3e的变化只会重渲染 \x3ccode\x3ePostListComp\x3c\/code\x3e,而不会重渲染父组件。\x3ccode\x3e只render需要render的组件\x3c\/code\x3e,所以性能优越。甚至可以做到下面这样（先不要纠结下面代码的一些细节）\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22const profileView = observer(props =\x3e {\n       if (props.person.nickName)\n          return \x3cdiv\x3e{props.person.nickName}\x3c\/div\x3e\n    else\n          return \x3cdiv\x3e{props.person.fullName}\x3c\/div\x3e\n   });    \n   \x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3econst\x3c\/span\x3e profileView = observer(\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3eprops\x3c\/span\x3e =\x26gt;\x3c\/span\x3e {\n       \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (props.person.nickName)\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e{props.person.nickName}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e\n          \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22xml\x22\x3e\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e{props.person.fullName}\x3cspan class=\x22hljs-tag\x22\x3e\x26lt;\/\x3cspan class=\x22hljs-name\x22\x3ediv\x3c\/span\x3e\x26gt;\x3c\/span\x3e\x3c\/span\x3e\n   });    \n   \x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e如果nickName不为空，那么mobx知道，这个view只依赖于nickName，fullName的变动不会引起view的变化，从而不会从新render组件。\x3ccode\x3e只render需要render的组件\x3c\/code\x3e(这话我已经说了3遍了！)\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader2\x22\x3e其他的api\x3c\/h3\x3e\n\x3cp\x3e\x3ccode\x3emobx\x3c\/code\x3e还提供了其他一些api，相对高级点，比如\x3c\/p\x3e\n\x3col\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3e@computed\x3c\/code\x3e: 由最开始的state生成出来的state，比如 \x3ccode\x3efullName\x3c\/code\x3e是由firstName和lastName生成的，如果firstName改变，fullName会重计算。监听@computed属性，和监听@observable属性，在使用上是一样的。理论上，可以写无数多层这样的依赖。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3euntrack\x3c\/code\x3e：在某一时刻使用了state的某个属性，但是不想对这个state属性产生依赖\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3etransaction\x3c\/code\x3e:在\x3ccode\x3etransaction\x3c\/code\x3e块中执行的属性修改，只会在块结束时，触发一次\x3ccode\x3eDerivations\x3c\/code\x3e的变更或执行。这就避免了不必要的多次副作用，比如多次 render react组件。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e\x3ccode\x3euseStrict\x3c\/code\x3e： 非严格模式下的mobx，任何地方都可以修改state，这样很快就会让state的管理难以维护。严格模式下，只有标记了\x3ccode\x3e@action\x3c\/code\x3e的函数或在\x3ccode\x3erunInAction\x3c\/code\x3e中的代码，才能修改state。这个强烈建议使用\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3espy \x26amp; intercept 做单个state或全局所有state的拦截。这给log等功能，提供了很好的便利。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ol\x3e\n\x3cp\x3e还有一些，大家去读文档吧。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader3\x22\x3e题外话\x3c\/h1\x3e\n\x3cp\x3emodel改变，ui自动变化，mobx写着，让我很有vue的感觉。感觉就是多了几个\x3ccode\x3edecorator\x3c\/code\x3e.\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader4\x22\x3e缺点\x3c\/h1\x3e\n\x3cp\x3e社区还不够丰富。mobx的资料还不多，基本没有中文资料。我安利的同学，都反映官方的get start（英文）看着有点蛋疼。然后我说，想想你们写redux的第一个demo，然后他们表示刚才的疼不算什么~。\x3c\/p\x3e\n\x3cp\x3e相信大家手上已经有些项目用redux了，如果用着也算顺手，其实也就没必要换了。我本人也同时维护着使用redux的项目，然后在新项目里使用mobx，我的效率是大幅提升的，但是老项目重写的代价太大。。。\x3c\/p\x3e\n\x3ch1 id=\x22articleHeader5\x22\x3e结论\x3c\/h1\x3e\n\x3cp\x3e所以，如果你使用react，更熟悉面向对象，羡慕vue的简单直观，真心安利你，体验下mobx。写的很舒爽，而且程序的性能有保证。对了官方还提供了一个dev-tools，非常不错，能够直接看到哪些组件被重渲染了。\x3c\/p\x3e\n\x3cp\x3e如果你被安利成功，想看看mobx，建议从官方文档开始，或者去官方的推荐列表里，找找视频教程（不要想，肯定是英文的），地址是 \x3ca href=\x22http:\/\/mobxjs.github.io\/mobx\/faq\/blogs.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttp:\/\/mobxjs.github.io\/mobx\/faq\/blogs.html\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e官方还提供了一个\x3ca href=\x22https:\/\/github.com\/mobxjs\/mobx-react-boilerplate\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3estarter\x3c\/a\x3e，可以省去各种配置。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>不懂函数式？用mobx来写react应用吧</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000006125797">https://segmentfault.com/a/1190000006125797</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/pdsumwysnrc/" target="_blank">https://alili.tech/archive/pdsumwysnrc/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>