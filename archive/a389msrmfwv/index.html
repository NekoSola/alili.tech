<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="小程序项目之填坑小记"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>小程序项目之填坑小记 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/a389msrmfwv/",
				"appid": "1613049289050283", 
				"title": "小程序项目之填坑小记 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-15T02:30:44"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/eumgejkx1ln/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/ndlmy1qb0t/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f&text=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f&text=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f&is_video=false&description=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fa389msrmfwv%2f&title=%e5%b0%8f%e7%a8%8b%e5%ba%8f%e9%a1%b9%e7%9b%ae%e4%b9%8b%e5%a1%ab%e5%9d%91%e5%b0%8f%e8%ae%b0"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">小程序项目之填坑小记</h1><div class="meta"><div class="postdate"><time datetime="2019-02-15" itemprop="datePublished">2019-02-15</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbi2wI?w=1008\x26amp;h=298\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbi2wI?w=1008\x26amp;h=298\x22 alt=\x22前端小程序项目之填坑小记\x22 title=\x22前端小程序项目之填坑小记\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e作者：\x3ca href=\x22https:\/\/github.com\/meibin08\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e首席填坑官∙苏南\x3c\/a\x3e\x3cbr\x3e公众号：\x3ccode\x3ehoneyBadger8\x3c\/code\x3e，本文原创，著作权归作者所有，转载请注明原链接及出处。\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e简诉\x3c\/h2\x3e\n\x3cp\x3e　　是的，真的，你没有看错，我就是上次那个加薪的，但是现在问题来了，最近又搞了个小程序的需求，又填了不少坑，其中的辛酸就不说了，说多了都是泪🤪😭，此处省略三千字 ………^……，说重点吧，反正最后就是差点这让老板叫走人了，你说优秀不优秀～。\x3c\/p\x3e\n\x3cp\x3e　　前段时间网上一直说的“\x26lt;u\x26gt;\x3ca href=\x22https:\/\/blog.csdn.net\/weixin_43254766\/article\/details\/82811714\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e你可以骂那些中年人，尤其是有车有房的……\x3c\/a\x3e\x26lt;\/u\x26gt;”，虽然我没有房、也没有车，但也坚决不做那个可以随便骂的中年人（人到中年不如狗？？），不存在的啦，这个仇宝宝已经记下了🤫，先分享一下最近遇到的几个坑吧。 —— 我是\x3ccode\x3e首席填坑官\x3c\/code\x3e——\x3ca href=\x22https:\/\/honeybadger8.github.io\/blog\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e苏南\x3c\/a\x3e，早上好，新的一周加油。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbi2wQ?w=300\x26amp;h=314\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbi2wQ?w=300\x26amp;h=314\x22 alt=\x22本文由@IT·平头哥联盟-首席填坑官∙苏南分享，公众号：honeyBadger8\x22 title=\x22本文由@IT·平头哥联盟-首席填坑官∙苏南分享，公众号：honeyBadger8\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e填坑一，canvas遮挡问题：\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e随着小程序的API调整，很多东西都要用户\x3ccode\x3e手动授权\x3c\/code\x3e，不能直接调用后，toast、弹窗这种提示的场景越来越多了，\x3c\/li\x3e\n\x3cli\x3e下图就是公司活动的canvas合成，现在微信API不让直接调用授权了，某些场景要多一个弹窗来提示用户开启设置，但当遇上\x3ccode\x3ecanvas\x3c\/code\x3e API这个大佬后,一切都变了，谁都只能站在它后面，\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e场景一\x3c\/strong\x3e ：如之前拒绝授权了，后续引导用户打开设置页，即 \x3ccode\x3ewx.openSetting\x3c\/code\x3e,下图就是：\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbi2wS?w=1500\x26amp;h=600\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbi2wS?w=1500\x26amp;h=600\x22 alt=\x22本文由@IT·平头哥联盟-首席填坑官∙苏南分享，公众号：honeyBadger8，小程序提示，被遮挡\x22 title=\x22本文由@IT·平头哥联盟-首席填坑官∙苏南分享，公众号：honeyBadger8，小程序提示，被遮挡\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e坑一 \x3cstrong\x3e小结\x3c\/strong\x3e ：当遇上这种情况，我的第一思路是 设置样式：\x3ccode\x3evisibility: hidden;opacity:0;\x3c\/code\x3e，但是结果是让人失望的，\x3ccode\x3ecanvas\x3c\/code\x3e 大佬就是大佬，这两属性在手机上失效了,该显示还是显示，你阻挡不了它的光辉，真的，不信可以去测试！\x3c\/blockquote\x3e\n\x3ch6\x3e解决思路：\x3c\/h6\x3e\n\x3cblockquote\x3e\x3cul\x3e\n\x3cli\x3ecanvas 图片合成，获取到图片的地址后，隐藏canvas,改用image标签显示，这种场景有局限性，如果你的需求是\x3ccode\x3eechart\x3c\/code\x3e交互的,显示挂了；\x3c\/li\x3e\n\x3cli\x3ecover-view 貌似也是有局限，\x3ccode\x3e\x26lt;cover-view \/\x26gt; 内只能嵌套 \x26lt;cover-view \/\x26gt; 和 \x26lt;cover-image \/\x26gt;，view 标签的子节点树在真机上都会被忽略\x3c\/code\x3e，这是我测试后的浏览器给出的警告，如果自定modal，要加button按钮让用户点击后授权某功能，肯定也就挂了 ；\x3c\/li\x3e\n\x3cli\x3e当弹窗出现的时候，隐藏canvas，这种比较暴力，但覆盖面广，任何场景都能照顾到，却也影响体验；\x3c\/li\x3e\n\x3cli\x3e把\x3ccode\x3ecanvas\x3c\/code\x3e定位移动到屏幕之外绘制内容；\x3c\/li\x3e\n\x3cli\x3e有同学可能说直接使用原生的 \x3ccode\x3ewx.showModal\x3c\/code\x3e,但官方目前，button还不支持设置\x3ccode\x3eopen-type\x3c\/code\x3e属性；\x3c\/li\x3e\n\x3cli\x3e等\x3cstrong\x3e微信小程序\x3c\/strong\x3e官方修复😫，好吧，看到这里你肯定笑了～，这不是一个方法，估计还没等到老板真叫你走人了，欢迎大佬们补充！！！\x3c\/li\x3e\n\x3c\/ul\x3e\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e填坑二，Maximum call stack size exceeded\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e发现这个bug，要从最近换了个手机说起，用了3年的5S终于歇菜了(再也买不起iphone了～)，换了个android vivo x23, 以为从此走上人生巅峰了，现实却给了我一个响亮的耳光，又是一个记忆深刻的梗～，被组里的同事笑话好久！！\x3c\/li\x3e\n\x3cli\x3e话说，堆栈溢出，是怎么造成的呢？—— \x3ccode\x3e循环引用\x3c\/code\x3e；\x3c\/li\x3e\n\x3cli\x3e同时我又有些疑惑了，为什么其他手机都正常，就vivo 报了这个错，同样的代码，希望有大神看到能给于解惑！\x3c\/li\x3e\n\x3cli\x3e\n\x3cstrong\x3e先来看个示例,简单演示一下\x3c\/strong\x3e ：\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22let sum = 20;\n    (function test(){\n        sum--;\n        console.log(sum);\n        test();\n        \/*\n        if( sum \x3e 0 ){\n            test();\n        }*\/\n    })()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3elet\x3c\/span\x3e sum = \x3cspan class=\x22hljs-number\x22\x3e20\x3c\/span\x3e;\n    (\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3etest\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3c\/span\x3e)\x3c\/span\x3e{\n        sum--;\n        \x3cspan class=\x22hljs-built_in\x22\x3econsole\x3c\/span\x3e.log(sum);\n        test();\n        \x3cspan class=\x22hljs-comment\x22\x3e\/*\n        if( sum \x26gt; 0 ){\n            test();\n        }*\/\x3c\/span\x3e\n    })()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbi2wY?w=1630\x26amp;h=720\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbi2wY?w=1630\x26amp;h=720\x22 alt=\x22堆栈溢出\x22 title=\x22堆栈溢出\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\n\x3cstrong\x3e# 而项目中的报错是这样的 #\x3c\/strong\x3e：\x3c\/li\x3e\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22\n    \/\/fetch.js\n    import wepy from \x27wepy\x27\n    import _login_ from \x27.\/login\x27;\n    ……省略N行\n\n    \/\/login.js\n    import {fetch} from \x26quot;.\/fetch.js\x26quot;;\n    import Storage from \x26quot;.\/storage.js\x26quot;;\n    ……省略N行\n\n    \/\/更改后 login.js ,避免了循环引用\n    loginFn = ()=\x3e{\n        require(\x26quot;.\/fetch.js\x26quot;).fetch({\n            url:\x26quot;\/wabApi\/login\/login\x26quot;,\n\n        });\n    }\n\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22javascript hljs\x22\x3e\x3ccode class=\x22js\x22\x3e\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/fetch.js\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e wepy \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27wepy\x27\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e _login_ \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x27.\/login\x27\x3c\/span\x3e;\n    ……省略N行\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/login.js\x3c\/span\x3e\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e {fetch} \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/fetch.js\x22\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3eimport\x3c\/span\x3e Storage \x3cspan class=\x22hljs-keyword\x22\x3efrom\x3c\/span\x3e \x3cspan class=\x22hljs-string\x22\x3e\x22.\/storage.js\x22\x3c\/span\x3e;\n    ……省略N行\n\n    \x3cspan class=\x22hljs-comment\x22\x3e\/\/更改后 login.js ,避免了循环引用\x3c\/span\x3e\n    loginFn = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e=\x26gt;\x3c\/span\x3e{\n        \x3cspan class=\x22hljs-built_in\x22\x3erequire\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22.\/fetch.js\x22\x3c\/span\x3e).fetch({\n            \x3cspan class=\x22hljs-attr\x22\x3eurl\x3c\/span\x3e:\x3cspan class=\x22hljs-string\x22\x3e\x22\/wabApi\/login\/login\x22\x3c\/span\x3e,\n\n        });\n    }\n\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbi2w0?w=560\x26amp;h=516\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbi2w0?w=560\x26amp;h=516\x22 alt=\x22本文由@IT·平头哥联盟-首席填坑官∙苏南分享，公众号：honeyBadger8，Maximum call stack size exceeded\x22 title=\x22本文由@IT·平头哥联盟-首席填坑官∙苏南分享，公众号：honeyBadger8，Maximum call stack size exceeded\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e坑二 \x3cstrong\x3e小结\x3c\/strong\x3e ：循环引用，可以理解为 a.js内调用了b.js，b.js里又引用了a.js，所以在项目开发中要注意一下，看了下网上的讨论，这个问题需要等官方解决，貌似h5里是可以这样写的。\x3c\/blockquote\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e填坑三，canvasGetImageData、canvasToTempFilePath\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e这两个方法，之间的调用，要做一定的延时，不明白是为什么，如果不做延时，也不会报错，也不提示，方法执行完，canvas上还是空白的;\x3c\/li\x3e\n\x3cli\x3e但是让人尴尬的是，此在写总结的我，又验证了一下，不加\x3ccode\x3esetTimeout\x3c\/code\x3e，调试器上可以，真机挂了！目测跟绘制的目标对象大小有关系！\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbi2w4?w=687\x26amp;h=535\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbi2w4?w=687\x26amp;h=535\x22 alt=\x22canvasGetImageData、canvasToTempFilePath\x22 title=\x22canvasGetImageData、canvasToTempFilePath\x22 style=\x22cursor: pointer;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e其他\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e微信API的调整，如：「 wx.getUserInfo」「 wx.getSetting」「 wx.openSetting」「 wx.getPhoneNumber」等这些现在需要添加按钮，用户手动来点击，带来的不便大家都知道了，就不再多说；\x3c\/li\x3e\n\x3cli\x3e\n\x3ccode\x3e字体文件\x3c\/code\x3e ,加载报错，但也能正常显示，而且只有第一次报错哦；\x3c\/li\x3e\n\x3cli\x3e其他还有待发现的坑……\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22    @font-face {\n      font-family: \x27test\x27;\n      src: url(\x26quot;https:\/\/cdn-xx.xxx.com\/common\/font\/font.ttf\x26quot;) format(\x27truetype\x27);\n      font-weight: normal;\n      font-style: normal;\n    }\n\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22css hljs\x22\x3e\x3ccode class=\x22css\x22\x3e    @\x3cspan class=\x22hljs-keyword\x22\x3efont-face\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-attribute\x22\x3efont-family\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x27test\x27\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-attribute\x22\x3esrc\x3c\/span\x3e: \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x22https:\/\/cdn-xx.xxx.com\/common\/font\/font.ttf\x22\x3c\/span\x3e) \x3cspan class=\x22hljs-built_in\x22\x3eformat\x3c\/span\x3e(\x3cspan class=\x22hljs-string\x22\x3e\x27truetype\x27\x3c\/span\x3e);\n      \x3cspan class=\x22hljs-attribute\x22\x3efont-weight\x3c\/span\x3e: normal;\n      \x3cspan class=\x22hljs-attribute\x22\x3efont-style\x3c\/span\x3e: normal;\n    }\n\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbi2w5?w=1194\x26amp;h=180\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbi2w5?w=1194\x26amp;h=180\x22 alt=\x22本文由@IT·平头哥联盟-首席填坑官∙苏南分享，公众号：honeyBadger8\x22 title=\x22本文由@IT·平头哥联盟-首席填坑官∙苏南分享，公众号：honeyBadger8\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e扯淡段子\x3c\/h2\x3e\n\x3cp\x3e　　小明公司之前上线的小程序项目，好久没有迭代了，产品说有个需求要改一下，很快，就一点点东西，比如一个按钮UI调整一下，改了赶紧发上去，嗯，最好今天就发了审核吧；\x3c\/p\x3e\n\x3cp\x3e　　这话，是你会怎么接呢？？小明说要一天，产品就惊呆了🤒，这家伙没有发烧吧？？小明后来经过半天的努力，终于让产品知道了小程序API更新后，再发布的相关流程都要改的；\x3c\/p\x3e\n\x3cp\x3e　　有谁能理解小明的痛苦？有谁能理解小程序的API更新机制？更新过的API没有向下兼容的余地，已经发布过的就放过你了，但是你再改动，所有它改过的流程，你都要改一遍。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader6\x22\x3e结尾\x3c\/h2\x3e\n\x3cp\x3e　　开心一笑，给自己找点乐，为今天的分享画上圆满的句号，以上就是我最近的一次小小填坑记整理，希望能给其他同学带来些许帮助，文中如有理解不足之处，请指正👇。\x3c\/p\x3e\n\x3cp\x3e\x3cspan class=\x22img-wrap\x22\x3e\x3cimg data-src=\x22\/img\/bVbiLDa?w=600\x26amp;h=336\x22 src=\x22https:\/\/static.alili.tech\/img\/bVbiLDa?w=600\x26amp;h=336\x22 alt=\x22宝剑锋从磨砺出，梅花香自苦寒来，做有温度的攻城狮!，公众号：honeyBadger8\x22 title=\x22宝剑锋从磨砺出，梅花香自苦寒来，做有温度的攻城狮!，公众号：honeyBadger8\x22 style=\x22cursor: pointer; display: inline;\x22\x3e\x3c\/span\x3e\x3c\/p\x3e\n\x3cblockquote\x3e作者：苏南 - \x3ca href=\x22https:\/\/github.com\/meibin08\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e首席填坑官\x3c\/a\x3e\x3cp\x3e链接：\x3ca href=\x22https:\/\/blog.csdn.net\/weixin_43254766\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ehttps:\/\/blog.csdn.net\/weixin_...\x3c\/a\x3e\x3c\/p\x3e\n\x3cp\x3e交流群：912594095、公众号：\x3ccode\x3ehoneyBadger8\x3c\/code\x3e\x3c\/p\x3e\n\x3cp\x3e本文原创，著作权归作者所有。商业转载请联系\x3ccode\x3e@IT·平头哥联盟\x3c\/code\x3e获得授权，非商业转载请注明原链接及出处。\x3c\/p\x3e\n\x3c\/blockquote\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>小程序项目之填坑小记</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000016891969">https://segmentfault.com/a/1190000016891969</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/a389msrmfwv/" target="_blank">https://alili.tech/archive/a389msrmfwv/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>