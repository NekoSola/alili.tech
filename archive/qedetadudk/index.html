<!DOCTYPE html><html lang="zh"><head><meta name="generator" content="Hugo 0.51"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="initial-scale=1,width=device-width,minimum-scale=1,maximum-scale=1,user-scalable=no"><meta name="wap-font-scale" content="no"><meta name="360-site-verification" content="0903ba33c82867d1f7bd8831e32a7e34"><meta name="sogou_site_verification" content="E8uWFBcf4a"><meta name="author" content="Fan"><meta name="description" itemprop="description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta name="keywords" content="Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js"><meta property="og:locale" content="en_US"><meta property="og:title" content="D3 源代码解构"><meta property="og:image" content="https://alili.tech/images/logo2.png"><meta property="og:description" content="Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css"><meta property="og:site_name" content="Alili"><title>D3 源代码解构 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!</title><link rel="shortcut icon" href="https://alili.tech/images/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://alili.tech/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="https://alili.tech/lib/justified-gallery/justifiedGallery.min.css"><link rel="stylesheet" href="https://alili.tech/css/style.css"><script src="https://alili.tech/lib/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="https://alili.tech/lib/jquery/jquery.min.js"></script><script>document.addEventListener("error", function (e) {
			  var elem = e.target;
			  if (elem.tagName.toLowerCase() == 'img') {
				elem.style.display='none'
			  }
			}, true);</script><script type="application/ld+json">{
				"@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
				"@id": "https://alili.tech/archive/qedetadudk/",
				"appid": "1613049289050283", 
				"title": "D3 源代码解构 | 前端大爆炸! - WEB BANG! BANG!! BANG!!!", 
				"images": [],
				"pubDate": "2019-02-07T02:30:16"
			}</script></head><body><div id="header-post"><a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a> <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a> <span id="menu"><span id="nav"><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></span><br><span id="actions"><ul><li><a class="icon" href="https://alili.tech/archive/ocaiqa2gvl/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover='$("#i-prev").toggle();' onmouseout='$("#i-prev").toggle();'></i></a></li><li><a class="icon" href="https://alili.tech/archive/0wgxsvfyn6qe/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover='$("#i-next").toggle();' onmouseout='$("#i-next").toggle();'></i></a></li><li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover='$("#i-top").toggle();' onmouseout='$("#i-top").toggle();'></i></a></li><li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover='$("#i-share").toggle();' onmouseout='$("#i-share").toggle();' onclick='$("#share").toggle();return false;'></i></a></li></ul><span id="i-prev" class="info" style="display:none;">Previous post</span> <span id="i-next" class="info" style="display:none;">Next post</span> <span id="i-top" class="info" style="display:none;">Back to top</span> <span id="i-share" class="info" style="display:none;">Share post</span></span><br><div id="share" style="display: none"><ul><li><a class="icon" href="http://v.t.sina.com.cn/share/share.php?u=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f&text=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84"><i class="fa fa-weibo" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f"><i class="fa fa-facebook" aria-hidden="true"></i></a></li><li><a class="icon" href="https://twitter.com/share?url=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f&text=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84"><i class="fa fa-twitter" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f&title=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li><li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f&is_video=false&description=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84"><i class="fa fa-pinterest" aria-hidden="true"></i></a></li><li><a class="icon" href="mailto:?subject=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84&body=Check out this article: https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f"><i class="fa fa-envelope" aria-hidden="true"></i></a></li><li><a class="icon" href="https://getpocket.com/save?url=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f&title=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84"><i class="fa fa-get-pocket" aria-hidden="true"></i></a></li><li><a class="icon" href="http://reddit.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f&title=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84"><i class="fa fa-reddit" aria-hidden="true"></i></a></li><li><a class="icon" href="http://www.stumbleupon.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f&title=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84"><i class="fa fa-stumbleupon" aria-hidden="true"></i></a></li><li><a class="icon" href="http://digg.com/submit?url=https%3a%2f%2falili.tech%2farchive%2fqedetadudk%2f&title=D3%20%e6%ba%90%e4%bb%a3%e7%a0%81%e8%a7%a3%e6%9e%84"><i class="fa fa-digg" aria-hidden="true"></i></a></li></ul></div><div id="toc"><nav id="TableOfContents"><ul><li><a href="#版权声明">版权声明</a><ul><li><a href="#原文标题">原文标题</a></li><li><a href="#原文链接">原文链接</a></li></ul></li></ul></nav></div></span></div><div class="content index width mx-auto px3 my3"><section id="wrapper" class="home"><article class="post" itemscope itemtype="http://schema.org/BlogPosting"><header><h1 class="posttitle" itemprop="name headline">D3 源代码解构</h1><div class="meta"><div class="postdate"><time datetime="2019-02-07" itemprop="datePublished">2019-02-07</time></div><div class="article-tag"><i class="fa fa-eye"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span></span></div><div class="article-tag-box"></div></div></header><div class="content" itemprop="articleBody"><div id="raw"><p style="opacity: 0;">Alili | 前端大爆炸! - WEB BANG! BANG!! BANG!!! 前端大爆炸,一个前端技术博客.想到哪,学到哪,写到哪. 本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有， Alili, 前端大爆炸, WEB BANG BANG BANG, web前端博客, 前端模块化, 前端工程化, 前端数据监控, 性能优化, 网页制作, 前端, js, html5, css, 踩坑小报告, 微前端, 树莓派, 前端开发, 区块链, 网络, Mongodb, Vue.js, Angular.js, node.js</p><script>$(function () {
            var html = "\n\n                    \n\x3cblockquote\x3e\x3cp\x3eD3是一个数据可视化的javascript库，相对于highchart和echarts专注图表可视化的库，D3更适合做大数据处理的可视化，它只提供基础的可视化功能，灵活而丰富的接口让我们能开发出各式各样的图表。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3eD3代码版本：“3.5.17”\x3c\/p\x3e\n\x3cp\x3eD3的代码骨架比较简洁，相比jquery来说更适合阅读，你可以很舒服地自上而下的看下去而不用看到一个新的函数发现声明在千里之外，然后在代码中跳来跳去。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader0\x22\x3e内部代码流水线\x3c\/h2\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e基本的数学计算：最小最大、均值中值方差、偏分值……\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e各种集合类型： map、set、nest……\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e集合的操作、方法： text、html、append、insert、remove\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3ed3的dragging\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e图形操作\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e……\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3ch2 id=\x22articleHeader1\x22\x3e自执行匿名函数\x3c\/h2\x3e\n\x3cp\x3e首先是典型的自执行匿名函数，对外提供接口，隐藏实现方式，实现私有变量等等功能。\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22!function() {\n   \/\/ code here\n}()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22\x3e!\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3efunction\x3c\/span\x3e\x3c\/span\x3e() {\n   \/\/ code here\n}()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里用到的是感叹号，其实和使用括号是一样的作用，就是将函数声明变成函数表达式，以便于函数的自执行调用，你可以试试\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22function() {\n  console.log(\x27no console\x27)\n}()\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22bash hljs\x22\x3e\x3ccode class=\x22bash\x22\x3e\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-title\x22\x3efunction\x3c\/span\x3e\x3c\/span\x3e() {\n  console.log(\x3cspan class=\x22hljs-string\x22\x3e\x27no console\x27\x3c\/span\x3e)\n}()\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这是因为JS禁止函数声明和函数调用混用，而括号、逻辑运算符（\x2b、-、\x26amp;\x26amp;、||）、逗号、new等都可以将函数声明变成函数表达式，然后便可以自执行。有人做过调查关于这些转化的方法哪个更快，可以查看这篇\x3ca href=\x22http:\/\/blog.sina.com.cn\/s\/blog_775f158f01016j12.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e博客\x3c\/a\x3e，大概new是最慢的，相比使用括号是基本最快，感叹号反而性能一般，所以其实用哪个都没什么区别，当然如果你想省敲一个符号也是可以用感叹号的。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader2\x22\x3e对外暴露私有变量d3\x3c\/h2\x3e\n\x3cp\x3e对于d3，采用的是创建私有变量对象，然后对它进行扩展，最后对外暴露\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var d3 = {\n  version: \x273.5.17\x27\n};\n\n\/\/ code here\n\/\/...\n\nif (typeof define === \x27function\x27 \x26amp;\x26amp; defind.amd) \n  this.d3 = d3, define(d3);\nelse if (typeof module == \x27object\x27 \x26amp;\x26amp; module.exports)\n  module.exports = d3;\nelse\n  this.d3 = d3;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs javascript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e d3 = {\n  \x3cspan class=\x22hljs-attr\x22\x3eversion\x3c\/span\x3e: \x3cspan class=\x22hljs-string\x22\x3e\x273.5.17\x27\x3c\/span\x3e\n};\n\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/ code here\x3c\/span\x3e\n\x3cspan class=\x22hljs-comment\x22\x3e\/\/...\x3c\/span\x3e\n\n\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e define === \x3cspan class=\x22hljs-string\x22\x3e\x27function\x27\x3c\/span\x3e \x26amp;\x26amp; defind.amd) \n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.d3 = d3, define(d3);\n\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e == \x3cspan class=\x22hljs-string\x22\x3e\x27object\x27\x3c\/span\x3e \x26amp;\x26amp; \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports)\n  \x3cspan class=\x22hljs-built_in\x22\x3emodule\x3c\/span\x3e.exports = d3;\n\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e\n  \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.d3 = d3;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e第一种为异步模块加载模式，第二种为同步模块加载或者是ecma6的import机制，第三种则是将d3设置为全局变量，因为匿名自执行函数中，函数的环境就是全局的，所以this == window。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader3\x22\x3e创建公用方法\x3c\/h2\x3e\n\x3cp\x3ed3的方法是属于d3对象的属性：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22d3_xhr( url, mimeType, response, callback) {\n  \/\/ code \n}\nd3.json = function(url, callback) {\n  return d3_xhr(url, \x27application\/json\x27, d3_json, callback);\n};\nfunction d3_json(request) {\n  return JSON.parse(request.responseText);\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3ed3_xhr( \x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, mimeType, response, callback) {\n  \x3cspan class=\x22hljs-comment\x22\x3e\/\/ code \x3c\/span\x3e\n}\nd3.json = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3eurl, callback\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e d3_xhr(\x3cspan class=\x22hljs-built_in\x22\x3eurl\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x27application\/json\x27\x3c\/span\x3e, d3_json, callback);\n};\n\x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ed3_json\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3erequest\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eJSON\x3c\/span\x3e.parse(request.responseText);\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e不太好的是d3没有在命名上区分哪些是私有函数，哪些是公用函数，不过对于通过创建对象来对外暴露接口的对象来说，应该也不用去区分吧。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader4\x22\x3e提取一些常用的原生函数\x3c\/h2\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var d3_arraySlice = [].slice, d3_array = function(list) {\n  return d3_arraySlice.call(list);\n};\nvar d3_document = this.document;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs qml\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e d3_arraySlice = [].slice, d3_array = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3elist\x3c\/span\x3e) \x3c\/span\x3e{\n  \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e d3_arraySlice.call(\x3cspan class=\x22hljs-built_in\x22\x3elist\x3c\/span\x3e);\n};\n\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e d3_document = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.document;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e提取slice方法，使用它来生成数组的副本，slice不会对原生数组做切割，而是会返回数组的复制品，但是要注意是浅复制，对于数组中的对象、数组，是单纯的引用，所以对原数组中的对象或数组的更改还是会影响到复制品。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader5\x22\x3e部分代码实现阅读\x3c\/h2\x3e\n\x3ch3 id=\x22articleHeader6\x22\x3e一段用来测试d3_array的函数，但什么情况下会重写d3_array函数呢？\x3c\/h3\x3e\n\x3cp\x3e【line15】\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (d3_document) {\n  var test = d3_array(d3_document.documentElement.childNodes);\n  console.log(test);\n  try {\n    d3_array(d3_document.documentElement.childNodes)[0].nodeType;\n  } catch (e) {\n    console.log(\x27catch error:\x27, e);\n    d3_array = function(list) {\n      var i = list.length, array = new Array(i);\n      while (i--) array[i] = list[i];\n      return array;\n    };\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs php\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (d3_document) {\n  \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e test = d3_array(d3_document.documentElement.childNodes);\n  console.log(test);\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    d3_array(d3_document.documentElement.childNodes)[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e].nodeType;\n  } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (e) {\n    console.log(\x3cspan class=\x22hljs-string\x22\x3e\x27catch error:\x27\x3c\/span\x3e, e);\n    d3_array = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(list)\x3c\/span\x3e \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-keyword\x22\x3elist\x3c\/span\x3e.length, \x3cspan class=\x22hljs-keyword\x22\x3earray\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eArray\x3c\/span\x3e(i);\n      \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (i--) \x3cspan class=\x22hljs-keyword\x22\x3earray\x3c\/span\x3e[i] = \x3cspan class=\x22hljs-keyword\x22\x3elist\x3c\/span\x3e[i];\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3earray\x3c\/span\x3e;\n    };\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e由前面我们可以知道d3_array可以用来获取传入数组的副本，通过try来测试document的子节点的第一个子元素，一般就是header这个元素，我们通过查询\x3ca href=\x22http:\/\/www.w3school.com.cn\/jsref\/prop_node_nodetype.asp\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3ew3c\x3c\/a\x3e可以知道nodeType为1，表示html element，感觉应该是测试是否是浏览器环境，如果不是的话，就换成自己写的函数的意思吗？还是为了兼容一些少数的浏览器呢？\x3c\/p\x3e\n\x3ch4\x3e设置对象属性的兼容？\x3c\/h4\x3e\n\x3cp\x3e【line 30】\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22if (d3_document) {\n  try {\n    d3_document.createElement(\x26quot;DIV\x26quot;).style.setProperty(\x26quot;opacity\x26quot;, 0, \x26quot;\x26quot;);\n  } catch (error) {\n    var d3_element_prototype = this.Element.prototype, d3_element_setAttribute = d3_element_prototype.setAttribute, d3_element_setAttributeNS = d3_element_prototype.setAttributeNS, d3_style_prototype = this.CSSStyleDeclaration.prototype, d3_style_setProperty = d3_style_prototype.setProperty;\n    d3_element_prototype.setAttribute = function(name, value) {\n      d3_element_setAttribute.call(this, name, value \x2b \x26quot;\x26quot;);\n    };\n    d3_element_prototype.setAttributeNS = function(space, local, value) {\n      d3_element_setAttributeNS.call(this, space, local, value \x2b \x26quot;\x26quot;);\n    };\n    d3_style_prototype.setProperty = function(name, value, priority) {\n      d3_style_setProperty.call(this, name, value \x2b \x26quot;\x26quot;, priority);\n    };\n  }\n}\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e\x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (d3_document) {\n  \x3cspan class=\x22hljs-keyword\x22\x3etry\x3c\/span\x3e {\n    d3_document.createElement(\x3cspan class=\x22hljs-string\x22\x3e\x22DIV\x22\x3c\/span\x3e).style.setProperty(\x3cspan class=\x22hljs-string\x22\x3e\x22opacity\x22\x3c\/span\x3e, \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e, \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e);\n  } \x3cspan class=\x22hljs-keyword\x22\x3ecatch\x3c\/span\x3e (error) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e d3_element_prototype = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.Element.prototype, d3_element_setAttribute = d3_element_prototype.setAttribute, d3_element_setAttributeNS = d3_element_prototype.setAttributeNS, d3_style_prototype = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.CSSStyleDeclaration.prototype, d3_style_setProperty = d3_style_prototype.setProperty;\n    d3_element_prototype.setAttribute = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(name, value)\x3c\/span\x3e \x3c\/span\x3e{\n      d3_element_setAttribute.call(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, name, value \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e);\n    };\n    d3_element_prototype.setAttributeNS = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(space, local, value)\x3c\/span\x3e \x3c\/span\x3e{\n      d3_element_setAttributeNS.call(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, space, local, value \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e);\n    };\n    d3_style_prototype.setProperty = \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e(name, value, priority)\x3c\/span\x3e \x3c\/span\x3e{\n      d3_style_setProperty.call(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e, name, value \x2b \x3cspan class=\x22hljs-string\x22\x3e\x22\x22\x3c\/span\x3e, priority);\n    };\n  }\n}\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e暂时不知道是为了跨浏览器还是跨文档而做的检测，待研究。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader7\x22\x3e数组最小值函数\x3c\/h3\x3e\n\x3cp\x3e【line 53】\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  d3.min = function(array, f) {\n    var i = -1, n = array.length, a, b;\n    if (arguments.length === 1) {\n      while (\x2b\x2bi \x3c n) if ((b = array[i]) != null \x26amp;\x26amp; b \x3e= b) {\n        a = b;\n        break;\n      }\n      while (\x2b\x2bi \x3c n) if ((b = array[i]) != null \x26amp;\x26amp; a \x3e b) a = b;\n    } else {\n      while (\x2b\x2bi \x3c n) if ((b = f.call(array, array[i], i)) != null \x26amp;\x26amp; b \x3e= b) {\n        a = b;\n        break;\n      }\n      while (\x2b\x2bi \x3c n) if ((b = f.call(array, array[i], i)) != null \x26amp;\x26amp; a \x3e b) a = b;\n    }\n    return a;\n  };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs armasm\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-built_in\x22\x3ed3\x3c\/span\x3e.min = \x3cspan class=\x22hljs-meta\x22\x3efunction\x3c\/span\x3e(array, f) {\n    var i = -\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, n = array.length, a, \x3cspan class=\x22hljs-keyword\x22\x3eb;\n\x3c\/span\x3e    \x3cspan class=\x22hljs-meta\x22\x3eif\x3c\/span\x3e (arguments.length === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-meta\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) \x3cspan class=\x22hljs-meta\x22\x3eif\x3c\/span\x3e ((\x3cspan class=\x22hljs-keyword\x22\x3eb \x3c\/span\x3e= array[i]) != null \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3eb \x3c\/span\x3e\x26gt;= \x3cspan class=\x22hljs-keyword\x22\x3eb) \x3c\/span\x3e{\n        a = \x3cspan class=\x22hljs-keyword\x22\x3eb;\n\x3c\/span\x3e        \x3cspan class=\x22hljs-keyword\x22\x3ebreak;\n\x3c\/span\x3e      }\n      \x3cspan class=\x22hljs-meta\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) \x3cspan class=\x22hljs-meta\x22\x3eif\x3c\/span\x3e ((\x3cspan class=\x22hljs-keyword\x22\x3eb \x3c\/span\x3e= array[i]) != null \x26amp;\x26amp; a \x26gt; \x3cspan class=\x22hljs-keyword\x22\x3eb) \x3c\/span\x3ea = \x3cspan class=\x22hljs-keyword\x22\x3eb;\n\x3c\/span\x3e    } \x3cspan class=\x22hljs-meta\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-meta\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) \x3cspan class=\x22hljs-meta\x22\x3eif\x3c\/span\x3e ((\x3cspan class=\x22hljs-keyword\x22\x3eb \x3c\/span\x3e= f.call(array, array[i], i)) != null \x26amp;\x26amp; \x3cspan class=\x22hljs-keyword\x22\x3eb \x3c\/span\x3e\x26gt;= \x3cspan class=\x22hljs-keyword\x22\x3eb) \x3c\/span\x3e{\n        a = \x3cspan class=\x22hljs-keyword\x22\x3eb;\n\x3c\/span\x3e        \x3cspan class=\x22hljs-keyword\x22\x3ebreak;\n\x3c\/span\x3e      }\n      \x3cspan class=\x22hljs-meta\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) \x3cspan class=\x22hljs-meta\x22\x3eif\x3c\/span\x3e ((\x3cspan class=\x22hljs-keyword\x22\x3eb \x3c\/span\x3e= f.call(array, array[i], i)) != null \x26amp;\x26amp; a \x26gt; \x3cspan class=\x22hljs-keyword\x22\x3eb) \x3c\/span\x3ea = \x3cspan class=\x22hljs-keyword\x22\x3eb;\n\x3c\/span\x3e    }\n    return a\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\n  }\x3cspan class=\x22hljs-comment\x22\x3e;\x3c\/span\x3e\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e首先获取第一个可比较的元素，测试了下，发现对于\x3cstrong\x3eb \x26gt;= b\x3c\/strong\x3e，无论b是数字、字符串、数组甚至是对象都是可以比较的，那么什么情况下 b\x26gt;=b == false呢，对于NaN来说，无论和哪个数字比较，都是false的，但是对于Infinity却返回真，是个点。所以应该是为了排除NaN这种有问题的数字。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader8\x22\x3ed3的洗牌方法\x3c\/h3\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  d3.shuffle = function(array, i0, i1) {\n    if ((m = arguments.length) \x3c 3) {\n      i1 = array.length;\n      if (m \x3c 2) i0 = 0;\n    }\n    var m = i1 - i0, t, i;\n    while (m) {\n      i = Math.random() * m-- | 0;\n      t = array[m \x2b i0], array[m \x2b i0] = array[i \x2b i0], array[i \x2b i0] = t;\n      console.log(i, m);\n    }\n    return array;\n  };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs maxima\x22\x3e\x3ccode\x3e  d3.shuffle = function(\x3cspan class=\x22hljs-built_in\x22\x3earray\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3ei0\x3c\/span\x3e, \x3cspan class=\x22hljs-built_in\x22\x3ei1\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e ((m = arguments.\x3cspan class=\x22hljs-built_in\x22\x3elength\x3c\/span\x3e) \x26lt; \x3cspan class=\x22hljs-number\x22\x3e3\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-built_in\x22\x3ei1\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3earray\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3elength\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (m \x26lt; \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e) \x3cspan class=\x22hljs-built_in\x22\x3ei0\x3c\/span\x3e = \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e m = \x3cspan class=\x22hljs-built_in\x22\x3ei1\x3c\/span\x3e - \x3cspan class=\x22hljs-built_in\x22\x3ei0\x3c\/span\x3e, t, i;\n    \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (m) {\n      i = Math.\x3cspan class=\x22hljs-built_in\x22\x3erandom\x3c\/span\x3e() * m-- | \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\n      t = \x3cspan class=\x22hljs-built_in\x22\x3earray\x3c\/span\x3e[m \x2b \x3cspan class=\x22hljs-built_in\x22\x3ei0\x3c\/span\x3e], \x3cspan class=\x22hljs-built_in\x22\x3earray\x3c\/span\x3e[m \x2b \x3cspan class=\x22hljs-built_in\x22\x3ei0\x3c\/span\x3e] = \x3cspan class=\x22hljs-built_in\x22\x3earray\x3c\/span\x3e[i \x2b \x3cspan class=\x22hljs-built_in\x22\x3ei0\x3c\/span\x3e], \x3cspan class=\x22hljs-built_in\x22\x3earray\x3c\/span\x3e[i \x2b \x3cspan class=\x22hljs-built_in\x22\x3ei0\x3c\/span\x3e] = t;\n      console.\x3cspan class=\x22hljs-built_in\x22\x3elog\x3c\/span\x3e(i, m);\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3earray\x3c\/span\x3e;\n  };\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3ed3使用的\x3ca href=\x22https:\/\/github.com\/d3\/d3-array\/blob\/master\/README.md#shuffle\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e洗牌算法\x3c\/a\x3e,关于\x3ca href=\x22https:\/\/bost.ocks.org\/mike\/shuffle\/\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3eFisher-Yates shuffle\x3c\/a\x3e的文章可以参考一下，它的演变思路简单而优雅：\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3e正常的思路是\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e每次从原数组中随机选择一个元素，判断是否已经被选取，是的话删除并放入新的数组中，不是的话重新选择。\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e缺点：越到后面重复选择的概率越大，放入新数组的时间越长。\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e优化\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e为了防止重复，每次随机选择第m张卡牌，m为待洗牌组从原始长度n逐步递减的值\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e缺点：每次都要重新获取剩余数组中的卡牌的紧凑数组，实际的效率为n2\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e再次优化\x3c\/strong\x3e\x3c\/p\x3e\n\x3cul\x3e\x3cli\x3e\x3cp\x3e就地随机洗牌，使用数组的后一部分作为存储新的洗牌后的地方，前一部分为洗牌前的地方，从而将效率提升为n。\x3c\/p\x3e\x3c\/li\x3e\x3c\/ul\x3e\n\x3ch3 id=\x22articleHeader9\x22\x3ed3.map 关于内置对象\x3c\/h3\x3e\n\x3cp\x3e【line 291】\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  function d3_class(ctor, properties) {\n    for (var key in properties) {\n      Object.defineProperty(ctor.prototype, key, {\n        value: properties[key],\n        enumerable: false\n      });\n    }\n  }\n  d3.map = function(object, f) {\n    var map = new d3_Map();\n    if (object instanceof d3_Map) {\n      object.forEach(function(key, value) {\n        map.set(key, value);\n      });\n    } else if (Array.isArray(object)) {\n      var i = -1, n = object.length, o;\n      if (arguments.length === 1) while (\x2b\x2bi \x3c n) map.set(i, object[i]); else while (\x2b\x2bi \x3c n) map.set(f.call(object, o = object[i], i), o);\n    } else {\n      for (var key in object) map.set(key, object[key]);\n    }\n    return map;\n  };\n  function d3_Map() {\n    this._ = Object.create(null);\n  }\n  var d3_map_proto = \x26quot;__proto__\x26quot;, d3_map_zero = \x26quot;\\x00\x26quot;;\n  d3_class(d3_Map, {\n    has: d3_map_has,\n    get: function(key) {\n      return this._[d3_map_escape(key)];\n    },\n    set: function(key, value) {\n      return this._[d3_map_escape(key)] = value;\n    },\n    remove: d3_map_remove,\n    keys: d3_map_keys,\n    values: function() {\n      var values = [];\n      for (var key in this._) values.push(this._[key]);\n      return values;\n    },\n    entries: function() {\n      var entries = [];\n      for (var key in this._) entries.push({\n        key: d3_map_unescape(key),\n        value: this._[key]\n      });\n      return entries;\n    },\n    size: d3_map_size,\n    empty: d3_map_empty,\n    forEach: function(f) {\n      for (var key in this._) f.call(this, d3_map_unescape(key), this._[key]);\n    }\n  });\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs maxima\x22\x3e\x3ccode\x3e  function d3_class(ctor, \x3cspan class=\x22hljs-built_in\x22\x3eproperties\x3c\/span\x3e) {\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3eproperties\x3c\/span\x3e) {\n      Object.defineProperty(ctor.prototype, \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, {\n        value: \x3cspan class=\x22hljs-built_in\x22\x3eproperties\x3c\/span\x3e[\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e],\n        enumerable: \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e\n      });\n    }\n  }\n  d3.\x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e = function(object, f) {\n    \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e = \x3cspan class=\x22hljs-built_in\x22\x3enew\x3c\/span\x3e d3_Map();\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (object instanceof d3_Map) {\n      object.forEach(function(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, value) {\n        \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e.set(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, value);\n      });\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (Array.isArray(object)) {\n      \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e i = -\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e, n = object.\x3cspan class=\x22hljs-built_in\x22\x3elength\x3c\/span\x3e, o;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (arguments.\x3cspan class=\x22hljs-built_in\x22\x3elength\x3c\/span\x3e === \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e.set(i, object[i]); \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e.set(f.call(object, o = object[i], i), o);\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e object) \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e.set(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, object[\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e]);\n    }\n    \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3emap\x3c\/span\x3e;\n  };\n  function d3_Map() {\n    this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e = Object.create(null);\n  }\n  \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e d3_map_proto = \x3cspan class=\x22hljs-string\x22\x3e\x22__proto__\x22\x3c\/span\x3e, d3_map_zero = \x3cspan class=\x22hljs-string\x22\x3e\x22\\x00\x22\x3c\/span\x3e;\n  d3_class(d3_Map, {\n    has: d3_map_has,\n    \x3cspan class=\x22hljs-built_in\x22\x3eget\x3c\/span\x3e: function(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e[d3_map_escape(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e)];\n    },\n    set: function(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e, value) {\n      \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e[d3_map_escape(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e)] = value;\n    },\n    \x3cspan class=\x22hljs-built_in\x22\x3eremove\x3c\/span\x3e: d3_map_remove,\n    keys: d3_map_keys,\n    \x3cspan class=\x22hljs-built_in\x22\x3evalues\x3c\/span\x3e: function() {\n      \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3evalues\x3c\/span\x3e = [];\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e) \x3cspan class=\x22hljs-built_in\x22\x3evalues\x3c\/span\x3e.\x3cspan class=\x22hljs-built_in\x22\x3epush\x3c\/span\x3e(this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e[\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e]);\n      \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3evalues\x3c\/span\x3e;\n    },\n    entries: function() {\n      \x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e entries = [];\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e) entries.\x3cspan class=\x22hljs-built_in\x22\x3epush\x3c\/span\x3e({\n        \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e: d3_map_unescape(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e),\n        value: this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e[\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e]\n      });\n      \x3cspan class=\x22hljs-built_in\x22\x3ereturn\x3c\/span\x3e entries;\n    },\n    size: d3_map_size,\n    empty: d3_map_empty,\n    forEach: function(f) {\n      \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-built_in\x22\x3evar\x3c\/span\x3e \x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e) f.call(this, d3_map_unescape(\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e), this.\x3cspan class=\x22hljs-symbol\x22\x3e_\x3c\/span\x3e[\x3cspan class=\x22hljs-built_in\x22\x3ekey\x3c\/span\x3e]);\n    }\n  });\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e\x3cstrong\x3e 关于enumerable\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e在这里，使用d3_Map来作为对象的构造函数，d3_class来封装类，这里调用了Object.defineProperty来设置属性和值，这里有一个enumerable: false的属性，它将该属性的可枚举性设置为false，使得该属性在一般的遍历中（for...in...)等中无法被获取，但是还是可以通过obj.key直接获取到，如果需要获取对象自身的所有属性，不管enumerable的值，可以使用 Object.getOwnPropertyNames 方法。\x3c\/p\x3e\n\x3cp\x3e为什么要设置这个属性呢？我们可以看到对d3_Map构造对象时，引入了一些原生内置的方法，其中有一个叫做empty的方法用来判断后来设置的属性是否为空，我们来看看这个函数的实现：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  function d3_map_empty() {\n    for (var key in this._) return false;\n    return true;\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs actionscript\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ed3_map_empty\x3c\/span\x3e\x3cspan class=\x22hljs-params\x22\x3e()\x3c\/span\x3e \x3c\/span\x3e{\n    \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e key \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e._) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3efalse\x3c\/span\x3e;\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e;\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e看完之后再结合上面提到的enumerable设置为false的属性在for循环中会被忽略，这样的话就不用再写额外地条件去判断是否为内置属性，很棒的实现方式。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader10\x22\x3e数据绑定函数data\x3c\/h3\x3e\n\x3cp\x3e还记得D3独特的将数据和图形领域联系起来的方式吗？\x3ccode\x3e进入(enter)--更新(update)--退出(exit)\x3c\/code\x3e 模式。\x3c\/p\x3e\n\x3cp\x3e【line 832】\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22d3.selectAll(\x27div\x27)\n  .data(dataSet)\n  .enter()\n  .append(\x27div\x27)\n  ;\nd3.selectAll(\x27div\x27)\n  .data(data)\n  .style(\x27width\x27, function(d) {\n     return d \x2b \x27px\x27;\n  })\n ;\nd3.selectAll(\x27div\x27)\n  .data(newDataSet)\n  .exit()\n  .remove()\n  ;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs awk\x22\x3e\x3ccode\x3ed3.selectAll(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e)\n  .data(dataSet)\n  .enter()\n  .append(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e)\n  ;\nd3.selectAll(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e)\n  .data(data)\n  .style(\x3cspan class=\x22hljs-string\x22\x3e\x27width\x27\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e(d) {\n     return d \x2b \x3cspan class=\x22hljs-string\x22\x3e\x27px\x27\x3c\/span\x3e;\n  })\n ;\nd3.selectAll(\x3cspan class=\x22hljs-string\x22\x3e\x27div\x27\x3c\/span\x3e)\n  .data(newDataSet)\n  .\x3cspan class=\x22hljs-keyword\x22\x3eexit\x3c\/span\x3e()\n  .remove()\n  ;\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e这里涉及到了三个函数，data、enter、exit，每次进行操作前我们需要先调用data对数据进行绑定，然后再调用enter或者exit对图形领域进行操作，那么内部实现原理是怎么样的呢，看完下面这段代码就恍然大悟了：\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  d3_selectionPrototype.data = function(value, key) {\n    var i = -1, n = this.length, group, node;\n    if (!arguments.length) {\n      value = new Array(n = (group = this[0]).length);\n      while (\x2b\x2bi \x3c n) {\n        if (node = group[i]) {\n          value[i] = node.__data__;\n        }\n      }\n      return value;\n    }\n    function bind(group, groupData) {\n      var i, n = group.length, m = groupData.length, n0 = Math.min(n, m), updateNodes = new Array(m), enterNodes = new Array(m), exitNodes = new Array(n), node, nodeData;\n      if (key) {\n        var nodeByKeyValue = new d3_Map(), keyValues = new Array(n), keyValue;\n        for (i = -1; \x2b\x2bi \x3c n; ) {\n          if (node = group[i]) {\n            if (nodeByKeyValue.has(keyValue = key.call(node, node.__data__, i))) {\n              exitNodes[i] = node;\n            } else {\n              nodeByKeyValue.set(keyValue, node);\n            }\n            keyValues[i] = keyValue;\n          }\n        }\n        for (i = -1; \x2b\x2bi \x3c m; ) {\n          if (!(node = nodeByKeyValue.get(keyValue = key.call(groupData, nodeData = groupData[i], i)))) {\n            enterNodes[i] = d3_selection_dataNode(nodeData);\n          } else if (node !== true) {\n            updateNodes[i] = node;\n            node.__data__ = nodeData;\n          }\n          nodeByKeyValue.set(keyValue, true);\n        }\n        for (i = -1; \x2b\x2bi \x3c n; ) {\n          if (i in keyValues \x26amp;\x26amp; nodeByKeyValue.get(keyValues[i]) !== true) {\n            exitNodes[i] = group[i];\n          }\n        }\n      } else {\n        for (i = -1; \x2b\x2bi \x3c n0; ) {\n          node = group[i];\n          nodeData = groupData[i];\n          if (node) {\n            node.__data__ = nodeData;\n            updateNodes[i] = node;\n          } else {\n            enterNodes[i] = d3_selection_dataNode(nodeData);\n          }\n        }\n        for (;i \x3c m; \x2b\x2bi) {\n          enterNodes[i] = d3_selection_dataNode(groupData[i]);\n        }\n        for (;i \x3c n; \x2b\x2bi) {\n          exitNodes[i] = group[i];\n        }\n      }\n      enterNodes.update = updateNodes;\n      enterNodes.parentNode = updateNodes.parentNode = exitNodes.parentNode = group.parentNode;\n      enter.push(enterNodes);\n      update.push(updateNodes);\n      exit.push(exitNodes);\n    }\n    var enter = d3_selection_enter([]), update = d3_selection([]), exit = d3_selection([]);\n    if (typeof value === \x26quot;function\x26quot;) {\n      while (\x2b\x2bi \x3c n) {\n        bind(group = this[i], value.call(group, group.parentNode.__data__, i));\n      }\n    } else {\n      while (\x2b\x2bi \x3c n) {\n        bind(group = this[i], value);\n      }\n    }\n    update.enter = function() {\n      return enter;\n    };\n    update.exit = function() {\n      return exit;\n    };\n    return update;\n  };\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs cs\x22\x3e\x3ccode\x3e  d3_selectionPrototype.data = function(\x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e, key) {\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i = \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e, n = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.length, \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e, node;\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!arguments.length) {\n      \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Array(n = (\x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[\x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e]).length);\n      \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) {\n        \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (node = \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e[i]) {\n          \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e[i] = node.__data__;\n        }\n      }\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e;\n    }\n    \x3cspan class=\x22hljs-function\x22\x3efunction \x3cspan class=\x22hljs-title\x22\x3ebind\x3c\/span\x3e(\x3cspan class=\x22hljs-params\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e, groupData\x3c\/span\x3e) \x3c\/span\x3e{\n      \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e i, n = \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e.length, m = groupData.length, n0 = Math.min(n, m), updateNodes = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Array(m), enterNodes = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Array(m), exitNodes = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Array(n), node, nodeData;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (key) {\n        \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e nodeByKeyValue = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e d3_Map(), keyValues = \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e Array(n), keyValue;\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (i = \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e; \x2b\x2bi \x26lt; n; ) {\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (node = \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e[i]) {\n            \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (nodeByKeyValue.has(keyValue = key.call(node, node.__data__, i))) {\n              exitNodes[i] = node;\n            } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n              nodeByKeyValue.\x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e(keyValue, node);\n            }\n            keyValues[i] = keyValue;\n          }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (i = \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e; \x2b\x2bi \x26lt; m; ) {\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (!(node = nodeByKeyValue.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e(keyValue = key.call(groupData, nodeData = groupData[i], i)))) {\n            enterNodes[i] = d3_selection_dataNode(nodeData);\n          } \x3cspan class=\x22hljs-function\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-params\x22\x3enode !== \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e\x3c\/span\x3e) \x3c\/span\x3e{\n            updateNodes[i] = node;\n            node.__data__ = nodeData;\n          }\n          nodeByKeyValue.\x3cspan class=\x22hljs-keyword\x22\x3eset\x3c\/span\x3e(keyValue, \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e);\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (i = \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e; \x2b\x2bi \x26lt; n; ) {\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (i \x3cspan class=\x22hljs-keyword\x22\x3ein\x3c\/span\x3e keyValues \x26amp;\x26amp; nodeByKeyValue.\x3cspan class=\x22hljs-keyword\x22\x3eget\x3c\/span\x3e(keyValues[i]) !== \x3cspan class=\x22hljs-literal\x22\x3etrue\x3c\/span\x3e) {\n            exitNodes[i] = \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e[i];\n          }\n        }\n      } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (i = \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e; \x2b\x2bi \x26lt; n0; ) {\n          node = \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e[i];\n          nodeData = groupData[i];\n          \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (node) {\n            node.__data__ = nodeData;\n            updateNodes[i] = node;\n          } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n            enterNodes[i] = d3_selection_dataNode(nodeData);\n          }\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (;i \x26lt; m; \x2b\x2bi) {\n          enterNodes[i] = d3_selection_dataNode(groupData[i]);\n        }\n        \x3cspan class=\x22hljs-keyword\x22\x3efor\x3c\/span\x3e (;i \x26lt; n; \x2b\x2bi) {\n          exitNodes[i] = \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e[i];\n        }\n      }\n      enterNodes.update = updateNodes;\n      enterNodes.parentNode = updateNodes.parentNode = exitNodes.parentNode = \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e.parentNode;\n      enter.push(enterNodes);\n      update.push(updateNodes);\n      exit.push(exitNodes);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e enter = d3_selection_enter([]), update = d3_selection([]), exit = d3_selection([]);\n    \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (\x3cspan class=\x22hljs-keyword\x22\x3etypeof\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e === \x3cspan class=\x22hljs-string\x22\x3e\x22function\x22\x3c\/span\x3e) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) {\n        bind(\x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[i], \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e.call(\x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e, \x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e.parentNode.__data__, i));\n      }\n    } \x3cspan class=\x22hljs-keyword\x22\x3eelse\x3c\/span\x3e {\n      \x3cspan class=\x22hljs-keyword\x22\x3ewhile\x3c\/span\x3e (\x2b\x2bi \x26lt; n) {\n        bind(\x3cspan class=\x22hljs-keyword\x22\x3egroup\x3c\/span\x3e = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e[i], \x3cspan class=\x22hljs-keyword\x22\x3evalue\x3c\/span\x3e);\n      }\n    }\n    update.enter = function() {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e enter;\n    };\n    update.exit = function() {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e exit;\n    };\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e update;\n  };\x3c\/code\x3e\x3c\/pre\x3e\n\x3cp\x3e数据绑定函数data最终返回了变量update，这个变量update一开始为一个空集合，它拥有d3的集合操作方法，然后data函数通过调用bind函数对传入的参数进行逐项绑定，获得update集合作为本身，以及enter集合和exit集合，最后在update上绑定了函数enter和exit，使得用户在调用data后，可以再次调用enter和exit去获取另外两个集合。\x3c\/p\x3e\n\x3ch4\x3e关于后期debug的足迹\x3c\/h4\x3e\n\x3cp\x3ed3也会有bug的时候，这个时候需要对bug进行修复，然后再更新，为了方便下次找到修改的bug，在代码里面对其进行命名，是很好的做法：\x3c\/p\x3e\n\x3cp\x3e【1167】\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22var d3_mouse_bug44083 = this.navigator \x26amp;\x26amp; \/WebKit\/.test(this.navigator.userAgent) ? -1 : 0;\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs kotlin\x22\x3e\x3ccode style=\x22word-break: break-word; white-space: initial;\x22\x3e\x3cspan class=\x22hljs-keyword\x22\x3evar\x3c\/span\x3e d3_mouse_bug44083 = \x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.navigator \x26amp;\x26amp; \/WebKit\/.test(\x3cspan class=\x22hljs-keyword\x22\x3ethis\x3c\/span\x3e.navigator.userAgent) ? \x3cspan class=\x22hljs-number\x22\x3e-1\x3c\/span\x3e : \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e;\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader11\x22\x3eD3的颜色空间\x3c\/h3\x3e\n\x3cp\x3eD3支持五种颜色表示方式，除了我们常常接触了rgb、hsl外，还有lab、hcl、cubehelix，它们之间都可以转化为rgb，内部的实现方式值得参考：\x3c\/p\x3e\n\x3cp\x3e【line 1582】\x3c\/p\x3e\n\x3cdiv class=\x22widget-codetool\x22 style=\x22display:none;\x22\x3e\n      \x3cdiv class=\x22widget-codetool--inner\x22\x3e\n      \x3cspan class=\x22selectCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22全选\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22copyCode code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 data-clipboard-text=\x22  function d3_hsl_rgb(h, s, l) {\n    var m1, m2;\n    h = isNaN(h) ? 0 : (h %= 360) \x3c 0 ? h \x2b 360 : h;\n    s = isNaN(s) ? 0 : s \x3c 0 ? 0 : s \x3e 1 ? 1 : s;\n    l = l \x3c 0 ? 0 : l \x3e 1 ? 1 : l;\n    m2 = l \x3c= .5 ? l * (1 \x2b s) : l \x2b s - l * s;\n    m1 = 2 * l - m2;\n    function v(h) {\n      if (h \x3e 360) h -= 360; else if (h \x3c 0) h \x2b= 360;\n      if (h \x3c 60) return m1 \x2b (m2 - m1) * h \/ 60;\n      if (h \x3c 180) return m2;\n      if (h \x3c 240) return m1 \x2b (m2 - m1) * (240 - h) \/ 60;\n      return m1;\n    }\n    function vv(h) {\n      return Math.round(v(h) * 255);\n    }\n    return new d3_rgb(vv(h \x2b 120), vv(h), vv(h - 120));\n  }\x22 title=\x22\x22 data-original-title=\x22复制\x22\x3e\x3c\/span\x3e\n      \x3cspan type=\x22button\x22 class=\x22saveToNote code-tool\x22 data-toggle=\x22tooltip\x22 data-placement=\x22top\x22 title=\x22\x22 data-original-title=\x22放进笔记\x22\x3e\x3c\/span\x3e\n      \x3c\/div\x3e\n      \x3c\/div\x3e\x3cpre class=\x22hljs ada\x22\x3e\x3ccode\x3e  \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ed3_hsl_rgb\x3c\/span\x3e(h, s, l) {\n    var m1, m2;\n    h = \x3cspan class=\x22hljs-keyword\x22\x3eis\x3c\/span\x3eNaN(h) ? \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e : (\x3cspan class=\x22hljs-type\x22\x3eh\x3c\/span\x3e %= \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e) \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ? h \x2b \x3cspan class=\x22hljs-number\x22\x3e360\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3eh\x3c\/span\x3e;\n    s = isNaN(s) ? \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3es\x3c\/span\x3e \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ? \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3es\x3c\/span\x3e \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e ? \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3es\x3c\/span\x3e;\n    l = l \x26lt; \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e ? \x3cspan class=\x22hljs-number\x22\x3e0\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3el\x3c\/span\x3e \x26gt; \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e ? \x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e : \x3cspan class=\x22hljs-type\x22\x3el\x3c\/span\x3e;\n    m2 = l \x26lt;= .\x3cspan class=\x22hljs-number\x22\x3e5\x3c\/span\x3e ? l * (\x3cspan class=\x22hljs-number\x22\x3e1\x3c\/span\x3e \x2b s) : \x3cspan class=\x22hljs-type\x22\x3el\x3c\/span\x3e \x2b s - l * s;\n    m1 = \x3cspan class=\x22hljs-number\x22\x3e2\x3c\/span\x3e * l - m2;\n    \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3ev\x3c\/span\x3e(h) {\n      if (h \x26gt; 360) h -= 360; else if (h \x26lt; 0) h \x2b= 360;\n      if (h \x26lt; 60) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3em1\x3c\/span\x3e \x2b (m2 - m1) * h \/ \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (h \x26lt; \x3cspan class=\x22hljs-number\x22\x3e180\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e m2;\n      \x3cspan class=\x22hljs-keyword\x22\x3eif\x3c\/span\x3e (h \x26lt; \x3cspan class=\x22hljs-number\x22\x3e240\x3c\/span\x3e) \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e m1 \x2b (m2 - m1) * (\x3cspan class=\x22hljs-number\x22\x3e240\x3c\/span\x3e - h) \/ \x3cspan class=\x22hljs-number\x22\x3e60\x3c\/span\x3e;\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e m1;\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3efunction\x3c\/span\x3e \x3cspan class=\x22hljs-title\x22\x3evv\x3c\/span\x3e(h) {\n      \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-type\x22\x3eMath.round(v(h)\x3c\/span\x3e * \x3cspan class=\x22hljs-number\x22\x3e255\x3c\/span\x3e);\n    }\n    \x3cspan class=\x22hljs-keyword\x22\x3ereturn\x3c\/span\x3e \x3cspan class=\x22hljs-keyword\x22\x3enew\x3c\/span\x3e d3_rgb(vv(h \x2b \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e), vv(h), vv(h - \x3cspan class=\x22hljs-number\x22\x3e120\x3c\/span\x3e));\n  }\x3c\/code\x3e\x3c\/pre\x3e\n\x3ch3 id=\x22articleHeader12\x22\x3e关于csv、dsv、tsv存储方式\x3c\/h3\x3e\n\x3cblockquote\x3e\x3cp\x3e看代码的好处之一是能看到很多平时不会用到的接口，然后会主动去了解是\x3ca href=\x22http:\/\/www.cnblogs.com\/weidagang2046\/archive\/2012\/04\/02\/dsv.html\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e干什么\x3c\/a\x3e的。\x3c\/p\x3e\x3c\/blockquote\x3e\n\x3cp\x3e\x3cstrong\x3ecsv格式\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e在文本数据处理和传输过程中，我们常常遇到把多个字段通过分隔符连接在一起的需求，如采用著名的CSV格式(comma-separated values)。CSV文件的每一行是一条记录（record），每一行的各个字段通过逗号\x27,\x27分隔。\x3c\/p\x3e\n\x3cp\x3e\x3cstrong\x3edsv格式\x3c\/strong\x3e\x3c\/p\x3e\n\x3cp\x3e由于逗号和双引号这两个特殊字符的存在，我们不能简单地通过字符串的split操作对CSV文件进行解析，而必须进行CSV语法分析。虽然我们可以通过库的形式进行封装，或者直接采用现成的库，但毕竟各种平台下库的丰富程度差异很大，这些库和split、join这样的简单字符串操作相比也更加复杂。为此，我们在CSV格式的基础上设计了一种DSV (double separated values)格式。DSV格式的主要设计目的就是为了简化CSV语法，生成和解析只需要replace, join, split这3个基本的字符串操作，而不需要进行语法分析。\x3c\/p\x3e\n\x3cp\x3eDSV的语法非常简单，只包括以下两点：\x3c\/p\x3e\n\x3cul\x3e\n\x3cli\x3e\x3cp\x3e通过双竖线\x27||\x27作为字段分隔符\x3c\/p\x3e\x3c\/li\x3e\n\x3cli\x3e\x3cp\x3e把字段值中的\x27|\x27替换为\x27_|\x27进行转义\x3c\/p\x3e\x3c\/li\x3e\n\x3c\/ul\x3e\n\x3cp\x3e\x3cstrong\x3e tsv格式\x3c\/strong\x3e \x3c\/p\x3e\n\x3cp\x3eTSV 是Tab-separated values的缩写，即制表符分隔值。\x3c\/p\x3e\n\x3cp\x3e查询网上关于这三种格式的定义是如上所示，不过d3的\x3ca href=\x22https:\/\/github.com\/d3\/d3-dsv\/blob\/master\/README.md#d3-dsv\x22 rel=\x22nofollow noreferrer\x22 target=\x22_blank\x22\x3e实现\x3c\/a\x3e不太一样，dsv是可以定义为任何一种分隔符，但是分隔符只能为长度为1的字符，csv是以半角符逗号作为分割符，tsv则是以斜杠作为分隔符。\x3c\/p\x3e\n\x3ch3 id=\x22articleHeader13\x22\x3ed3.geo\x3c\/h3\x3e\n\x3cp\x3e【line 2854】\x3c\/p\x3e\n\x3cp\x3egeo是d3的图形处理实现，应该算是核心代码了，不过到了4.0版本被分割成依赖，并且不再有d3.geo.path了，而是改用d3.geoPath的方式去引用。\x3c\/p\x3e\n\x3ch2 id=\x22articleHeader14\x22\x3e总结\x3c\/h2\x3e\n\x3cp\x3e版本3的d3九千多行代码，版本4的d4则进行了依赖分割，如果全部依赖引入的话不压缩就要过16000行了，如果想整体去看骨架的话，版本3是比较清晰的，版本4则适合深入研究每一部分的实现，因为依赖都分割得很清晰了，并且相互独立开。\x3c\/p\x3e\n\x3cp\x3e初步了解整个d3的骨架后，接下来可以深入到代码函数实现中去研究其中奥妙。\x3c\/p\x3e\n\n                \n"
            html = html.replace(/"{/g, "{")
            html = html.replace(/{"/g, "{")
            html = html.replace(/"}/g, "}")
            html = html.replace(/}"/g, "}")
            $('#raw').html(html);

            let postTitle =  $('.posttitle').text()
            let postContentTitle =  $('#raw > h1').text()
            if(postTitle === postContentTitle){
                $('#raw > h1').hide()
            }
            $('button.preview').hide()
        })</script></div><h1 id="版权声明">版权声明</h1><p>本文资源来源互联网，仅供学习研究使用，版权归该资源的合法拥有者所有，</p><p>本文仅用于学习、研究和交流目的。转载请注明出处、完整链接以及原作者。</p><p>原作者若认为本站侵犯了您的版权，请联系我们，我们会立即删除！</p><h2 id="原文标题">原文标题</h2><p>D3 源代码解构</p><h2 id="原文链接">原文链接</h2><p><a href="https://segmentfault.com/a/1190000005893218">https://segmentfault.com/a/1190000005893218</a></p><h2>本文链接：</h2><a href="https://alili.tech/archive/qedetadudk/" target="_blank">https://alili.tech/archive/qedetadudk/</a></div></article><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js"></script><div class="blog-post-comments"></div><script>new Valine({
        el: '.blog-post-comments', 
        app_id: 'ItyOVb4I33bTwprf3cY6uqMc-gzGzoHsz', 
        app_key: 'hLhtmd4tT0qJbyO2SgQ8odya', 
        placeholder: '说点什么?', 
        avatar:'robohash',
        notify:true,
        verify:true
    });</script><ul id="more-post-list" class="archive readmore"><h3>其他推荐</h3><li><a href="/archive/5ed53lrrg7e/">如何禁止浏览器自动填充<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/gij1sdp355j/">实践是检验程序员的唯一标准02：用户不想跟你说话并向你扔出一张图片 - 图片上传组件开发【开发篇】<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/y9eqaypgij/">123<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/4ho25kya1mg/">2018你成长了么？一份给你的前端技术清单<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/g2lx7wrrhy4/">Apache、Nginx 与 Node.js 之争 —— WordPress 与 Ghost 的性能大对决<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/dfejr0q89no/">CSS单位em是相对于父元素还是当前元素的字体大小？<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/cik25m3bh7m/">ES6 系列之 Babel 将 Generator 编译成了什么样子<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/vwkme203i7/">ES6 系列之异步处理实战<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/q2at4ffqrr/">Hola～ 一款基于Electron的聊天软件<aside class="dates">2019-02-15</aside></a></li><li><a href="/archive/t2mci6htsdn/">JavaScript 数组操作方法小结<aside class="dates">2019-02-15</aside></a></li></ul></section></div><footer id="footer"><div class="footer-left">Copyright © 2019 Fan <a href="http://www.miitbeian.gov.cn" rel="external nofollow noopener noreferrer" target="_blank">浙ICP备18045521号</a></div><div class="footer-right"><nav><ul><li><a href="/">Home</a></li><li><a href="/archive/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="http://github.com/Fantasy9527" target="_blank">Github</a></li></ul></nav></div></footer><script src="https://alili.tech/lib/justified-gallery/jquery.justifiedGallery.min.js"></script><script src="https://alili.tech/lib/typed.js"></script><script src="https://alili.tech/js/main.js"></script><script async src=""></script><script>(function(){
  if(location.host!=='alili.tech')return;
  var ga = document.createElement('script');
  var curProtocol = window.location.protocol.split(':')[0];
  ga.src = 'https://www.googletagmanager.com/gtag/js?id=UA-129382678-1';       
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(ga, s);
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-129382678-1');
})()</script><script>(function(){
    if(location.host!=='alili.tech')return;
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
          navigator.serviceWorker
              .register('/sw.js')
              .then(registration => {
                  console.log('SW registered: ', registration);
              })
              .catch(registrationError => {
                  console.log('SW registration failed: ', registrationError);
              });
      });
  }</script></body></html>